
Imports System.Data
Imports System.Data.Odbc
Imports System.Math
Imports MySql.Data.MySqlClient
Imports MySql.Data.Types
Imports System.IO
Imports excel = Microsoft.Office.Interop.Excel
Imports MAPA_Reporting_Suite.ZteLte
Imports System.Globalization
Imports System.Data.SqlClient
Imports System.Diagnostics

''                          *================== 3G MAPA REPORTING SUITE 24.05.2015 By Dushyant Kumar Singh ================*

Public Class Form1

    Private objDB As New DB()
    Private dtData As New DataTable()
    ' NEED TO CHANGE DATE HERE
    Dim MAPADATE As Date = Now.Date.AddDays(-1)
    Dim conn As MySqlConnection
    Public CIRCLE_NAME As String = "TZ"
    Dim kpi_fldr As String = Format(MAPADATE, "dd.MM.yyyy")
    Dim outagedate As String = Format(MAPADATE, "dd-MMM")
    Dim print_report_date As String = MAPADATE.ToString("ddMMyyyy", CultureInfo.InvariantCulture)
    Dim print_report_date_process As String = MAPADATE.ToString("yyyyMMdd", CultureInfo.InvariantCulture)
    Dim nd111_date As String = MAPADATE.ToString("yyyy-MM-dd")
    Dim sheetnames As String = ""
    Dim quer As String = ""
    Dim cmd As SqlCommand
    Dim mapa_date As String = MAPADATE.ToString("dd/MM/yyyy", CultureInfo.InvariantCulture)
    Dim mapa_cutt_date As String = MAPADATE.ToString("ddMMM")
    Dim cutting_date As String = MAPADATE.ToString("dd")
    Dim mapa_day = MAPADATE.ToString("ddd")
    Dim folder As String = MAPADATE.ToString("dd.MM.yyyy", CultureInfo.InvariantCulture)
    Dim celloutage_folder As String = MAPADATE.ToString("yyyyMMdd", CultureInfo.InvariantCulture)
    Dim MAPA_SAVE_DATE As String = MAPADATE.ToString("yyyyMMdd", CultureInfo.InvariantCulture)
    Dim MAPA_OPEN_DATE As String = MAPADATE.AddDays(-1).ToString("yyyyMMdd", CultureInfo.InvariantCulture)

    Public Sub errLogger(ByVal LNUM As Long, ByVal SDESC As String, ByVal SFROM As String)
        Dim FILE_NAME As String = "D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr + "\MAPA_ERROR_LOG_" + MAPADATE.ToString("dd-MM-yyyy") + ".log"
        Dim objWriter As System.IO.StreamWriter
        objWriter = System.IO.File.CreateText(FILE_NAME)
        If System.IO.File.Exists(FILE_NAME) = True Then
            objWriter.Write(LNUM)
            objWriter.WriteLine()
            objWriter.Write(SDESC)
            objWriter.WriteLine()
            objWriter.Write(SFROM)
            objWriter.WriteLine()
            objWriter.Write(Now())
        End If
        objWriter.Close()
    End Sub

    Public Sub missing_Logger_files(ByVal filename As String, ByVal oss As String, ByVal time As String)
        Dim FILE_NAME As String = "D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr + "\MISSING_FILES_" + CIRCLE_NAME + "_" + MAPADATE.ToString("dd-MM-yyyy") + ".log"
        Dim objWriter As System.IO.StreamWriter
        objWriter = System.IO.File.AppendText(FILE_NAME)
        If System.IO.File.Exists(FILE_NAME) = True Then
            objWriter.WriteLine()
            objWriter.Write("The File Is Not Available For ")
            objWriter.Write("   ")
            objWriter.Write(filename)
            objWriter.Write("  in Oss ")
            objWriter.Write(oss)
            objWriter.Write("---   Status Time  ")
            objWriter.Write(Now())
        End If
        objWriter.Close()
    End Sub

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Call main()
        Me.Hide()
        Me.ShowInTaskbar = True
        Control.CheckForIllegalCrossThreadCalls = False
        BackgroundWorker1.ReportProgress(0, TimeOfDay.ToString("hh:mm:ss") & "--> *** " + CIRCLE_NAME + " Mapa Started ***" & Environment.NewLine)
        BackgroundWorker1.RunWorkerAsync()
        Me.Hide()
    End Sub
    Public Sub main()
        'Call method for create Folder name 
        make_dir()
        Dim path = My.Computer.FileSystem.SpecialDirectories.MyDocuments()
        If System.IO.File.Exists(path + "\RESUME.XLW") = True Then
            My.Computer.FileSystem.DeleteFile(path + "\RESUME.XLW")
        End If
        NotifyIcon1.Visible = True
        'Process Files Generation
        ProcessFilesGeneration()
        'Call method for final KPI calculation and write in MAPA template
        Call write_old()

err_handler:
        If Err.Number <> 0 Then
            Call errLogger(Err.Number, Err.Description, "error")
            Err.Clear()
            Resume Next
        End If
        Me.Close()
    End Sub

    'Private Sub killexcel()
    '    Dim excelProcess As Process() = Process.GetProcessesByName("EXCEL")
    '    For Each proc As Process In excelProcess

    '        For int As Integer = 3 To excelProcess.Length
    '            proc.Kill()
    '        Next

    '    Next
    'End Sub
    Public Shared Sub ToCSV(ByVal strFilePath As String, ByVal dtDataTable As DataTable)
        Dim sw As StreamWriter = New StreamWriter(strFilePath, False)

        For i As Integer = 0 To dtDataTable.Columns.Count - 1
            sw.Write(dtDataTable.Columns(i))

            If i < dtDataTable.Columns.Count - 1 Then
                sw.Write(",")
            End If
        Next

        sw.Write(sw.NewLine)

        For Each dr As DataRow In dtDataTable.Rows

            For i As Integer = 0 To dtDataTable.Columns.Count - 1

                If Not Convert.IsDBNull(dr(i)) Then
                    Dim value As String = dr(i).ToString()

                    If value.Contains(","c) Then
                        value = String.Format("""{0}""", value)
                        sw.Write(value)
                    Else
                        sw.Write(dr(i).ToString())
                    End If
                End If

                If i < dtDataTable.Columns.Count - 1 Then
                    sw.Write(",")
                End If
            Next

            sw.Write(sw.NewLine)
        Next

        sw.Close()
    End Sub
    Public Function Get_Query_Result_dt(ByVal Query As String, ByVal filename As String)
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_3g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim dap As SqlDataAdapter
        Dim dt As System.Data.DataTable
        dap = New SqlDataAdapter(Query, conn)
        dt = New System.Data.DataTable
        DirectCast(dap.SelectCommand, System.Data.SqlClient.SqlCommand).CommandTimeout = 0
        dap.Fill(dt)
        If dt.Rows.Count > 0 Then
            ToCSV(filename, dt)
        End If
        conn.Close()
        dap.Dispose()
        Return dt
    End Function
    Public Function Execute_MS_SQL_Query(ByVal Query As String) As Object
        Try
            Dim cmd As SqlCommand = Nothing
            Dim oSQLConn As SqlConnection = New SqlConnection()
            oSQLConn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_3g_reports; User ID=pmuser; Password=pmuser"
            If oSQLConn.State = ConnectionState.Closed = True Then
                oSQLConn.Open()
            End If
            cmd = New SqlCommand(Query, oSQLConn)
            cmd.CommandTimeout = 0
            cmd.ExecuteNonQuery()
            oSQLConn.Close()
            oSQLConn.Dispose()
        Catch EX As Exception

        End Try
        Return 0
    End Function
    Private Sub ProcessFilesGeneration()

        'Upload sitedb
        Execute_MS_SQL_Query("TRUNCATE TABLE SiteDB_3G")
        Execute_MS_SQL_Query("bulk insert dbo.SiteDB_3G from 'D:\PM\Validation\AUTOMATED_MAPA_3G\SiteDB_3G.csv' with (FIRSTROW = 2, fieldterminator =',', rowterminator ='\n')")

        'Insert Historical sitedb
        Execute_MS_SQL_Query("exec [mapa_3g_reports].[dbo].udp_Insert_Historical_3G_siteDB '" + nd111_date + "'")

        'Download sitedb
        'Get_Query_Result_dt("SELECT row_number() OVER (ORDER BY [CI]) 'NO','' 'OSS_ID',[SiteID] SiteID,'' 'OSS_Cell_ID-Name',[SITE_NAME] SITE_NAME,[RNC] RNC,[RNC_ID] RNC_ID,[RAC] POWER_WATT,[LAC] LAC,[CI] CI,[Site_Prefence] Site_Preference,[Clutter] Clutter,[Capacity_Area] Capacity_Area,[Sales_Regions] REGION,'' OPCO_TOWN,[Macro_IBS] Macro_IBS,[Configuration] 'Configuration',[ONAIR_DATE] ONAIR_DATE,[SITE_STATUS] SITE_STATUS,'' ATP_Status,[CE_UL] CE_UL,[CE_DL] CE_DL,[BTS_Type] BTS_Type,[IOE_STATUS] IOE_STATUS,'YES' HSDPA_Enabled,[Sales_Regions] 'SUB-REGION',[LONG1] LONG,[LAT] LAT,[VENDOR] VENDOR,[IUB_ID] IUB_ID,[Sector_ID] Sector_ID,[Site_Priority_Passive] Site_Priority_Passive,[Passive_partner] Passive_partner,[Business_Priority] Business_Priority,[Super_Platinum] Super_Platinum,[CGI] CGI,[Managed_Capacity_Sites] Managed_Capacity_Sites,[Cell_name] 'CI-Name',[Roaming] Roaming,[classification] HQ_TOWN,[District] District,[PlatNGold] Physical_Site_ID,[Sales_Regions] LOCAL_MS_ZONE,[Acceptance_Status] Acceptance_Status FROM [mapa_3g_reports].[dbo].[SiteDB_3G];", "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Final Mapa Output " + CIRCLE_NAME + "\\SiteDB_3G_" + MAPA_SAVE_DATE + ".csv")
        Get_Query_Result_dt("SELECT row_number() OVER (ORDER BY [CI]) 'NO','' 'OSS_ID',[SiteID] SiteID,'' 'Cell_ID',[SITE_NAME] SITE_NAME,[RNC] RNC,[RNC_ID] RNC_ID,[RAC] POWER_WATT,[LAC] LAC,[CI] CI,[Site_Prefence] Site_Preference,[Clutter] Clutter,[Capacity_Area] Capacity_Area,[Sales_Regions] REGION,'' OPCO_TOWN,[Macro_IBS] Macro_IBS,[Configuration] 'Configuration',[ONAIR_DATE] ONAIR_DATE,[SITE_STATUS] SITE_STATUS,'' ATP_Status,[CE_UL] CE_UL,[CE_DL] CE_DL,[BTS_Type] BTS_Type,[IOE_STATUS] IOE_STATUS,'YES' HSDPA_Enabled,[Sales_Regions] 'SUB-REGION',[LONG1] LONG,[LAT] LAT,[VENDOR] VENDOR,[IUB_ID] IUB_ID,[Sector_ID] Sector_ID,[Site_Priority_Passive] Site_Priority_Passive,[Passive_partner] Passive_partner,[Business_Priority] Business_Priority,[Super_Platinum] Super_Platinum,[CGI] CGI,[Managed_Capacity_Sites] Managed_Capacity_Sites,[Cell_name] 'Cell_Name',[Roaming] Roaming,[classification] HQ_TOWN,[District] District,[PlatNGold] Physical_Site_ID,[Sales_Regions] LOCAL_MS_ZONE,[Acceptance_Status] Acceptance_Status,[UARFCN] FROM [mapa_3g_reports].[dbo].[SiteDB_3G];", "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Final Mapa Output " + CIRCLE_NAME + "\\SiteDB_3G_" + MAPA_SAVE_DATE + ".csv")

        'Upload HSDPA_LOOKUP_TBL
        Execute_MS_SQL_Query("TRUNCATE TABLE HSDPA_LOOKUP_TBL")
        Execute_MS_SQL_Query("bulk insert dbo.HSDPA_LOOKUP_TBL from 'D:\PM\Validation\AUTOMATED_MAPA_3G\HSDPA_LOOKUP_TBL.csv' with (FIRSTROW = 2, fieldterminator =',', rowterminator ='\n')")


        'Fill data into table for all processed files
        Execute_MS_SQL_Query("exec udp_Processed_files_creation")


        'Process files generation from database
        'NBH_CS
        Dim filepath_CSNBH As String = String.Empty
        filepath_CSNBH = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_NBH_CS_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_NBH_CS_KPIs;", filepath_CSNBH)
        Dim filepath_CSNBH_WC As String = String.Empty
        filepath_CSNBH_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_NBH_CS_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_NBH_CS_KPIs_with_classification;", filepath_CSNBH_WC)

        'NBH_PS
        Dim filepath_PSNBH As String = String.Empty
        filepath_PSNBH = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_NBH_PS_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_NBH_PS_KPIs;", filepath_PSNBH)
        Dim filepath_PSNBH_WC As String = String.Empty
        filepath_PSNBH_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_NBH_PS_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_NBH_PS_KPIs_with_classification;", filepath_PSNBH_WC)

        'BBH_CS
        Dim filepath_CSBBH As String = String.Empty
        filepath_CSBBH = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_BBH_CS_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_BBH_CS_KPIs;", filepath_CSBBH)
        Dim filepath_CSBBH_WC As String = String.Empty
        filepath_CSBBH_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_BBH_CS_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_BBH_CS_KPIs_with_classification;", filepath_CSBBH_WC)

        'BBH_PS
        Dim filepath_PSBBH As String = String.Empty
        filepath_PSBBH = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_BBH_PS_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_BBH_PS_KPIs;", filepath_PSBBH)
        Dim filepath_PSBBH_WC As String = String.Empty
        filepath_PSBBH_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_BBH_PS_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_BBH_PS_KPIs_with_classification;", filepath_PSBBH_WC)

        'DAILY
        Dim filepath_DAILY As String = String.Empty
        filepath_DAILY = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_Daily_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_Daily_KPIs;", filepath_DAILY)
        Dim filepath_DAILY_WC As String = String.Empty
        filepath_DAILY_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_Daily_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_3G_all_Daily_KPIs_with_classification;", filepath_DAILY_WC)

        '24hrs
        Dim filepath_24 As String = String.Empty
        filepath_24 = "D:\\PM\Validation\\AUTOMATED_MAPA_3G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_24hrs_houly_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("SELECT Period_start_time,a.VENDOR,a.CELL_NAME,a.SITE_NAME,a.RNC,a.UCELL,a.Site_Prefence,a.Combined,a.Macro_IBS,a.SITE_STATUS,a.IOE_STATUS, b.Sales_Regions ,a.Total_Cell_Outage,100*((60-((Total_Cell_Outage)/60))/60) Network_Availabilty,Total_Traffic_CS,Total_Traffic_Voice,Total_Traffic_Video,Radio_Network_Load_PS_Total,Radio_Network_Load_PS_R99,Radio_Network_Load_PS_HSPA,Radio_Network_Load_PS_R99_DL,Radio_Network_Load_PS_R99_UL,Radio_Network_Load_PS_HSDPA,Radio_Network_Load_PS_HSUPA,HSDPA_DL_Throughput_per_user,HSDPA_DL_Throughput_per_user_NUM,HSDPA_DL_Throughput_per_user_DENUM,VS_HSDPA_MeanChThroughput FROM mapa_3g_reports.dbo.Network_3G_all_24hrs_houly_KPIs_with_classification a, mapa_3g_reports.dbo.SiteDB_3G b where a.UCELL=b.UCell and a.RNC=b.RNC;", filepath_24)

    End Sub


    Private Function CS_NBHHourCalculation() As String
        Dim cs_nbhhrs As String = String.Empty
        cs_nbhhrs = Get_Query_Result("select right(left(period_start_time,13),2) CS_NBH_HOUR from (select  top(1) period_start_time,sum(Total_Traffic_Voice) Total_Traffic_Voice from  [mapa_3g_reports].[dbo].tbl_hourly_raw group by period_start_time order by Total_Traffic_Voice desc) tbl")
        Return cs_nbhhrs
    End Function

    Private Function PS_NBHHourCalculation() As String
        Dim ps_nbhhrs As String = String.Empty
        ps_nbhhrs = Get_Query_Result("select right(left(period_start_time,13),2) PS_NBH_HOUR from (select  top(1) period_start_time,sum(Radio_Network_Load_PS_Total) Radio_Network_Load_PS_Total from  [mapa_3g_reports].[dbo].tbl_hourly_raw group by period_start_time order by Radio_Network_Load_PS_Total desc) tbl")
        Return ps_nbhhrs
    End Function

    Public Function Get_Query_Result(ByVal Query As String)
        On Error GoTo default_value_of_MySQL
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_3g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim cmd As SqlCommand
        Dim dap As SqlDataAdapter
        Dim dt As System.Data.DataTable
        dap = New SqlDataAdapter(Query, conn)
        dt = New System.Data.DataTable
        DirectCast(dap.SelectCommand, System.Data.SqlClient.SqlCommand).CommandTimeout = 0
        dap.Fill(dt)
        conn.Close()
        dap.Dispose()
        Return dt.Rows(0).Item(0)
default_value_of_MySQL:
        If Err.Number <> 0 Then
            Return "NO VALUE"
            Resume Next
        End If
        Return 0
    End Function
    Public Function Get_Query_Result_2G(ByVal Query As String)
        On Error GoTo default_value_of_MySQL
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_2g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim cmd As SqlCommand
        Dim dap As SqlDataAdapter
        Dim dt As System.Data.DataTable
        dap = New SqlDataAdapter(Query, conn)
        dt = New System.Data.DataTable
        DirectCast(dap.SelectCommand, System.Data.SqlClient.SqlCommand).CommandTimeout = 0
        dap.Fill(dt)
        conn.Close()
        dap.Dispose()
        Return dt.Rows(0).Item(0)
default_value_of_MySQL:
        If Err.Number <> 0 Then
            Return "NO VALUE"
            Resume Next
        End If
        Return 0
    End Function


    Public Function Get_Query_Result_two(ByVal Query As String, ByVal Query1 As String)
        On Error GoTo default_value_of_MySQL
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_3g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim cmd As SqlCommand
        Dim dt As System.Data.DataTable
        Dim dt1 As System.Data.DataTable
        cmd = New SqlCommand(Query, conn)
        cmd.CommandTimeout = 0
        Dim temp1 As Double
        temp1 = cmd.ExecuteScalar()
        conn.Close()
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        cmd = New SqlCommand(quer, conn)
        cmd.CommandTimeout = 0
        cmd.ExecuteNonQuery()
        cmd = New SqlCommand(Query1, conn)
        cmd.CommandTimeout = 0
        Dim temp2 As Double
        temp2 = cmd.ExecuteScalar()
        conn.Close()
        Dim dd = 100 * temp1 / temp2
        Return 100 * temp1 / temp2
default_value_of_MySQL:
        If Err.Number <> 0 Then
            Return "NO VALUE"
            Resume Next
        End If
        Return 0
    End Function
    Sub make_dir()
        Dim kpifolder As String
        Dim targetpath As String
        Dim testdir As String
        kpifolder = "D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr
        targetpath = "D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr + "\"
        targetpath = kpifolder
        If Dir(targetpath, vbDirectory) = "" Then
            testdir = False
        Else : testdir = True
        End If
        If testdir = True Then
        Else
            MkDir(kpifolder)
        End If
        kpifolder = "D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Processed Files " + CIRCLE_NAME + "\" + kpi_fldr
        targetpath = "D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Processed Files " + CIRCLE_NAME + "\" + kpi_fldr + "\"
        targetpath = kpifolder
        If Dir(targetpath, vbDirectory) = "" Then
            testdir = False
        Else : testdir = True
        End If
        If testdir = True Then
        Else
            MkDir(kpifolder)
        End If
        kpifolder = "D:\PM\Validation\AUTOMATED_MAPA_3G\Final Mapa Output " + CIRCLE_NAME
        targetpath = "D:\PM\Validation\AUTOMATED_MAPA_3G\Final Mapa Output " + CIRCLE_NAME + "\"
        targetpath = kpifolder
        If Dir(targetpath, vbDirectory) = "" Then
            testdir = False
        Else : testdir = True
        End If
        If testdir = True Then
        Else
            MkDir(kpifolder)
        End If
    End Sub
    Sub write_old()
        'killexcel()
        Dim todays_column As Integer
        Dim cssr As String = 0
        Dim cname As String = ""
        Dim cpass As String = ""
        Dim tchdropnew As String = 0
        Dim ori_sheetnames = sheetnames
        Dim xlTmp As Microsoft.Office.Interop.Excel.Application
        xlTmp = New Microsoft.Office.Interop.Excel.Application
        If CIRCLE_NAME = "TZ" Then
            cname = "3G_MAPA_TZ_"
            'cname = "MAPA_3G_TZ_"
            ' cpass = "EAST@ar_2012"
        End If
        If MAPADATE.ToString("dd") = 26 Then
            xlTmp.Workbooks.Open("D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Templates\MAPA_3G_TZ.xlsx")
        Else
            If (File.Exists("D:\PM\Validation\AUTOMATED_MAPA_3G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_OPEN_DATE + ".xlsx")) Then
                xlTmp.Workbooks.Open("D:\PM\Validation\AUTOMATED_MAPA_3G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_OPEN_DATE + ".xlsx")
            Else
                xlTmp.Workbooks.Open("D:\PM\Validation\AUTOMATED_MAPA_3G\Mapa Templates\MAPA_3G_TZ.xlsx")
            End If
        End If
        Dim xlSht As Microsoft.Office.Interop.Excel.Worksheet
        Dim mnth As Integer = 0
        If (cutting_date >= 26) Then
            todays_column = cutting_date - 19
        Else
            mnth = Date.DaysInMonth(Format(MAPADATE.AddMonths(-1), "yyyy"), Format(MAPADATE.AddMonths(-1), "MM"))
            If (mnth = 31) Then
                todays_column = cutting_date + 12
            ElseIf (mnth = 30) Then
                todays_column = cutting_date + 11
            ElseIf (mnth = 29) Then
                todays_column = cutting_date + 10
            ElseIf (mnth = 28) Then
                todays_column = cutting_date + 9
            End If
        End If
        todays_column = todays_column + 1

        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.1
        xlSht = xlTmp.Sheets("Total Capacity")
        ' xlSht = xlTmp.Sheets("3G KPI")
        'xlSht = xlTmp.Sheets("PLT")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Total HLR capacity (K)
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total HLR capacity (K)';").ToString
        'No of MSC Servers
        xlSht.Cells(5, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='No of MSC Servers'").ToString
        'Total MSC Capacity (BHCA)
        xlSht.Cells(6, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total MSC Capacity (BHCA)';").ToString
        'No of MGWs
        xlSht.Cells(7, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='No of MGWs';").ToString
        'Total MGW Capacity - (Erls) 
        xlSht.Cells(8, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total MGW Capacity - (Erls)';").ToString
        'Total RNC
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT RNC)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total RNC Capacity (Mbps)
        xlSht.Cells(11, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total RNC Capacity (Mbps)';").ToString
        'Total Node B Sites (Active)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Macro Sites (Active)
        xlSht.Cells(13, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND Macro_IBS LIKE '%Macro%';").ToString
        'Micro Sites (Active)
        xlSht.Cells(14, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND Macro_IBS LIKE '%Micro%';").ToString
        'IBS Sites (Active)
        xlSht.Cells(15, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND Macro_IBS LIKE '%IBS%';").ToString
        'Total Node B CELLS 
        xlSht.Cells(16, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT Cell_name)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Macro Cells
        xlSht.Cells(17, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT Cell_name)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND Macro_IBS LIKE '%Macro%';").ToString
        'IBS Cells
        xlSht.Cells(18, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT Cell_name)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND Macro_IBS LIKE '%IBS%';").ToString
        'HSDPA Enabled Cells
        xlSht.Cells(19, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT Cell_name)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total No of NodeBs ATP Pending 
        xlSht.Cells(20, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total No of NodeBs ATP Pending';").ToString
        'Total No of Locked IBS
        xlSht.Cells(21, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total No of Locked IBS';").ToString
        'Total No of IBSs  ATP Pending
        xlSht.Cells(22, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total No of IBSs  ATP Pending';").ToString
        'Total No of Active IBS Cells 
        xlSht.Cells(23, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total No of Active IBS Cells';").ToString
        'Total No of Locked IBS Cells
        xlSht.Cells(24, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total No of Locked IBS Cells';").ToString
        'Equipped Capacity (Macro) - Contractual
        xlSht.Cells(26, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Equipped Capacity (Macro) - Contractual';").ToString
        'Equipped Capacity (IBS) - Contractual
        xlSht.Cells(27, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Equipped Capacity (IBS) - Contractual';").ToString
        'Total Equipped Capacity - Contractual
        xlSht.Cells(28, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total Equipped Capacity - Contractual';").ToString
        'DL Equipped Capacity (CE)
        xlSht.Cells(29, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='DL Equipped Capacity (CE)';").ToString
        'UL Equipped Capacity (CE)
        xlSht.Cells(30, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='UL Equipped Capacity (CE)';").ToString
        'Total HLR (2G+3G)
        xlSht.Cells(32, todays_column) = Get_Query_Result("  select sum([Total_HLR]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'HLR subs (with 3G Profile)
        xlSht.Cells(33, todays_column) = Get_Query_Result("  select sum([Total_HLR]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'Registered 3G Subs
        xlSht.Cells(34, todays_column) = Get_Query_Result("  select sum([Total_registered_Subs]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'Unregistered Subs
        xlSht.Cells(35, todays_column) = Get_Query_Result("  select sum([Total_Unregistered_Subs]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'Total VLR (3G)
        xlSht.Cells(37, todays_column) = Get_Query_Result("select sum(Total_VLR) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'VLR Attached (3G Subscriber)
        xlSht.Cells(38, todays_column) = Get_Query_Result("select sum(Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'VLR Detached (3G subscriber)
        xlSht.Cells(39, todays_column) = Get_Query_Result("select sum(Total_VLR-Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'In-Roamers
        xlSht.Cells(41, todays_column) = Get_Query_Result("select sum(Total_InRoamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Out-Roamers
        xlSht.Cells(42, todays_column) = Get_Query_Result("select sum(Total_outroamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'SMS Capacity (Msg/Sec)
        xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_3g_reports.dbo.Static_Input where parameter='SMS Capacity (Msg/Sec)';").ToString
        'No. Of MO SMS Sent ( 24 Hrs)
        xlSht.Cells(48, todays_column) = Get_Query_Result("select sum(No_Of_MO_SMS_Sent_24_Hrs) from [mapa_3g_reports].[dbo].[combined_core_24hrs]").ToString
        'No. Of MT SMS Delivered ( 24 Hrs)
        xlSht.Cells(49, todays_column) = Get_Query_Result("select sum(No_Of_MT_SMS_Deli_24_Hrs) from [mapa_3g_reports].[dbo].[combined_core_24hrs]").ToString
        'SMS Delivered during Busy Hour
        xlSht.Cells(50, todays_column) = Get_Query_Result("select sum(SMS_Deli_dur_Busy_Hour) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString


        'No of Voice Calls
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT SUM(No_of_Voice_Calls) No_of_Voice_Calls FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'No of Video Calls
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT SUM(No_of_Video_Calls) No_of_Video_Calls FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification];").ToString
        'No of Data Sessions
        xlSht.Cells(59, todays_column) = 0
        'No of PS Calls Background
        xlSht.Cells(60, todays_column) = Get_Query_Result("SELECT SUM(No_of_PS_Calls_Background) No_of_PS_Calls_Background FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'No of PS Calls Interactive
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT SUM(No_of_PS_Calls_Interactive) No_of_PS_Calls_Interactive FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'No of RT ISHO Attempt
        xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT SUM(No_of_RT_ISHO_Attempt) No_of_RT_ISHO_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'No of NRT ISHO Attempt
        xlSht.Cells(63, todays_column) = Get_Query_Result("SELECT SUM(No_of_NRT_ISHO_Attempt) No_of_NRT_ISHO_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total BBH Traffic (CS)
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_CS) Total_Traffic_CS FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total BBH Traffic (Voice)
        xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_Voice) Total_Traffic_Voice FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total BBH Traffic (Video)
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_Video) Total_Traffic_Video FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'NBH HOUR CALCULATION
        Dim nbh As String = String.Empty
        nbh = CS_NBHHourCalculation()
        xlSht.Cells(68, todays_column) = nbh
        'Total NBH Traffic (CS)
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_CS) Total_Traffic_CS FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total NBH Traffic (Voice) - CS voice
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_Video) Total_Traffic_Video FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total NBH Traffic (VP) - CS data
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_Voice) Total_Traffic_Voice FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total AverageTraffic (CS)
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_CS)/24 Total_Traffic_CS FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total AverageTraffic (Voice) - CS voice
        xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_Video)/24 Total_Traffic_Video FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total AverageTraffic (VP) - CS data
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_Voice)/24 Total_Traffic_Voice FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - Total_(NBH)
        xlSht.Cells(76, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_Total) Radio_Network_Load_PS_Total FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99_(NBH)
        xlSht.Cells(77, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99) Radio_Network_Load_PS_R99 FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSPA_(NBH)
        xlSht.Cells(78, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSPA) Radio_Network_Load_PS_HSPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99 (DL)_(NBH)
        xlSht.Cells(79, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99_DL) Radio_Network_Load_PS_R99_DL FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99 (UL)_(NBH)
        xlSht.Cells(80, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99_UL) Radio_Network_Load_PS_R99_UL FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSDPA_(NBH)
        xlSht.Cells(81, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSDPA) Radio_Network_Load_PS_HSDPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSUPA_(NBH)
        xlSht.Cells(82, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSUPA) Radio_Network_Load_PS_HSUPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - Total_(BBH)
        xlSht.Cells(83, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_Total) Radio_Network_Load_PS_Total FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99_(BBH)
        xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99) Radio_Network_Load_PS_R99 FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSPA_(BBH)
        xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSPA) Radio_Network_Load_PS_HSPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99 (DL)_(BBH)
        xlSht.Cells(86, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99_DL) Radio_Network_Load_PS_R99_DL FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99 (UL)_(BBH)
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99_UL) Radio_Network_Load_PS_R99_UL FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSDPA_(BBH)
        xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSDPA) Radio_Network_Load_PS_HSDPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSUPA_(BBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSUPA) Radio_Network_Load_PS_HSUPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - Total
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_Total) Radio_Network_Load_PS_Total FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99
        xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99) Radio_Network_Load_PS_R99 FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSPA
        xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSPA) Radio_Network_Load_PS_HSPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99 (DL)
        xlSht.Cells(93, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99_DL) Radio_Network_Load_PS_R99_DL FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - R99 (UL)
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_R99_UL) Radio_Network_Load_PS_R99_UL FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSDPA
        xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSDPA) Radio_Network_Load_PS_HSDPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Radio Network Load (PS) - HSUPA
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT SUM(Radio_Network_Load_PS_HSUPA) Radio_Network_Load_PS_HSUPA FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total BBH Traffic (CS+PS)-Mbps (Excluding RLC Over Head, Retransmission, SHO)
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT SUM(Total_BBH_Traffic_CS_PS_Mbps_Excluding_RLC_Over_Head_Retransmission_SHO) Total_BBH_Traffic_CS_PS_Mbps_Excluding_RLC_Over_Head_Retransmission_SHO FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'MPS (Mbps Per site)
        xlSht.Cells(99, todays_column) = Get_Query_Result("select (SELECT SUM(Total_BBH_Traffic_CS_PS_Mbps_Excluding_RLC_Over_Head_Retransmission_SHO) Total_BBH_Traffic_CS_PS_Mbps_Excluding_RLC_Over_Head_Retransmission_SHO FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')/(SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')").ToString


        'CE Utilised DL (BBH)
        xlSht.Cells(101, todays_column) = Get_Query_Result("SELECT SUM(CE_Utilised_DL) CE_Utilised_DL FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'CE Utilised UL (BBH)
        xlSht.Cells(102, todays_column) = Get_Query_Result("SELECT SUM(CE_Utilised_UL) No_of_Video_Calls FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'CE Utilised DL (NBH)
        xlSht.Cells(103, todays_column) = Get_Query_Result("SELECT SUM(CE_Utilised_DL) No_of_PS_Calls_Background FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'CE Utilised UL (NBH)
        xlSht.Cells(104, todays_column) = Get_Query_Result("SELECT SUM(CE_Utilised_UL) No_of_PS_Calls_Interactive FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        '% of Node B with Channel Element Utilization is >90% (NBH)(Downlink)
        xlSht.Cells(105, todays_column) = 0
        '% of Node B with Channel Element Utilization is >90% (NBH)(Uplink)
        xlSht.Cells(106, todays_column) = 0
        '% of Node B with Channel Element Utilization >90% (NodeB Busy hour)(Downlink)
        xlSht.Cells(107, todays_column) = 0
        '% of Node B with Channel Element Utilization >90% (NodeB Busy hour)(Uplink)
        xlSht.Cells(108, todays_column) = 0
        'Cellwise Channel Element Utilization(CBH)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT 100*(SELECT cast(count(distinct ucell)  as float) FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_CS_KPIs_with_classification] where (case when  CE_Utilised_UL+CE_Utilised_DL is null then 0 else CE_Utilised_UL+CE_Utilised_DL end)<70)/(SELECT cast(count(distinct ucell) as float)   FROM [mapa_3g_reports].[dbo].[SiteDB_3G])").ToString
        '% of cells with code channel utilization is >90% (Cell Busy Hour)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN CODE_CHANEL_UTILIZATION>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CODE_CHANEL_UTILIZATION,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')T ;").ToString
        '% of cells when the downlink power is exceeding the design criteria of >65% 
        xlSht.Cells(113, todays_column) = Get_Query_Result("select 100*cast(sum(case when KPI>65 then 1 else 0 end) as float)/count(ucell) from (SELECT a.UCELL, ((power((VS_MeanTCP/10),10))/1000/(rac)) KPI   FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] a, SiteDB_3G b where a.UCELL=b.UCell and  a.Acceptance_Status = 'Accepted' and  a.SITE_STATUS ='Active') t ;").ToString


        '% of cells when the uplink load factor is exceeding the design criteria of <35%  ( Cell Busy hour)
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN VS_MeanRTWP>=-103 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT VS_MeanRTWP,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')T ;").ToString
        'Peak Processor Load- RNC
        xlSht.Cells(117, todays_column) = Get_Query_Result("select max(VS_XPU_CPULOAD_MAX) from tbl_hourly_raw_rnc;").ToString
        '% of RNC's with Processor Load >70% (BBH of respective RNC)
        xlSht.Cells(118, todays_column) = Get_Query_Result("select 100*cast(sum(case when kpi>70 then 1 else 0 end ) as float)/count(RNC_NAME) from (select max(VS_XPU_CPULOAD_MAX) kpi,RNC_NAME from tbl_hourly_raw_rnc group by RNC_NAME) t").ToString

        'Radio Network Utilization (CS) 
        xlSht.Cells(129, todays_column) = Get_Query_Result("select 100*sum(Total_Traffic_CS)/(count(distinct(SITE_NAME)) *85.34) nbh from Network_3G_all_NBH_CS_KPIs_with_classification")
        'Radio Network Utilization (PS)
        xlSht.Cells(130, todays_column) = Get_Query_Result("select (100*(sum(Radio_Network_Load_PS_Total)*8)/(count(distinct(SITE_NAME))*4.93*3600*24)) daily from Network_3G_all_daily_KPIs_with_classification")
        'Radio Network Utilization (NBH)
        xlSht.Cells(131, todays_column) = Get_Query_Result("select ((sum(Radio_Network_Load_PS_Total)*8)/(count(distinct(SITE_NAME))*4.93*3600*24))*100 from Network_3G_all_NBH_CS_KPIs_with_classification")

        'Total Cell Outage (Seconds)
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Total Sec
        xlSht.Cells(134, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Cells Up(Sec)
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active') CellsUpSec;").ToString
        'Availability
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active');").ToString











        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.2
        'xlSht = xlTmp.Sheets("Total Capacity")
        'xlSht = xlTmp.Sheets("3G KPI")
        xlSht = xlTmp.Sheets("PLT")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Platinum%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Platinum%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Platinum%');").ToString

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Platinum%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Platinum%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Platinum%');").ToString
        '% of cells having Radio Network Availability >=97.5%  (No cell should be <=97%)  
        'xlSht.Cells(7, todays_column) = Get_Query_Result("select  100* cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((COUNT(1)*(17*60)) -sum(Total_Cell_Outage)) as float)/(COUNT(1)*(17*60)) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Site_Prefence LIKE '%Platinum%' group by cell_name)t;").ToString
        xlSht.Cells(7, todays_column) = Get_Query_Result("select  100* cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((17*60) -sum(Total_Cell_Outage)) as float)/(17*60) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Site_Prefence LIKE '%Platinum%' group by cell_name)t;").ToString

        'Total Cell Outage (Seconds)
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString
        'Total Sec
        xlSht.Cells(11, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Cells Up(Sec)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Platinum%') CellsUpSec;").ToString
        'Availability
        xlSht.Cells(13, todays_column) = Get_Query_Result("	SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Platinum%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Platinum%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Platinum%');").ToString
        'Inter System Location area Updates Sucess Rate ( 2G-3G and 3G-2G) - (NBH)
        xlSht.Cells(15, todays_column) = Get_Query_Result("select (case when sum(Loc_Upd_Succ_Rate_Denom)>0 then 100*sum(Loc_Upd_Succ_Rate_nom)/sum(Loc_Upd_Succ_Rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Overall SMS success rate
        xlSht.Cells(17, todays_column) = Get_Query_Result("select (case when sum(Overall_SMS_suc_rate_Denom)>0 then 100*sum(Overall_SMS_suc_rate_nom)/sum(Overall_SMS_suc_rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Paging Success Rate for 3G Calls (NBH)
        xlSht.Cells(18, todays_column) = Get_Query_Result("select (Pg_Suc_Rate_3G_Calls_NBH) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Successful Call Rate (NBH)
        xlSht.Cells(20, todays_column) = Get_Query_Result_2G("SELECT  100*sum([NBANS]+[NABEFA1]+[NABEFA2]+[NAAFTD]+[NCAWNOA]+[NTOBEFA]+[NBOUT]+[NBBUSY])/sum([NCALLS]) FROM[mapa_2g_reports].[dbo].[scr_raw_houry] where date = '" + MAPA_SAVE_DATE + "' and  hour = (select  hour from(select top(1) hour, sum(NCALLS) NCALLS from scr_raw_houry where date = '" + MAPA_SAVE_DATE + "' group by hour order by NCALLS desc) tbl)")

        'NEW STARTED
        'Video Call Success Rate (NBH)
        xlSht.Cells(21, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Call_success_rate_DENUM)>0 THEN 100*SUM(Video_Call_success_rate_NUM)/SUM(Video_Call_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'Total RRC Attempt
        xlSht.Cells(26, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(27, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(28, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(29, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'Total RRC Attempt
        xlSht.Cells(31, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'Total RRC Attempt
        xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ").ToString

        '% of cells with RRC set up and access completion ratio >=98%
        xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN RRC_set_up_and_CSR>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_set_up_and_CSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ").ToString

        '% of cells with RRC drop ratio >=2%
        xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN RRC_Drop_Ratio>=2 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_Drop_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'CS RRC Setup Success Rate 
        xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_RRC_Setup_Success_Rate_NUM)/SUM(CS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ").ToString

        'PS RRC Setup Success Rate 
        xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(PS_RRC_Setup_Success_Rate_NUM)/SUM(PS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ").ToString

        '% of cells with CS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IOE cells with CS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(44, todays_column) = ""

        ' % of IOE cells with CS RRC Setup success Rate >=99%
        'xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(45, todays_column) = ""
        '% of cells with PS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IOE cells with PS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(47, todays_column) = ""
        ' % of cells with PS RRC Setup success Rate >=98.5%
        xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IOE cells with PS RRC Setup success Rate >=99%
        'xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(49, todays_column) = ""
        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'NEW
        'RAB Setup Success Rate for Voice 
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_Voice_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_Voice_NUM)/SUM(RAB_Setup_Success_Rate_Voice_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Voice (Cell BBH)
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'RAB Setup Success Rate for Video
        xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_VIDEO_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_VIDEO_NUM)/SUM(RAB_Setup_Success_Rate_VIDEO_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Video (Cell BBH)
        xlSht.Cells(60, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'RAB Setup Success Rate for PS and HS
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%'  ;").ToString

        'PS and HS RAB Setup Success Rate (Data BBH) 
        xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%'  ;").ToString

        '% of cells with PS and HS RAB Setup Success Rate >=97.5% (Data BBH) 
        xlSht.Cells(63, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IOE cells with PS and HS RAB Success Rate>=98% (Data BBH) 
        'xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(64, todays_column) = ""
        '% of cells with PS and HS RAB Success Rate >=98.5% 
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IoE cells with PS and HS RAB Success Rate >=99% 
        'xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(66, todays_column) = ""
        'RAB Setup Success Rate for PS 
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_PS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_PS_NUM)/SUM(RAB_Setup_Success_Rate_for_PS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for PS (Cell BBH) 
        xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_PS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_PS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'RAB Setup Success Rate for HSDPA 
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_HSDPA_NUM)/SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%'  ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for HSDPA (Cell BBH) 
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_HSDPA>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_HSDPA,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'CS and Video RAB Setup Success Rate (Cell Voice BBH) 
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_Video_RAB_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_Video_RAB_Setup_Success_Rate_NUM)/SUM(CS_Video_RAB_Setup_Success_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%'  ;").ToString

        '% of cells with CS and Video RAB Setup Success Rate >=97.5%(Cell Voice BBH) 
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IOE cells with CS and Video RAB Setup Success Rate >=97.5% (Cell Voice BBH) 
        'xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(73, todays_column) = ""
        ' % of cells with CS and Video RAB Success Rate >=98.5% 
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IoE cells with CS and Video RAB Success Rate >=99% 
        'xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(75, todays_column) = ""
        'Voice AMR call setup Success Rate (NBH)
        xlSht.Cells(78, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_AMR_CSSR_DENUM)>0 THEN 100*SUM(Voice_AMR_CSSR_NUM)/SUM(Voice_AMR_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'PS call setup Success Rate (NBH)
        xlSht.Cells(79, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_CSSR_DENUM)>0 THEN 100*SUM(PS_CSSR_NUM)/SUM(PS_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'VT CCSR on-net (M-M) (24 Hrs)
        xlSht.Cells(80, todays_column) = Get_Query_Result("SELECT AVG(VT_CCSR_on_net_M_M)  FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'Voice Drop Call Rate (NBH)
        xlSht.Cells(83, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Voice_Drop_Call_Rate_NUM)/SUM(Voice_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% Of cells with Voice Drop Call Rate <=1% 
        xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% Of IOE cells with Voice Drop Call Rate  <0.8% 
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(85, todays_column) = ""
        'Video Drop Call Rate (NBH)
        xlSht.Cells(86, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Video_Drop_Call_Rate_NUM)/SUM(Video_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% Of cells with Video Drop Call Rate <=1% 
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(PS_Drop_Call_Rate_NUM)/SUM(PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%'  and IOE_STATUS='IOE')T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(93, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(HS_PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(HS_PS_Drop_Call_Rate_NUM)/SUM(HS_PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%'  and IOE_STATUS='IOE')T ;").ToString

        'No. of cells exceeding "Max HS user/cell" (Cell BBH)
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT   AVG(Max_HS_user_per_cell)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'SHO Ratio
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(SHO_Ratio_DENUM)>0 THEN 100*SUM(SHO_Ratio_NUM)/SUM(SHO_Ratio_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_Daily_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% of Cells having SHO Ratio > 60 % (Cell BH)
        xlSht.Cells(99, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN SHO_Ratio>60 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT SHO_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'CS handover success rate ( 3G Intra System)
        xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(CS_HOSR_3G_Intra_System_NUM)/SUM(CS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'PS handover success rate (3G Intra System ) ( PDP Busy Hour)
        xlSht.Cells(101, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(PS_HOSR_3G_Intra_System_NUM)/SUM(PS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'CS intersystem IRAT HO Success Rate (Both ways) (2G to 3G and 3G to 2G)
        xlSht.Cells(102, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(CS_intersystem_IRAT_HOSR_NUM)/SUM(CS_intersystem_IRAT_HOSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% of cells with CS Inter System Handover Success Rate( 3G - 2G, 2G-3G) >=95%
        xlSht.Cells(103, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of Cells with CS Intra-System HO Success Rate < 95 % (Cell BH)
        xlSht.Cells(104, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR<95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'PS Inter System Handover Success Rate ( 3G - 2G, 2G-3G)   (PDP Busy Hour)
        xlSht.Cells(105, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(PS_intersystem_IRAT_HOSR_NUM)/SUM(PS_intersystem_IRAT_HOSR_DENUM) ELSE 100 END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString


        '% of Cells with PS HO Success Rate < 80 % (Cell BH)
        xlSht.Cells(106, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_HOSR_3G_Intra_System<80 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_HOSR_3G_Intra_System,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        'CS BLER ( NBH)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_BLER_DENUM)>0 THEN 100*SUM(CS_BLER_NUM)/SUM(CS_BLER_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% of cells reported with Active Set <=3 should be >95% ( Cell Busy Hour)
        xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Active_Set<=3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Active_Set,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of cells with Average R99, DL Throughput per user >=200 Kbps (Cell Busy Hour)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%'  and IOE_STATUS='IOE')T ;").ToString
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%'  and IOE_STATUS='IOE' AND Average_R99_DL_Throughput_per_user is not null)T ;").ToString

        '% of cells with Average HSDPA DL Throughput per user >=700 kbps (Cell Busy Hour)
        xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=700 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString

        '% of IOE cells with Average HSDPA DL Throughput per user >=550 kbps (Cell Busy Hour)
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' )T ;").ToString
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' and IOE_STATUS='IOE' and HSDPA_DL_Throughput_per_user is not null)T ;").ToString

        '% of Total subscribers downgraded from the requested RAB  (PDP Busy Hour)
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(Total_subs_downgraded_RAB) FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        '% of Total subscribers retained and completed the Service/Session with the requested RAB (PDP Busy Hour)
        xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT '' FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString
        'No of PDP Attempts in PDP Busy Hour
        xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT SUM(No_of_PDP_Attempts)  FROM [mapa_2g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'Attach Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT SUM(Attach_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'PDP Context Activation Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(120, todays_column) = Get_Query_Result("SELECT SUM(PDP_cxt_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString

        'No.of Locked Sites
        xlSht.Cells(131, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE LIKE '%Platinum%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'No. of Locked Cells
        xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE LIKE '%Platinum%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'Total Cell Outage (Minutes)
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'Planned Cell Outage (Minutes)
        xlSht.Cells(134, todays_column) = 0

        'Unplanned Cell Outage (Minutes)
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%';").ToString

        'Total Cell Available Time (Minutes)
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  [Acceptance_Status] LIKE '%Accepted%' AND [SITE_STATUS] LIKE '%Active%' and SITE_PREFENCE LIKE '%Platinum%'").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Platinum%' )T ;").ToString





        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.2
        'xlSht = xlTmp.Sheets("Total Capacity")
        xlSht = xlTmp.Sheets("3G KPI")
        'xlSht = xlTmp.Sheets("PLT")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' )-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' ) CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' );").ToString

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' )-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' ) CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' );").ToString
        '% of cells having Radio Network Availability >=97.5%  (No cell should be <=97%)  
        'xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((COUNT(1)*(17*60)) -sum(Total_Cell_Outage)) as float)/(COUNT(1)*(17*60)) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07  group by cell_name)t;").ToString
        xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((17*60) -sum(Total_Cell_Outage)) as float)/(17*60) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07  group by cell_name)t;").ToString

        'Total Cell Outage (Seconds)
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' ;").ToString
        'Total Sec
        xlSht.Cells(11, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Cells Up(Sec)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' ) CellsUpSec;").ToString
        'Availability
        xlSht.Cells(13, todays_column) = Get_Query_Result("	SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' )-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' ) CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' );").ToString
        'Inter System Location area Updates Sucess Rate ( 2G-3G and 3G-2G) - (NBH)
        xlSht.Cells(15, todays_column) = Get_Query_Result("select (case when sum(Loc_Upd_Succ_Rate_Denom)>0 then 100*sum(Loc_Upd_Succ_Rate_nom)/sum(Loc_Upd_Succ_Rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Overall SMS success rate
        xlSht.Cells(17, todays_column) = Get_Query_Result("select (case when sum(Overall_SMS_suc_rate_Denom)>0 then 100*sum(Overall_SMS_suc_rate_nom)/sum(Overall_SMS_suc_rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Paging Success Rate for 3G Calls (NBH)
        xlSht.Cells(18, todays_column) = Get_Query_Result("select (Pg_Suc_Rate_3G_Calls_NBH) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Successful Call Rate (NBH)
        xlSht.Cells(20, todays_column) = Get_Query_Result_2G("SELECT  100*sum([NBANS]+[NABEFA1]+[NABEFA2]+[NAAFTD]+[NCAWNOA]+[NTOBEFA]+[NBOUT]+[NBBUSY])/sum([NCALLS]) FROM[mapa_2g_reports].[dbo].[scr_raw_houry] where date = '" + MAPA_SAVE_DATE + "' and  hour = (select  hour from(select top(1) hour, sum(NCALLS) NCALLS from scr_raw_houry where date = '" + MAPA_SAVE_DATE + "' group by hour order by NCALLS desc) tbl)")

        'NEW STARTED
        'Video Call Success Rate (NBH)
        xlSht.Cells(21, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Call_success_rate_DENUM)>0 THEN 100*SUM(Video_Call_success_rate_NUM)/SUM(Video_Call_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' ").ToString

        'Total RRC Attempt
        xlSht.Cells(26, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(27, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(28, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(29, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   ").ToString

        'Total RRC Attempt
        xlSht.Cells(31, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ").ToString

        'Total RRC Attempt
        xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ").ToString

        '% of cells with RRC set up and access completion ratio >=98%
        xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RRC_set_up_and_CSR>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_set_up_and_CSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ").ToString

        '% of cells with RRC drop ratio >=2%
        xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RRC_Drop_Ratio>=2 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_Drop_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        'CS RRC Setup Success Rate 
        xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_RRC_Setup_Success_Rate_NUM)/SUM(CS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ").ToString

        'PS RRC Setup Success Rate 
        xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(PS_RRC_Setup_Success_Rate_NUM)/SUM(PS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ").ToString

        '% of cells with CS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of IOE cells with CS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and    IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(44, todays_column) = ""

        ' % of IOE cells with CS RRC Setup success Rate >=99%
        'xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and    IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(45, todays_column) = ""
        '% of cells with PS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of IOE cells with PS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and    IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(47, todays_column) = ""
        ' % of cells with PS RRC Setup success Rate >=98.5%
        xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of IOE cells with PS RRC Setup success Rate >=99%
        'xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and    IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(49, todays_column) = ""
        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        'NEW
        'RAB Setup Success Rate for Voice 
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_Voice_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_Voice_NUM)/SUM(RAB_Setup_Success_Rate_Voice_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Voice (Cell BBH)
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        'RAB Setup Success Rate for Video
        xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_VIDEO_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_VIDEO_NUM)/SUM(RAB_Setup_Success_Rate_VIDEO_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Video (Cell BBH)
        xlSht.Cells(60, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        'RAB Setup Success Rate for PS and HS
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'     ;").ToString

        'PS and HS RAB Setup Success Rate (Data BBH) 
        xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'     ;").ToString

        '% of cells with PS and HS RAB Setup Success Rate >=97.5% (Data BBH) 
        xlSht.Cells(63, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of IOE cells with PS and HS RAB Success Rate>=98% (Data BBH) 
        'xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(64, todays_column) = ""
        '% of cells with PS and HS RAB Success Rate >=98.5% 
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of IoE cells with PS and HS RAB Success Rate >=99% 
        'xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(66, todays_column) = ""
        'RAB Setup Success Rate for PS 
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_PS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_PS_NUM)/SUM(RAB_Setup_Success_Rate_for_PS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for PS (Cell BBH) 
        xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_PS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_PS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        'RAB Setup Success Rate for HSDPA 
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_HSDPA_NUM)/SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'     ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for HSDPA (Cell BBH) 
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_HSDPA>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_HSDPA,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        'CS and Video RAB Setup Success Rate (Cell Voice BBH) 
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_Video_RAB_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_Video_RAB_Setup_Success_Rate_NUM)/SUM(CS_Video_RAB_Setup_Success_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'     ;").ToString

        '% of cells with CS and Video RAB Setup Success Rate >=97.5%(Cell Voice BBH) 
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'    )T ;").ToString

        '% of IOE cells with CS and Video RAB Setup Success Rate >=97.5% (Cell Voice BBH) 
        'xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(73, todays_column) = ""
        ' % of cells with CS and Video RAB Success Rate >=98.5% 
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% of IoE cells with CS and Video RAB Success Rate >=99% 
        'xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(75, todays_column) = ""
        'Voice AMR call setup Success Rate (NBH)
        xlSht.Cells(78, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_AMR_CSSR_DENUM)>0 THEN 100*SUM(Voice_AMR_CSSR_NUM)/SUM(Voice_AMR_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'PS call setup Success Rate (NBH)
        xlSht.Cells(79, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_CSSR_DENUM)>0 THEN 100*SUM(PS_CSSR_NUM)/SUM(PS_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'VT CCSR on-net (M-M) (24 Hrs)
        xlSht.Cells(80, todays_column) = Get_Query_Result("SELECT AVG(VT_CCSR_on_net_M_M)  FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'Voice Drop Call Rate (NBH)
        xlSht.Cells(83, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Voice_Drop_Call_Rate_NUM)/SUM(Voice_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        '% Of cells with Voice Drop Call Rate <=1% 
        xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% Of IOE cells with Voice Drop Call Rate  <0.8% 
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(85, todays_column) = ""
        'Video Drop Call Rate (NBH)
        xlSht.Cells(86, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Video_Drop_Call_Rate_NUM)/SUM(Video_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        '% Of cells with Video Drop Call Rate <=1% 
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(PS_Drop_Call_Rate_NUM)/SUM(PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and    IOE_STATUS='IOE')T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(93, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(HS_PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(HS_PS_Drop_Call_Rate_NUM)/SUM(HS_PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   IOE_STATUS='IOE')T ;").ToString

        'No. of cells exceeding "Max HS user/cell" (Cell BBH)
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT   AVG(Max_HS_user_per_cell)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'SHO Ratio
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(SHO_Ratio_DENUM)>0 THEN 100*SUM(SHO_Ratio_NUM)/SUM(SHO_Ratio_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_Daily_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        '% of Cells having SHO Ratio > 60 % (Cell BH)
        xlSht.Cells(99, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN SHO_Ratio>60 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT SHO_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        'CS handover success rate ( 3G Intra System)
        xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(CS_HOSR_3G_Intra_System_NUM)/SUM(CS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'PS handover success rate (3G Intra System ) ( PDP Busy Hour)
        xlSht.Cells(101, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(PS_HOSR_3G_Intra_System_NUM)/SUM(PS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'CS intersystem IRAT HO Success Rate (Both ways) (2G to 3G and 3G to 2G)
        xlSht.Cells(102, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(CS_intersystem_IRAT_HOSR_NUM)/SUM(CS_intersystem_IRAT_HOSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        '% of cells with CS Inter System Handover Success Rate( 3G - 2G, 2G-3G) >=95%
        xlSht.Cells(103, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% of Cells with CS Intra-System HO Success Rate < 95 % (Cell BH)
        xlSht.Cells(104, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR<95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        'PS Inter System Handover Success Rate ( 3G - 2G, 2G-3G)   (PDP Busy Hour)
        xlSht.Cells(105, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(PS_intersystem_IRAT_HOSR_NUM)/SUM(PS_intersystem_IRAT_HOSR_DENUM) ELSE 100 END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString


        '% of Cells with PS HO Success Rate < 80 % (Cell BH)
        xlSht.Cells(106, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_HOSR_3G_Intra_System<80 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_HOSR_3G_Intra_System,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        'CS BLER ( NBH)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_BLER_DENUM)>0 THEN 100*SUM(CS_BLER_NUM)/SUM(CS_BLER_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        '% of cells reported with Active Set <=3 should be >95% ( Cell Busy Hour)
        xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Active_Set<=3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Active_Set,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% of cells with Average R99, DL Throughput per user >=200 Kbps (Cell Busy Hour)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and    IOE_STATUS='IOE')T ;").ToString
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and    IOE_STATUS='IOE' and Average_R99_DL_Throughput_per_user is not null)T ;").ToString

        '% of cells with Average HSDPA DL Throughput per user >=700 kbps (Cell Busy Hour)
        xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=700 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'   )T ;").ToString

        '% of IOE cells with Average HSDPA DL Throughput per user >=550 kbps (Cell Busy Hour)
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   IOE_STATUS='IOE' )T ;").ToString
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   IOE_STATUS='IOE' and HSDPA_DL_Throughput_per_user is not null)T ;").ToString

        '% of Total subscribers downgraded from the requested RAB  (PDP Busy Hour)
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(Total_subs_downgraded_RAB) FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and ;").ToString

        '% of Total subscribers retained and completed the Service/Session with the requested RAB (PDP Busy Hour)
        xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT '' FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString
        'No of PDP Attempts in PDP Busy Hour
        xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT SUM(No_of_PDP_Attempts)  FROM [mapa_2g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'Attach Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT SUM(Attach_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'PDP Context Activation Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(120, todays_column) = Get_Query_Result("SELECT SUM(PDP_cxt_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString

        'No.of Locked Sites
        xlSht.Cells(131, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE [SITE_STATUS] LIKE '%Lock%';").ToString

        'No. of Locked Cells
        xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE  [SITE_STATUS] LIKE '%Lock%';").ToString

        'Total Cell Outage (Minutes)
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'Planned Cell Outage (Minutes)
        xlSht.Cells(134, todays_column) = 0

        'Unplanned Cell Outage (Minutes)
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  ;").ToString

        'Total Cell Available Time (Minutes)
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' ").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active'  )T ;").ToString





        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.2
        'xlSht = xlTmp.Sheets("Total Capacity")
        'xlSht = xlTmp.Sheets("3G KPI")
        'xlSht = xlTmp.Sheets("PLT")
        xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Gold%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Gold%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Gold%');").ToString

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Gold%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Gold%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Gold%');").ToString
        '% of cells having Radio Network Availability >=97.5%  (No cell should be <=97%)  
        'xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((COUNT(1)*(17*60)) -sum(Total_Cell_Outage)) as float)/(COUNT(1)*(17*60)) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Site_Prefence LIKE '%Gold%' group by cell_name)t;").ToString
        xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((17*60) -sum(Total_Cell_Outage)) as float)/(17*60) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Site_Prefence LIKE '%Gold%' group by cell_name)t;").ToString

        'Total Cell Outage (Seconds)
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString
        'Total Sec
        xlSht.Cells(11, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Cells Up(Sec)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Gold%') CellsUpSec;").ToString
        'Availability
        xlSht.Cells(13, todays_column) = Get_Query_Result("	SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Gold%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Gold%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Gold%');").ToString
        'Inter System Location area Updates Sucess Rate ( 2G-3G and 3G-2G) - (NBH)
        xlSht.Cells(15, todays_column) = Get_Query_Result("select (case when sum(Loc_Upd_Succ_Rate_Denom)>0 then 100*sum(Loc_Upd_Succ_Rate_nom)/sum(Loc_Upd_Succ_Rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Overall SMS success rate
        xlSht.Cells(17, todays_column) = Get_Query_Result("select (case when sum(Overall_SMS_suc_rate_Denom)>0 then 100*sum(Overall_SMS_suc_rate_nom)/sum(Overall_SMS_suc_rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Paging Success Rate for 3G Calls (NBH)
        xlSht.Cells(18, todays_column) = Get_Query_Result("select (Pg_Suc_Rate_3G_Calls_NBH) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Successful Call Rate (NBH)
        xlSht.Cells(20, todays_column) = Get_Query_Result_2G("SELECT  100*sum([NBANS]+[NABEFA1]+[NABEFA2]+[NAAFTD]+[NCAWNOA]+[NTOBEFA]+[NBOUT]+[NBBUSY])/sum([NCALLS]) FROM[mapa_2g_reports].[dbo].[scr_raw_houry] where date = '" + MAPA_SAVE_DATE + "' and  hour = (select  hour from(select top(1) hour, sum(NCALLS) NCALLS from scr_raw_houry where date = '" + MAPA_SAVE_DATE + "' group by hour order by NCALLS desc) tbl)")

        'NEW STARTED
        'Video Call Success Rate (NBH)
        xlSht.Cells(21, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Call_success_rate_DENUM)>0 THEN 100*SUM(Video_Call_success_rate_NUM)/SUM(Video_Call_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'Total RRC Attempt
        xlSht.Cells(26, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(27, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(28, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(29, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' ").ToString

        'Total RRC Attempt
        xlSht.Cells(31, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ").ToString

        'Total RRC Attempt
        xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ").ToString

        '% of cells with RRC set up and access completion ratio >=98%
        xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RRC_set_up_and_CSR>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_set_up_and_CSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ").ToString

        '% of cells with RRC drop ratio >=2%
        xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RRC_Drop_Ratio>=2 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_Drop_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'CS RRC Setup Success Rate 
        xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_RRC_Setup_Success_Rate_NUM)/SUM(CS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ").ToString

        'PS RRC Setup Success Rate 
        xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(PS_RRC_Setup_Success_Rate_NUM)/SUM(PS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ").ToString

        '% of cells with CS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IOE cells with CS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(44, todays_column) = ""

        ' % of IOE cells with CS RRC Setup success Rate >=99%
        'xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(45, todays_column) = ""
        '% of cells with PS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IOE cells with PS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(47, todays_column) = ""
        ' % of cells with PS RRC Setup success Rate >=98.5%
        xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IOE cells with PS RRC Setup success Rate >=99%
        'xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(49, todays_column) = ""
        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'NEW
        'RAB Setup Success Rate for Voice 
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_Voice_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_Voice_NUM)/SUM(RAB_Setup_Success_Rate_Voice_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Voice (Cell BBH)
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'RAB Setup Success Rate for Video
        xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_VIDEO_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_VIDEO_NUM)/SUM(RAB_Setup_Success_Rate_VIDEO_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Video (Cell BBH)
        xlSht.Cells(60, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'RAB Setup Success Rate for PS and HS
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%'  ;").ToString

        'PS and HS RAB Setup Success Rate (Data BBH) 
        xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%'  ;").ToString

        '% of cells with PS and HS RAB Setup Success Rate >=97.5% (Data BBH) 
        xlSht.Cells(63, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IOE cells with PS and HS RAB Success Rate>=98% (Data BBH) 
        'xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(64, todays_column) = ""
        '% of cells with PS and HS RAB Success Rate >=98.5% 
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IoE cells with PS and HS RAB Success Rate >=99% 
        'xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(66, todays_column) = ""
        'RAB Setup Success Rate for PS 
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_PS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_PS_NUM)/SUM(RAB_Setup_Success_Rate_for_PS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for PS (Cell BBH) 
        xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_PS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_PS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'RAB Setup Success Rate for HSDPA 
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_HSDPA_NUM)/SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%'  ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for HSDPA (Cell BBH) 
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_HSDPA>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_HSDPA,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'CS and Video RAB Setup Success Rate (Cell Voice BBH) 
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_Video_RAB_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_Video_RAB_Setup_Success_Rate_NUM)/SUM(CS_Video_RAB_Setup_Success_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%'  ;").ToString

        '% of cells with CS and Video RAB Setup Success Rate >=97.5%(Cell Voice BBH) 
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IOE cells with CS and Video RAB Setup Success Rate >=97.5% (Cell Voice BBH) 
        'xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(73, todays_column) = ""
        ' % of cells with CS and Video RAB Success Rate >=98.5% 
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IoE cells with CS and Video RAB Success Rate >=99% 
        'xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(75, todays_column) = ""
        'Voice AMR call setup Success Rate (NBH)
        xlSht.Cells(78, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_AMR_CSSR_DENUM)>0 THEN 100*SUM(Voice_AMR_CSSR_NUM)/SUM(Voice_AMR_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'PS call setup Success Rate (NBH)
        xlSht.Cells(79, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_CSSR_DENUM)>0 THEN 100*SUM(PS_CSSR_NUM)/SUM(PS_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'VT CCSR on-net (M-M) (24 Hrs)
        xlSht.Cells(80, todays_column) = Get_Query_Result("SELECT AVG(VT_CCSR_on_net_M_M)  FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'Voice Drop Call Rate (NBH)
        xlSht.Cells(83, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Voice_Drop_Call_Rate_NUM)/SUM(Voice_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% Of cells with Voice Drop Call Rate <=1% 
        xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% Of IOE cells with Voice Drop Call Rate  <0.8% 
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(85, todays_column) = ""
        'Video Drop Call Rate (NBH)
        xlSht.Cells(86, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Video_Drop_Call_Rate_NUM)/SUM(Video_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% Of cells with Video Drop Call Rate <=1% 
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(PS_Drop_Call_Rate_NUM)/SUM(PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%'  and IOE_STATUS='IOE')T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(93, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(HS_PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(HS_PS_Drop_Call_Rate_NUM)/SUM(HS_PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%'  and IOE_STATUS='IOE')T ;").ToString

        'No. of cells exceeding "Max HS user/cell" (Cell BBH)
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT   AVG(Max_HS_user_per_cell)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'SHO Ratio
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(SHO_Ratio_DENUM)>0 THEN 100*SUM(SHO_Ratio_NUM)/SUM(SHO_Ratio_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_Daily_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% of Cells having SHO Ratio > 60 % (Cell BH)
        xlSht.Cells(99, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN SHO_Ratio>60 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT SHO_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'CS handover success rate ( 3G Intra System)
        xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(CS_HOSR_3G_Intra_System_NUM)/SUM(CS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'PS handover success rate (3G Intra System ) ( PDP Busy Hour)
        xlSht.Cells(101, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(PS_HOSR_3G_Intra_System_NUM)/SUM(PS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'CS intersystem IRAT HO Success Rate (Both ways) (2G to 3G and 3G to 2G)
        xlSht.Cells(102, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(CS_intersystem_IRAT_HOSR_NUM)/SUM(CS_intersystem_IRAT_HOSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% of cells with CS Inter System Handover Success Rate( 3G - 2G, 2G-3G) >=95%
        xlSht.Cells(103, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of Cells with CS Intra-System HO Success Rate < 95 % (Cell BH)
        xlSht.Cells(104, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR<95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'PS Inter System Handover Success Rate ( 3G - 2G, 2G-3G)   (PDP Busy Hour)
        xlSht.Cells(105, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(PS_intersystem_IRAT_HOSR_NUM)/SUM(PS_intersystem_IRAT_HOSR_DENUM) ELSE 100 END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString


        '% of Cells with PS HO Success Rate < 80 % (Cell BH)
        xlSht.Cells(106, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_HOSR_3G_Intra_System<80 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_HOSR_3G_Intra_System,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        'CS BLER ( NBH)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_BLER_DENUM)>0 THEN 100*SUM(CS_BLER_NUM)/SUM(CS_BLER_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% of cells reported with Active Set <=3 should be >95% ( Cell Busy Hour)
        xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Active_Set<=3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Active_Set,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of cells with Average R99, DL Throughput per user >=200 Kbps (Cell Busy Hour)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%'  and IOE_STATUS='IOE')T ;").ToString
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%'  and IOE_STATUS='IOE' and Average_R99_DL_Throughput_per_user is not null)T ;").ToString

        '% of cells with Average HSDPA DL Throughput per user >=700 kbps (Cell Busy Hour)
        xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=700 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString

        '% of IOE cells with Average HSDPA DL Throughput per user >=550 kbps (Cell Busy Hour)
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' )T ;").ToString
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' and IOE_STATUS='IOE' and HSDPA_DL_Throughput_per_user is not null)T ;").ToString

        '% of Total subscribers downgraded from the requested RAB  (PDP Busy Hour)
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(Total_subs_downgraded_RAB) FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        '% of Total subscribers retained and completed the Service/Session with the requested RAB (PDP Busy Hour)
        xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT '' FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString
        'No of PDP Attempts in PDP Busy Hour
        xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT SUM(No_of_PDP_Attempts)  FROM [mapa_2g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'Attach Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT SUM(Attach_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'PDP Context Activation Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(120, todays_column) = Get_Query_Result("SELECT SUM(PDP_cxt_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString

        'No.of Locked Sites
        xlSht.Cells(131, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE LIKE '%Gold%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'No. of Locked Cells
        xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE LIKE '%Gold%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'Total Cell Outage (Minutes)
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'Planned Cell Outage (Minutes)
        xlSht.Cells(134, todays_column) = 0

        'Unplanned Cell Outage (Minutes)
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%';").ToString

        'Total Cell Available Time (Minutes)
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  [Acceptance_Status] LIKE '%Accepted%' AND [SITE_STATUS] LIKE '%Active%' and SITE_PREFENCE LIKE '%Gold%'").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Gold%' )T ;").ToString






        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.2
        'xlSht = xlTmp.Sheets("Total Capacity")
        'xlSht = xlTmp.Sheets("3G KPI")
        'xlSht = xlTmp.Sheets("PLT")
        'xlSht = xlTmp.Sheets("Gold")
        xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Silver%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Silver%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Silver%');").ToString

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Silver%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Silver%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE LIKE '%Silver%');").ToString
        '% of cells having Radio Network Availability >=97.2%  (No cell should be <=97%)  
        'xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.2 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((COUNT(1)*(17*60)) -sum(Total_Cell_Outage)) as float)/(COUNT(1)*(17*60)) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Site_Prefence LIKE '%Silver%' group by cell_name)t;").ToString
        xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.2 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((17*60) -sum(Total_Cell_Outage)) as float)/(17*60) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Site_Prefence LIKE '%Silver%' group by cell_name)t;").ToString
        '% of cells having Radio Network Availability >=97.2% (airport serving cells) (7am to 11pm)  (No cell should be <=97%)
        xlSht.Cells(8, todays_column) = ""
        'Total Cell Outage (Seconds)
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString
        'Total Sec
        xlSht.Cells(11, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active';").ToString
        'Cells Up(Sec)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Silver%') CellsUpSec;").ToString
        'Availability
        xlSht.Cells(13, todays_column) = Get_Query_Result("	SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Silver%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Silver%') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE LIKE '%Silver%');").ToString
        'Inter System Location area Updates Sucess Rate ( 2G-3G and 3G-2G) - (NBH)
        xlSht.Cells(15, todays_column) = Get_Query_Result("select (case when sum(Loc_Upd_Succ_Rate_Denom)>0 then 100*sum(Loc_Upd_Succ_Rate_nom)/sum(Loc_Upd_Succ_Rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Overall SMS success rate
        xlSht.Cells(17, todays_column) = Get_Query_Result("select (case when sum(Overall_SMS_suc_rate_Denom)>0 then 100*sum(Overall_SMS_suc_rate_nom)/sum(Overall_SMS_suc_rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Paging Success Rate for 3G Calls (NBH)
        xlSht.Cells(18, todays_column) = Get_Query_Result("select (Pg_Suc_Rate_3G_Calls_NBH) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Successful Call Rate (NBH)
        xlSht.Cells(20, todays_column) = Get_Query_Result_2G("SELECT  100*sum([NBANS]+[NABEFA1]+[NABEFA2]+[NAAFTD]+[NCAWNOA]+[NTOBEFA]+[NBOUT]+[NBBUSY])/sum([NCALLS]) FROM[mapa_2g_reports].[dbo].[scr_raw_houry] where date = '" + MAPA_SAVE_DATE + "' and  hour = (select  hour from(select top(1) hour, sum(NCALLS) NCALLS from scr_raw_houry where date = '" + MAPA_SAVE_DATE + "' group by hour order by NCALLS desc) tbl)")

        'NEW STARTED
        'Video Call Success Rate (NBH)
        xlSht.Cells(21, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Call_success_rate_DENUM)>0 THEN 100*SUM(Video_Call_success_rate_NUM)/SUM(Video_Call_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'Total RRC Attempt
        xlSht.Cells(26, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(27, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(28, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(29, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' ").ToString

        'Total RRC Attempt
        xlSht.Cells(31, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ").ToString

        'Total RRC Attempt
        xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ").ToString

        '% of cells with RRC set up and access completion ratio >=98%
        xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RRC_set_up_and_CSR>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_set_up_and_CSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ").ToString

        '% of cells with RRC drop ratio >=2%
        xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RRC_Drop_Ratio>=2 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_Drop_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'CS RRC Setup Success Rate 
        xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_RRC_Setup_Success_Rate_NUM)/SUM(CS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ").ToString

        'PS RRC Setup Success Rate 
        xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(PS_RRC_Setup_Success_Rate_NUM)/SUM(PS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ").ToString

        '% of cells with CS RRC Setup Success Rate >=97% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=97 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IOE cells with CS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(44, todays_column) = ""

        ' % of IOE cells with CS RRC Setup success Rate >=99%
        'xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(45, todays_column) = ""
        '% of cells with PS RRC Setup Success Rate >=97% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=97 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IOE cells with PS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(47, todays_column) = ""
        ' % of cells with PS RRC Setup success Rate >=98.5%
        xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IOE cells with PS RRC Setup success Rate >=99%
        'xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(49, todays_column) = ""
        '% of cells with CS call blocking due to call admission control <0.7% 
        xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.7 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.2% 
        xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.2 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of cells with CS call blocking due to call admission control <0.7% 
        xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.7 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.5% 
        xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'NEW
        'RAB Setup Success Rate for Voice 
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_Voice_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_Voice_NUM)/SUM(RAB_Setup_Success_Rate_Voice_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Voice (Cell BBH)
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'RAB Setup Success Rate for Video
        xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_VIDEO_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_VIDEO_NUM)/SUM(RAB_Setup_Success_Rate_VIDEO_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Video (Cell BBH)
        xlSht.Cells(60, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'RAB Setup Success Rate for PS and HS
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%'  ;").ToString

        'PS and HS RAB Setup Success Rate (Data BBH) 
        xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%'  ;").ToString

        '% of cells with PS and HS RAB Setup Success Rate >=97% (Data BBH) 
        xlSht.Cells(63, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=97 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IOE cells with PS and HS RAB Success Rate>=98% (Data BBH) 
        'xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(64, todays_column) = ""
        '% of cells with PS and HS RAB Success Rate >=98.5% 
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IoE cells with PS and HS RAB Success Rate >=99% 
        'xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(66, todays_column) = ""
        'RAB Setup Success Rate for PS 
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_PS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_PS_NUM)/SUM(RAB_Setup_Success_Rate_for_PS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for PS (Cell BBH) 
        xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_PS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_PS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'RAB Setup Success Rate for HSDPA 
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_HSDPA_NUM)/SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%'  ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for HSDPA (Cell BBH) 
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_HSDPA>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_HSDPA,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'CS and Video RAB Setup Success Rate (Cell Voice BBH) 
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_Video_RAB_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_Video_RAB_Setup_Success_Rate_NUM)/SUM(CS_Video_RAB_Setup_Success_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%'  ;").ToString

        '% of cells with CS and Video RAB Setup Success Rate >=97%(Cell Voice BBH) 
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IOE cells with CS and Video RAB Setup Success Rate >=97.5% (Cell Voice BBH) 
        'xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(73, todays_column) = ""
        ' % of cells with CS and Video RAB Success Rate >=98.5% 
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IoE cells with CS and Video RAB Success Rate >=99% 
        'xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(75, todays_column) = ""
        'Voice AMR call setup Success Rate (NBH)
        xlSht.Cells(78, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_AMR_CSSR_DENUM)>0 THEN 100*SUM(Voice_AMR_CSSR_NUM)/SUM(Voice_AMR_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'PS call setup Success Rate (NBH)
        xlSht.Cells(79, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_CSSR_DENUM)>0 THEN 100*SUM(PS_CSSR_NUM)/SUM(PS_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'VT CCSR on-net (M-M) (24 Hrs)
        xlSht.Cells(80, todays_column) = Get_Query_Result("SELECT AVG(VT_CCSR_on_net_M_M)  FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'Voice Drop Call Rate (NBH)
        xlSht.Cells(83, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Voice_Drop_Call_Rate_NUM)/SUM(Voice_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% Of cells with Voice Drop Call Rate <=1% 
        xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% Of IOE cells with Voice Drop Call Rate  <0.8% 
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(85, todays_column) = ""
        'Video Drop Call Rate (NBH)
        xlSht.Cells(86, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Video_Drop_Call_Rate_NUM)/SUM(Video_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% Of cells with Video Drop Call Rate <=1% 
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(PS_Drop_Call_Rate_NUM)/SUM(PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%'  and IOE_STATUS='IOE')T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(93, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(HS_PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(HS_PS_Drop_Call_Rate_NUM)/SUM(HS_PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%'  and IOE_STATUS='IOE')T ;").ToString

        'No. of cells exceeding "Max HS user/cell" (Cell BBH)
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT   AVG(Max_HS_user_per_cell)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'SHO Ratio
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(SHO_Ratio_DENUM)>0 THEN 100*SUM(SHO_Ratio_NUM)/SUM(SHO_Ratio_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_Daily_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% of Cells having SHO Ratio > 60 % (Cell BH)
        xlSht.Cells(99, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN SHO_Ratio>60 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT SHO_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'CS handover success rate ( 3G Intra System)
        xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(CS_HOSR_3G_Intra_System_NUM)/SUM(CS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'PS handover success rate (3G Intra System ) ( PDP Busy Hour)
        xlSht.Cells(101, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(PS_HOSR_3G_Intra_System_NUM)/SUM(PS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'CS intersystem IRAT HO Success Rate (Both ways) (2G to 3G and 3G to 2G)
        xlSht.Cells(102, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(CS_intersystem_IRAT_HOSR_NUM)/SUM(CS_intersystem_IRAT_HOSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% of cells with CS Inter System Handover Success Rate( 3G - 2G, 2G-3G) >=95%
        xlSht.Cells(103, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of Cells with CS Intra-System HO Success Rate < 95 % (Cell BH)
        xlSht.Cells(104, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR<95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'PS Inter System Handover Success Rate ( 3G - 2G, 2G-3G)   (PDP Busy Hour)
        xlSht.Cells(105, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(PS_intersystem_IRAT_HOSR_NUM)/SUM(PS_intersystem_IRAT_HOSR_DENUM) ELSE 100 END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString


        '% of Cells with PS HO Success Rate < 80 % (Cell BH)
        xlSht.Cells(106, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_HOSR_3G_Intra_System<80 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_HOSR_3G_Intra_System,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        'CS BLER ( NBH)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_BLER_DENUM)>0 THEN 100*SUM(CS_BLER_NUM)/SUM(CS_BLER_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% of cells reported with Active Set <=3 should be >95% ( Cell Busy Hour)
        xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Active_Set<=3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Active_Set,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of cells with Average R99, DL Throughput per user >=200 Kbps (Cell Busy Hour)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%'  and IOE_STATUS='IOE')T ;").ToString
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%'  and IOE_STATUS='IOE' and Average_R99_DL_Throughput_per_user is not null)T ;").ToString

        '% of cells with Average HSDPA DL Throughput per user >=700 kbps (Cell Busy Hour)
        xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=700 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString

        '% of IOE cells with Average HSDPA DL Throughput per user >=550 kbps (Cell Busy Hour)
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' )T ;").ToString
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' and IOE_STATUS='IOE' and HSDPA_DL_Throughput_per_user is not null )T ;").ToString

        '% of Total subscribers downgraded from the requested RAB  (PDP Busy Hour)
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(Total_subs_downgraded_RAB) FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        '% of Total subscribers retained and completed the Service/Session with the requested RAB (PDP Busy Hour)
        xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT '' FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString
        'No of PDP Attempts in PDP Busy Hour
        xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT SUM(No_of_PDP_Attempts)  FROM [mapa_2g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'Attach Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT SUM(Attach_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'PDP Context Activation Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(120, todays_column) = Get_Query_Result("SELECT SUM(PDP_cxt_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString

        'No.of Locked Sites
        xlSht.Cells(131, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE LIKE '%Silver%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'No. of Locked Cells
        xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE LIKE '%Silver%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'Total Cell Outage (Minutes)
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'Planned Cell Outage (Minutes)
        xlSht.Cells(134, todays_column) = 0

        'Unplanned Cell Outage (Minutes)
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%';").ToString

        'Total Cell Available Time (Minutes)
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  [Acceptance_Status] LIKE '%Accepted%' AND [SITE_STATUS] LIKE '%Active%' and SITE_PREFENCE LIKE '%Silver%'").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  SITE_PREFENCE LIKE '%Silver%' )T ;").ToString









        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.2
        'xlSht = xlTmp.Sheets("Total Capacity")
        'xlSht = xlTmp.Sheets("3G KPI")
        'xlSht = xlTmp.Sheets("PLT")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE not LIKE '%Silver%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and Combined ='PnG') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE not LIKE '%Silver%');").ToString

        'Network Availability Total (Radio 24 hrs)
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE not LIKE '%Silver%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and Combined ='PnG') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' AND SITE_PREFENCE not LIKE '%Silver%');").ToString
        '% of cells having Radio Network Availability >=97.5%  (No cell should be <=97%)  
        'xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((COUNT(1)*(17*60)) -sum(Total_Cell_Outage)) as float)/(COUNT(1)*(17*60)) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Combined ='PnG' group by cell_name)t;").ToString
        xlSht.Cells(7, todays_column) = Get_Query_Result("select  100*cast(sum(case when kpi>=97.5 then 1 else 0 end) as float)/count(cell_name) from (SELECT 100*cast(((17*60) -sum(Total_Cell_Outage)) as float)/(17*60) kpi,cell_name FROM [mapa_3g_reports].[dbo].[Network_3G_all_24hrs_houly_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and right(period_start_time,2)>=07 AND Combined ='PnG' group by cell_name)t;").ToString

        'Total Cell Outage (Seconds)
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString
        'Total Sec
        xlSht.Cells(11, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE not LIKE '%Silver%';").ToString
        'Cells Up(Sec)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE not LIKE '%Silver%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and Combined ='PnG') CellsUpSec;").ToString
        'Availability
        xlSht.Cells(13, todays_column) = Get_Query_Result("	SELECT 100*(SELECT (SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE not LIKE '%Silver%')-(SELECT SUM(Total_Cell_Outage)*60 Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and Combined ='PnG') CellsUpSec)/(SELECT (COUNT(*)*(24*60*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G] WHERE Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE not LIKE '%Silver%');").ToString
        'Inter System Location area Updates Sucess Rate ( 2G-3G and 3G-2G) - (NBH)
        xlSht.Cells(15, todays_column) = Get_Query_Result("select (case when sum(Loc_Upd_Succ_Rate_Denom)>0 then 100*sum(Loc_Upd_Succ_Rate_nom)/sum(Loc_Upd_Succ_Rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Overall SMS success rate
        xlSht.Cells(17, todays_column) = Get_Query_Result("select (case when sum(Overall_SMS_suc_rate_Denom)>0 then 100*sum(Overall_SMS_suc_rate_nom)/sum(Overall_SMS_suc_rate_Denom) else null end) from [mapa_3g_reports].[dbo].[CNRH]").ToString
        'Paging Success Rate for 3G Calls (NBH)
        xlSht.Cells(18, todays_column) = Get_Query_Result("select (Pg_Suc_Rate_3G_Calls_NBH) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Successful Call Rate (NBH)
        xlSht.Cells(20, todays_column) = Get_Query_Result_2G("SELECT  100*sum([NBANS]+[NABEFA1]+[NABEFA2]+[NAAFTD]+[NCAWNOA]+[NTOBEFA]+[NBOUT]+[NBBUSY])/sum([NCALLS]) FROM[mapa_2g_reports].[dbo].[scr_raw_houry] where date = '" + MAPA_SAVE_DATE + "' and  hour = (select  hour from(select top(1) hour, sum(NCALLS) NCALLS from scr_raw_houry where date = '" + MAPA_SAVE_DATE + "' group by hour order by NCALLS desc) tbl)")

        'NEW STARTED
        'Video Call Success Rate (NBH)
        xlSht.Cells(21, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Call_success_rate_DENUM)>0 THEN 100*SUM(Video_Call_success_rate_NUM)/SUM(Video_Call_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'Total RRC Attempt
        xlSht.Cells(26, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(27, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(28, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(29, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' ").ToString

        'Total RRC Attempt
        xlSht.Cells(31, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' ").ToString

        'RRC set up and access Completion ratio (%)
        xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_set_up_and_CSR_DENUM)>0 THEN 100*SUM(RRC_set_up_and_CSR_NUM)/SUM(RRC_set_up_and_CSR_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' ").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' ").ToString

        'RRC Drop Ratio (%)
        xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Drop_Ratio_DENUM)>0 THEN 100*SUM(RRC_Drop_Ratio_NUM)/SUM(RRC_Drop_Ratio_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ").ToString

        'Total RRC Attempt
        xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT  SUM(Total_RRC_Attempt) Total_RRC_Attempt FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ").ToString

        '% of cells with RRC set up and access completion ratio >=98%
        xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RRC_set_up_and_CSR>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RRC_set_up_and_CSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        'RRC Registration success rate (%)
        xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RRC_Registration_success_rate_DENUM)>0 THEN 100*SUM(RRC_Registration_success_rate_NUM)/SUM(RRC_Registration_success_rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_BBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ").ToString

        '% of cells with RRC drop ratio >=2%
        xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT 100*sum(CASE WHEN RRC_Drop_Ratio>=2 THEN 1 ELSE 0 END)/(COUNT(CELL_NAME)) FROM (SELECT RRC_Drop_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        'CS RRC Setup Success Rate 
        xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_RRC_Setup_Success_Rate_NUM)/SUM(CS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ").ToString

        'PS RRC Setup Success Rate 
        xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_RRC_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(PS_RRC_Setup_Success_Rate_NUM)/SUM(PS_RRC_Setup_Success_Rate_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_NBH_PS_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ").ToString

        '% of cells with CS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of IOE cells with CS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(44, todays_column) = ""

        ' % of IOE cells with CS RRC Setup success Rate >=99%
        'xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(45, todays_column) = ""

        '% of cells with PS RRC Setup Success Rate >=97.5% ( Cell BBH) No Cell should be <=96%
        xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of IOE cells with PS RRC Setup Success Rate >=98% ( Cell BBH) No Cell should be <=97%
        'xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(47, todays_column) = ""
        ' % of cells with PS RRC Setup success Rate >=98.5%
        xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of IOE cells with PS RRC Setup success Rate >=99%
        'xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_RRC_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_RRC_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(49, todays_column) = ""
        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of cells with CS call blocking due to call admission control <0.5% 
        xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of cells with PS call blocking due to call admission control <0.3% 
        xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_call_BLOCK_due_TO_call_admi_cont<0.3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_call_BLOCK_due_TO_call_admi_cont,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        'NEW
        'RAB Setup Success Rate for Voice 
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_Voice_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_Voice_NUM)/SUM(RAB_Setup_Success_Rate_Voice_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Voice (Cell BBH)
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        'RAB Setup Success Rate for Video
        xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_VIDEO_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_VIDEO_NUM)/SUM(RAB_Setup_Success_Rate_VIDEO_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for Video (Cell BBH)
        xlSht.Cells(60, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_Voice>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_Voice,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        'RAB Setup Success Rate for PS and HS
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].[Network_3G_all_DAILY_KPIs_with_classification] where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG'  ;").ToString

        'PS and HS RAB Setup Success Rate (Data BBH) 
        xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_PS_HS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_PS_HS_NUM)/SUM(RAB_Setup_Success_Rate_PS_HS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG'  ;").ToString

        '% of cells with PS and HS RAB Setup Success Rate >=97.5% (Data BBH) 
        xlSht.Cells(63, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of IOE cells with PS and HS RAB Success Rate>=98% (Data BBH) 
        'xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(64, todays_column) = ""
        '% of cells with PS and HS RAB Success Rate >=98.5% 
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of IoE cells with PS and HS RAB Success Rate >=99% 
        'xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_PS_HS>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_PS_HS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(66, todays_column) = ""
        'RAB Setup Success Rate for PS 
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_PS_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_PS_NUM)/SUM(RAB_Setup_Success_Rate_for_PS_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for PS (Cell BBH) 
        xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_PS>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_PS,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        'RAB Setup Success Rate for HSDPA 
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM)>0 THEN 100*SUM(RAB_Setup_Success_Rate_for_HSDPA_NUM)/SUM(RAB_Setup_Success_Rate_for_HSDPA_DENUM) ELSE NULL END) FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG'  ;").ToString

        '% of cells with RAB Setup Success Rate >=97.5% for HSDPA (Cell BBH) 
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN RAB_Setup_Success_Rate_for_HSDPA>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT RAB_Setup_Success_Rate_for_HSDPA,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        'CS and Video RAB Setup Success Rate (Cell Voice BBH) 
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_Video_RAB_Setup_Success_Rate_DENUM)>0 THEN 100*SUM(CS_Video_RAB_Setup_Success_Rate_NUM)/SUM(CS_Video_RAB_Setup_Success_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG'  ;").ToString

        '% of cells with CS and Video RAB Setup Success Rate >=97.5%(Cell Voice BBH) 
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and   Combined ='PnG' )T ;").ToString

        '% of IOE cells with CS and Video RAB Setup Success Rate >=97.5% (Cell Voice BBH) 
        'xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=97.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(73, todays_column) = ""
        ' % of cells with CS and Video RAB Success Rate >=98.5% 
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=98.5 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% of IoE cells with CS and Video RAB Success Rate >=99% 
        'xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_Video_RAB_Setup_Success_Rate>=99 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_Video_RAB_Setup_Success_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(75, todays_column) = ""
        'Voice AMR call setup Success Rate (NBH)
        xlSht.Cells(78, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_AMR_CSSR_DENUM)>0 THEN 100*SUM(Voice_AMR_CSSR_NUM)/SUM(Voice_AMR_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'PS call setup Success Rate (NBH)
        xlSht.Cells(79, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_CSSR_DENUM)>0 THEN 100*SUM(PS_CSSR_NUM)/SUM(PS_CSSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'VT CCSR on-net (M-M) (24 Hrs)
        xlSht.Cells(80, todays_column) = Get_Query_Result("SELECT AVG(VT_CCSR_on_net_M_M)  FROM [mapa_3g_reports].[dbo].Network_3G_all_DAILY_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'Voice Drop Call Rate (NBH)
        xlSht.Cells(83, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Voice_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Voice_Drop_Call_Rate_NUM)/SUM(Voice_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% Of cells with Voice Drop Call Rate <=1% 
        xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% Of IOE cells with Voice Drop Call Rate  <0.8% 
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Voice_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Voice_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        xlSht.Cells(85, todays_column) = ""
        'Video Drop Call Rate (NBH)
        xlSht.Cells(86, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(Video_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(Video_Drop_Call_Rate_NUM)/SUM(Video_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% Of cells with Video Drop Call Rate <=1% 
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(PS_Drop_Call_Rate_NUM)/SUM(PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG'  and IOE_STATUS='IOE')T ;").ToString

        '% Of IOE cells with Video Drop Call Rate  <0.8% 
        'xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Video_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Video_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString

        'PS Drop Call Rate (NBH)
        xlSht.Cells(93, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(HS_PS_Drop_Call_Rate_DENUM)>0 THEN 100*SUM(HS_PS_Drop_Call_Rate_NUM)/SUM(HS_PS_Drop_Call_Rate_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% Of cells with PS Drop Call Rate <=1% 
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% Of IOE cells with PS Drop Call Rate  <0.8% 
        'xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HS_PS_Drop_Call_Rate<=0.8 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HS_PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG'  and IOE_STATUS='IOE')T ;").ToString

        'No. of cells exceeding "Max HS user/cell" (Cell BBH)
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT   AVG(Max_HS_user_per_cell)  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'SHO Ratio
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(SHO_Ratio_DENUM)>0 THEN 100*SUM(SHO_Ratio_NUM)/SUM(SHO_Ratio_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_Daily_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% of Cells having SHO Ratio > 60 % (Cell BH)
        xlSht.Cells(99, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN SHO_Ratio>60 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT SHO_Ratio,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        'CS handover success rate ( 3G Intra System)
        xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(CS_HOSR_3G_Intra_System_NUM)/SUM(CS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'PS handover success rate (3G Intra System ) ( PDP Busy Hour)
        xlSht.Cells(101, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_HOSR_3G_Intra_System_DENUM)>0 THEN 100*SUM(PS_HOSR_3G_Intra_System_NUM)/SUM(PS_HOSR_3G_Intra_System_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'CS intersystem IRAT HO Success Rate (Both ways) (2G to 3G and 3G to 2G)
        xlSht.Cells(102, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(CS_intersystem_IRAT_HOSR_NUM)/SUM(CS_intersystem_IRAT_HOSR_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% of cells with CS Inter System Handover Success Rate( 3G - 2G, 2G-3G) >=95%
        xlSht.Cells(103, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% of Cells with CS Intra-System HO Success Rate < 95 % (Cell BH)
        xlSht.Cells(104, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN CS_intersystem_IRAT_HOSR<95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT CS_intersystem_IRAT_HOSR,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        'PS Inter System Handover Success Rate ( 3G - 2G, 2G-3G)   (PDP Busy Hour)
        xlSht.Cells(105, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(PS_intersystem_IRAT_HOSR_DENUM)>0 THEN 100*SUM(PS_intersystem_IRAT_HOSR_NUM)/SUM(PS_intersystem_IRAT_HOSR_DENUM) ELSE 100 END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString


        '% of Cells with PS HO Success Rate < 80 % (Cell BH)
        xlSht.Cells(106, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN PS_HOSR_3G_Intra_System<80 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_HOSR_3G_Intra_System,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        'CS BLER ( NBH)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT (CASE WHEN SUM(CS_BLER_DENUM)>0 THEN 100*SUM(CS_BLER_NUM)/SUM(CS_BLER_DENUM) ELSE NULL END)  FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% of cells reported with Active Set <=3 should be >95% ( Cell Busy Hour)
        xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Active_Set<=3 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Active_Set,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% of cells with Average R99, DL Throughput per user >=200 Kbps (Cell Busy Hour)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG'  and IOE_STATUS='IOE')T ;").ToString
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG'  and IOE_STATUS='IOE' and Average_R99_DL_Throughput_per_user is not null)T ;").ToString

        '% of cells with Average HSDPA DL Throughput per user >=700 kbps (Cell Busy Hour)
        xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=700 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString

        '% of IOE cells with Average HSDPA DL Throughput per user >=550 kbps (Cell Busy Hour)
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' and IOE_STATUS='IOE' )T ;").ToString
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN HSDPA_DL_Throughput_per_user>=550 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT HSDPA_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' and IOE_STATUS='IOE' and HSDPA_DL_Throughput_per_user is not null)T ;").ToString

        '% of Total subscribers downgraded from the requested RAB  (PDP Busy Hour)
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(Total_subs_downgraded_RAB) FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        '% of Total subscribers retained and completed the Service/Session with the requested RAB (PDP Busy Hour)
        xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT '' FROM [mapa_3g_reports].[dbo].Network_3G_all_NBH_CS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString
        'No of PDP Attempts in PDP Busy Hour
        xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT SUM(No_of_PDP_Attempts)  FROM [mapa_2g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'Attach Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT SUM(Attach_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString
        'PDP Context Activation Success Rate (IU Mode PDP Busy Hour)
        xlSht.Cells(120, todays_column) = Get_Query_Result("SELECT SUM(PDP_cxt_success_rate_3g_MAPA)  FROM [mapa_3g_reports].[dbo].[PS_Core_KPIs_MAPA_2g3g] ;").ToString

        'No.of Locked Sites
        xlSht.Cells(131, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE not LIKE '%Silver%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'No. of Locked Cells
        xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_3g_reports].[dbo].SiteDB_3G  WHERE SITE_PREFENCE not LIKE '%Silver%' AND [SITE_STATUS] LIKE '%Lock%';").ToString

        'Total Cell Outage (Minutes)
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'Planned Cell Outage (Minutes)
        xlSht.Cells(134, todays_column) = 0

        'Unplanned Cell Outage (Minutes)
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage) Total_Cell_Outage FROM [mapa_3g_reports].[dbo].[Network_3G_all_Daily_KPIs_with_classification]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG';").ToString

        'Total Cell Available Time (Minutes)
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_3g_reports].[dbo].[SiteDB_3G]  where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and SITE_PREFENCE not  LIKE '%Silver%'").ToString

        '%of Cells with Average PS, DL Throughput per user >=200Kbps
        xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT 100*cast(sum(CASE WHEN Average_R99_DL_Throughput_per_user>=200 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_R99_DL_Throughput_per_user,CELL_NAME  FROM [mapa_3g_reports].[dbo].Network_3G_all_BBH_PS_KPIs_with_classification   where Acceptance_Status = 'Accepted' and  SITE_STATUS ='Active' and  Combined ='PnG' )T ;").ToString



        '' '' ''---------End of Code------------------------------------------------
        Dim path = My.Computer.FileSystem.SpecialDirectories.MyDocuments()
        If System.IO.File.Exists(path + "\RESUME.XLW") = True Then
            My.Computer.FileSystem.DeleteFile(path + "\RESUME.XLW")
        End If
        If System.IO.File.Exists("D:\PM\Validation\AUTOMATED_MAPA_3G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_SAVE_DATE + ".xlsx") = True Then
            My.Computer.FileSystem.DeleteFile("D:\PM\Validation\AUTOMATED_MAPA_3G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_SAVE_DATE + ".xlsx")
        End If
        xlSht.SaveAs("D:\PM\Validation\AUTOMATED_MAPA_3G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_SAVE_DATE + ".xlsx")
        'xlTmp.SaveWorkspace()
        xlTmp.Workbooks.Close()
        xlTmp.Quit()
        ' KillExcelProcess()
    End Sub

    Private Sub KillExcelProcess()
        Dim excelProcs() As Process = Process.GetProcessesByName("EXCEL")
        For Each proc As Process In excelProcs
            proc.Kill()
        Next
    End Sub

    Private Sub NotifyIcon1_MouseDoubleClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles NotifyIcon1.MouseDoubleClick
        Me.Show()
    End Sub

    Private Sub BackgroundWorker1_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorker1.DoWork
        ' Call main()
    End Sub

    Private Sub BackgroundWorker1_ProgressChanged(ByVal sender As System.Object, ByVal e As System.ComponentModel.ProgressChangedEventArgs) Handles BackgroundWorker1.ProgressChanged
        Dim status As String
        tsprogress.Value = e.ProgressPercentage
        If Not IsNothing(e.UserState) Then
            status = DirectCast(e.UserState, String)
            txtStatus.Text = txtStatus.Text & status
        End If
    End Sub

    Private Sub txtStatus_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtStatus.TextChanged
    End Sub

    Private Sub NotifyIcon1_MouseClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles NotifyIcon1.MouseClick
        If (Me.MinimizeBox = True) Then
            NotifyIcon1.Visible = True
        End If
    End Sub

    Private Sub NotifyIcon1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NotifyIcon1.Click
        Me.Show()
    End Sub

    Private Sub tsprogress_Click(sender As Object, e As EventArgs) Handles tsprogress.Click

    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        'Call main()
    End Sub
End Class
