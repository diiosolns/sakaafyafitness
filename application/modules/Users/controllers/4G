
Imports System.Data
Imports System.Data.Odbc
Imports System.Math
Imports MySql.Data.MySqlClient
Imports MySql.Data.Types
Imports System.IO
Imports excel = Microsoft.Office.Interop.Excel
Imports MAPA_Reporting_Suite.ZteLte
Imports System.Globalization
Imports System.Data.SqlClient
Imports System.Diagnostics

''                          *================== 4G MAPA REPORTING SUITE 13.07.2019 By Dushyant Kumar Singh ================*

Public Class Form1

    Private objDB As New DB()
    Private dtData As New DataTable()
    ' NEED TO CHANGE DATE HERE
    Dim MAPADATE As Date = Now.Date.AddDays(-1)
    Dim conn As MySqlConnection
    Public CIRCLE_NAME As String = "TZ"
    Dim kpi_fldr As String = Format(MAPADATE, "dd.MM.yyyy")
    Dim outagedate As String = Format(MAPADATE, "dd-MMM")
    Dim print_report_date As String = MAPADATE.ToString("ddMMyyyy", CultureInfo.InvariantCulture)
    Dim print_report_date_process As String = MAPADATE.ToString("yyyyMMdd", CultureInfo.InvariantCulture)
    Dim nd111_date As String = MAPADATE.ToString("yyyy-MM-dd")
    Dim sheetnames As String = ""
    Dim quer As String = ""
    Dim cmd As SqlCommand
    Dim mapa_date As String = MAPADATE.ToString("dd/MM/yyyy", CultureInfo.InvariantCulture)
    Dim mapa_cutt_date As String = MAPADATE.ToString("ddMMM")
    Dim cutting_date As String = MAPADATE.ToString("dd")
    Dim mapa_day = MAPADATE.ToString("ddd")
    Dim folder As String = MAPADATE.ToString("dd.MM.yyyy", CultureInfo.InvariantCulture)
    Dim celloutage_folder As String = MAPADATE.ToString("yyyyMMdd", CultureInfo.InvariantCulture)
    Dim MAPA_SAVE_DATE As String = MAPADATE.ToString("yyyyMMdd", CultureInfo.InvariantCulture)
    Dim MAPA_OPEN_DATE As String = MAPADATE.AddDays(-1).ToString("yyyyMMdd", CultureInfo.InvariantCulture)

    Public Sub errLogger(ByVal LNUM As Long, ByVal SDESC As String, ByVal SFROM As String)
        Dim FILE_NAME As String = "D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr + "\MAPA_ERROR_LOG_" + MAPADATE.ToString("dd-MM-yyyy") + ".log"
        Dim objWriter As System.IO.StreamWriter
        objWriter = System.IO.File.CreateText(FILE_NAME)
        If System.IO.File.Exists(FILE_NAME) = True Then
            objWriter.Write(LNUM)
            objWriter.WriteLine()
            objWriter.Write(SDESC)
            objWriter.WriteLine()
            objWriter.Write(SFROM)
            objWriter.WriteLine()
            objWriter.Write(Now())
        End If
        objWriter.Close()
    End Sub

    Public Sub missing_Logger_files(ByVal filename As String, ByVal oss As String, ByVal time As String)
        Dim FILE_NAME As String = "D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr + "\MISSING_FILES_" + CIRCLE_NAME + "_" + MAPADATE.ToString("dd-MM-yyyy") + ".log"
        Dim objWriter As System.IO.StreamWriter
        objWriter = System.IO.File.AppendText(FILE_NAME)
        If System.IO.File.Exists(FILE_NAME) = True Then
            objWriter.WriteLine()
            objWriter.Write("The File Is Not Available For ")
            objWriter.Write("   ")
            objWriter.Write(filename)
            objWriter.Write("  in Oss ")
            objWriter.Write(oss)
            objWriter.Write("---   Status Time  ")
            objWriter.Write(Now())
        End If
        objWriter.Close()
    End Sub

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Call main()
        Me.Hide()
        Me.ShowInTaskbar = True
        Control.CheckForIllegalCrossThreadCalls = False
        BackgroundWorker1.ReportProgress(0, TimeOfDay.ToString("hh:mm:ss") & "--> *** " + CIRCLE_NAME + " Mapa Started ***" & Environment.NewLine)
        BackgroundWorker1.RunWorkerAsync()
        Me.Hide()
    End Sub
    Public Sub main()
        'Call method for create Folder name 
        make_dir()
        Dim path = My.Computer.FileSystem.SpecialDirectories.MyDocuments()
        If System.IO.File.Exists(path + "\RESUME.XLW") = True Then
            My.Computer.FileSystem.DeleteFile(path + "\RESUME.XLW")
        End If
        NotifyIcon1.Visible = True
        'Process Files Generation  ===========================================
        ProcessFilesGeneration()
        'Call method for final KPI calculation and write in MAPA template  ====
        Call write_old()

err_handler:
        If Err.Number <> 0 Then
            Call errLogger(Err.Number, Err.Description, "error")
            Err.Clear()
            Resume Next
        End If
        Me.Close()
    End Sub

    'Private Sub killexcel()
    '    Dim excelProcess As Process() = Process.GetProcessesByName("EXCEL")
    '    For Each proc As Process In excelProcess

    '        For int As Integer = 3 To excelProcess.Length
    '            proc.Kill()
    '        Next

    '    Next
    'End Sub
    Public Shared Sub ToCSV(ByVal strFilePath As String, ByVal dtDataTable As DataTable)
        Dim sw As StreamWriter = New StreamWriter(strFilePath, False)

        For i As Integer = 0 To dtDataTable.Columns.Count - 1
            sw.Write(dtDataTable.Columns(i))

            If i < dtDataTable.Columns.Count - 1 Then
                sw.Write(",")
            End If
        Next

        sw.Write(sw.NewLine)

        For Each dr As DataRow In dtDataTable.Rows

            For i As Integer = 0 To dtDataTable.Columns.Count - 1

                If Not Convert.IsDBNull(dr(i)) Then
                    Dim value As String = dr(i).ToString()

                    If value.Contains(","c) Then
                        value = String.Format("""{0}""", value)
                        sw.Write(value)
                    Else
                        sw.Write(dr(i).ToString())
                    End If
                End If

                If i < dtDataTable.Columns.Count - 1 Then
                    sw.Write(",")
                End If
            Next

            sw.Write(sw.NewLine)
        Next

        sw.Close()
    End Sub
    Public Function Get_Query_Result_dt(ByVal Query As String, ByVal filename As String)
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_4g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim dap As SqlDataAdapter
        Dim dt As System.Data.DataTable
        dap = New SqlDataAdapter(Query, conn)
        dt = New System.Data.DataTable
        DirectCast(dap.SelectCommand, System.Data.SqlClient.SqlCommand).CommandTimeout = 0
        dap.Fill(dt)
        If dt.Rows.Count > 0 Then
            ToCSV(filename, dt)
        End If
        conn.Close()
        dap.Dispose()
        Return dt
    End Function
    Public Function Execute_MS_SQL_Query(ByVal Query As String) As Object
        Try
            Dim cmd As SqlCommand = Nothing
            Dim oSQLConn As SqlConnection = New SqlConnection()
            oSQLConn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_4g_reports; User ID=pmuser; Password=pmuser"
            If oSQLConn.State = ConnectionState.Closed = True Then
                oSQLConn.Open()
            End If
            cmd = New SqlCommand(Query, oSQLConn)
            cmd.CommandTimeout = 0
            cmd.ExecuteNonQuery()
            oSQLConn.Close()
            oSQLConn.Dispose()
        Catch EX As Exception

        End Try
        Return 0
    End Function
    Private Sub ProcessFilesGeneration()

        'Upload sitedb
        Execute_MS_SQL_Query("TRUNCATE TABLE SiteDB_4G")
        Execute_MS_SQL_Query("bulk insert dbo.SiteDB_4G from 'D:\PM\Validation\AUTOMATED_MAPA_4G\SiteDB_4G.csv' with (FIRSTROW = 2, fieldterminator =',', rowterminator ='\n')")

        'Fill data into table for all processed files
        Execute_MS_SQL_Query("exec udp_Processed_files_creation")


        'Process files generation from database
        'NBH_CS
        Dim filepath_CSNBH As String = String.Empty
        filepath_CSNBH = "D:\\PM\Validation\\AUTOMATED_MAPA_4G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_4G_all_NBH_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_4G_all_NBH_KPIs;", filepath_CSNBH)
        Dim filepath_CSNBH_WC As String = String.Empty
        filepath_CSNBH_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_4G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_4G_all_NBH_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_4G_all_NBH_KPIs_with_classification;", filepath_CSNBH_WC)


        'BBH
        Dim filepath_CSBBH As String = String.Empty
        filepath_CSBBH = "D:\\PM\Validation\\AUTOMATED_MAPA_4G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_4G_all_BBH_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_4G_all_BBH_KPIs;", filepath_CSBBH)
        Dim filepath_CSBBH_WC As String = String.Empty
        filepath_CSBBH_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_4G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_4G_all_BBH_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_4G_all_BBH_KPIs_with_classification;", filepath_CSBBH_WC)

        'DAILY
        Dim filepath_DAILY As String = String.Empty
        filepath_DAILY = "D:\\PM\Validation\\AUTOMATED_MAPA_4G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_4G_all_Daily_KPIs_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_4G_all_Daily_KPIs;", filepath_DAILY)
        Dim filepath_DAILY_WC As String = String.Empty
        filepath_DAILY_WC = "D:\\PM\Validation\\AUTOMATED_MAPA_4G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_4G_all_Daily_KPIs_with_classification_" + print_report_date + ".csv"
        Get_Query_Result_dt("select * from Network_4G_all_Daily_KPIs_with_classification;", filepath_DAILY_WC)

        '24hrs
        ' Dim filepath_24 As String = String.Empty
        'filepath_24 = "D:\\PM\Validation\\AUTOMATED_MAPA_4G\\Mapa Processed Files " + CIRCLE_NAME + "\\" + kpi_fldr + "\\Network_3G_all_24hrs_houly_KPIs_with_classification_" + print_report_date + ".csv"
        'Get_Query_Result_dt("SELECT Period_start_time,a.VENDOR,a.CELL_NAME,a.SITE_NAME,a.RNC,a.UCELL,a.Site_Prefence,a.Combined,a.Macro_IBS,a.SITE_STATUS,a.IOE_STATUS, b.Sales_Regions ,a.Total_Cell_Outage,100*((60-((Total_Cell_Outage)/60))/60) Network_Availabilty,Total_Traffic_CS,Total_Traffic_Voice,Total_Traffic_Video,Radio_Network_Load_PS_Total,Radio_Network_Load_PS_R99,Radio_Network_Load_PS_HSPA,Radio_Network_Load_PS_R99_DL,Radio_Network_Load_PS_R99_UL,Radio_Network_Load_PS_HSDPA,Radio_Network_Load_PS_HSUPA,HSDPA_DL_Throughput_per_user,HSDPA_DL_Throughput_per_user_NUM,HSDPA_DL_Throughput_per_user_DENUM,VS_HSDPA_MeanChThroughput FROM mapa_4g_reports.dbo.Network_3G_all_24hrs_houly_KPIs_with_classification a, mapa_4g_reports.dbo.SiteDB_3G b where a.UCELL=b.UCell and a.RNC=b.RNC;", filepath_24)

    End Sub


    Private Function CS_NBHHourCalculation() As String
        Dim cs_nbhhrs As String = String.Empty
        cs_nbhhrs = Get_Query_Result("select right(left(period_start_time,13),2) CS_NBH_HOUR from (select  top(1) period_start_time,sum(Total_Traffic_Voice) Total_Traffic_Voice from  [mapa_4g_reports].[dbo].tbl_hourly_raw group by period_start_time order by Total_Traffic_Voice desc) tbl")
        Return cs_nbhhrs
    End Function

    Private Function PS_NBHHourCalculation() As String
        Dim ps_nbhhrs As String = String.Empty
        ps_nbhhrs = Get_Query_Result("select right(left(period_start_time,13),2) PS_NBH_HOUR from (select  top(1) period_start_time,sum(Radio_Network_Load_PS_Total) Radio_Network_Load_PS_Total from  [mapa_4g_reports].[dbo].tbl_hourly_raw group by period_start_time order by Radio_Network_Load_PS_Total desc) tbl")
        Return ps_nbhhrs
    End Function

    Public Function Get_Query_Result(ByVal Query As String)
        On Error GoTo default_value_of_MySQL
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_4g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim cmd As SqlCommand
        Dim dap As SqlDataAdapter
        Dim dt As System.Data.DataTable
        dap = New SqlDataAdapter(Query, conn)
        dt = New System.Data.DataTable
        DirectCast(dap.SelectCommand, System.Data.SqlClient.SqlCommand).CommandTimeout = 0
        dap.Fill(dt)
        conn.Close()
        dap.Dispose()
        Return dt.Rows(0).Item(0)
default_value_of_MySQL:
        If Err.Number <> 0 Then
            Return "NO VALUE"
            Resume Next
        End If
        Return 0
    End Function
    Public Function Get_Query_Result_2G(ByVal Query As String)
        On Error GoTo default_value_of_MySQL
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_4g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim cmd As SqlCommand
        Dim dap As SqlDataAdapter
        Dim dt As System.Data.DataTable
        dap = New SqlDataAdapter(Query, conn)
        dt = New System.Data.DataTable
        DirectCast(dap.SelectCommand, System.Data.SqlClient.SqlCommand).CommandTimeout = 0
        dap.Fill(dt)
        conn.Close()
        dap.Dispose()
        Return dt.Rows(0).Item(0)
default_value_of_MySQL:
        If Err.Number <> 0 Then
            Return "NO VALUE"
            Resume Next
        End If
        Return 0
    End Function


    Public Function Get_Query_Result_two(ByVal Query As String, ByVal Query1 As String)
        On Error GoTo default_value_of_MySQL
        Dim conn = New SqlConnection
        conn.ConnectionString = "Data Source=DESKTOP-VAILRIS;Initial Catalog=mapa_4g_reports; User ID=pmuser; Password=pmuser"
        If conn.State = ConnectionState.Closed = True Then
            conn.Open()
        End If
        Dim cmd As SqlCommand
        Dim dt As System.Data.DataTable
        Dim dt1 As System.Data.DataTable
        cmd = New SqlCommand(Query, conn)
        cmd.CommandTimeout = 0
        Dim temp1 As Double
        temp1 = cmd.ExecuteScalar()
        conn.Close()
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        cmd = New SqlCommand(quer, conn)
        cmd.CommandTimeout = 0
        cmd.ExecuteNonQuery()
        cmd = New SqlCommand(Query1, conn)
        cmd.CommandTimeout = 0
        Dim temp2 As Double
        temp2 = cmd.ExecuteScalar()
        conn.Close()
        Dim dd = 100 * temp1 / temp2
        Return 100 * temp1 / temp2
default_value_of_MySQL:
        If Err.Number <> 0 Then
            Return "NO VALUE"
            Resume Next
        End If
        Return 0
    End Function
    Sub make_dir()
        Dim kpifolder As String
        Dim targetpath As String
        Dim testdir As String
        kpifolder = "D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr
        targetpath = "D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Logs " + CIRCLE_NAME + "\" + kpi_fldr + "\"
        targetpath = kpifolder
        If Dir(targetpath, vbDirectory) = "" Then
            testdir = False
        Else : testdir = True
        End If
        If testdir = True Then
        Else
            MkDir(kpifolder)
        End If
        kpifolder = "D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Processed Files " + CIRCLE_NAME + "\" + kpi_fldr
        targetpath = "D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Processed Files " + CIRCLE_NAME + "\" + kpi_fldr + "\"
        targetpath = kpifolder
        If Dir(targetpath, vbDirectory) = "" Then
            testdir = False
        Else : testdir = True
        End If
        If testdir = True Then
        Else
            MkDir(kpifolder)
        End If
        kpifolder = "D:\PM\Validation\AUTOMATED_MAPA_4G\Final Mapa Output " + CIRCLE_NAME
        targetpath = "D:\PM\Validation\AUTOMATED_MAPA_4G\Final Mapa Output " + CIRCLE_NAME + "\"
        targetpath = kpifolder
        If Dir(targetpath, vbDirectory) = "" Then
            testdir = False
        Else : testdir = True
        End If
        If testdir = True Then
        Else
            MkDir(kpifolder)
        End If
    End Sub
    Sub write_old()
        'killexcel()
        Dim todays_column As Integer
        Dim cssr As String = 0
        Dim cname As String = ""
        Dim cpass As String = ""
        Dim tchdropnew As String = 0
        Dim ori_sheetnames = sheetnames
        Dim xlTmp As Microsoft.Office.Interop.Excel.Application
        xlTmp = New Microsoft.Office.Interop.Excel.Application
        If CIRCLE_NAME = "TZ" Then
            cname = "MAPA_4G_TZ_"
            ' cpass = "EAST@ar_2012"
        End If
        If MAPADATE.ToString("dd") = 26 Then
            xlTmp.Workbooks.Open("D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Templates\MAPA_4G_TZ.xlsx")
        Else
            If (File.Exists("D:\PM\Validation\AUTOMATED_MAPA_4G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_OPEN_DATE + ".xlsx")) Then
                xlTmp.Workbooks.Open("D:\PM\Validation\AUTOMATED_MAPA_4G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_OPEN_DATE + ".xlsx")
            Else
                xlTmp.Workbooks.Open("D:\PM\Validation\AUTOMATED_MAPA_4G\Mapa Templates\MAPA_4G_TZ.xlsx")
            End If
        End If
        Dim xlSht As Microsoft.Office.Interop.Excel.Worksheet
        Dim mnth As Integer = 0
        If (cutting_date >= 26) Then
            todays_column = cutting_date - 19
        Else
            mnth = Date.DaysInMonth(Format(MAPADATE.AddMonths(-1), "yyyy"), Format(MAPADATE.AddMonths(-1), "MM"))
            If (mnth = 31) Then
                todays_column = cutting_date + 12
            ElseIf (mnth = 30) Then
                todays_column = cutting_date + 11
            ElseIf (mnth = 29) Then
                todays_column = cutting_date + 10
            ElseIf (mnth = 28) Then
                todays_column = cutting_date + 9
            End If
        End If
        todays_column = todays_column - 1

        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.1
        xlSht = xlTmp.Sheets("Total Capacity")
        ' xlSht = xlTmp.Sheets("PLT")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        '=======MAPA 4G ============

        'Total HSS capacity (K)
        xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT (KPI_Value/1000)  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total HLR capacity (K)';").ToString
        'xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total HSS capacity (K)';").ToString
        'No of SGWs
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of SGWs';").ToString
        'No of PGWs
        xlSht.Cells(5, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PGWs';").ToString
        'No of MMEs
        xlSht.Cells(6, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of MMEs';").ToString
        'No of PCRFs
        xlSht.Cells(7, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PCRFs';").ToString
        'Total EPC Capacity (BHCA)
        xlSht.Cells(8, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total EPC Capacity (BHCA)';").ToString

        'Total eNode B Sites (Active)
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Active' ;").ToString
        'Total eNode B Sites (Under Optimization)
        'Dim siteCount As Integer
        'Dim siteCount2 As Integer
        'siteCount = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G;").ToString
        'siteCount2 = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Active' ;").ToString
        'xlSht.Cells(11, todays_column) = siteCount - siteCount2
        xlSht.Cells(11, todays_column) = 0
        'Macro Sites(Active)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND   [SITE_STATUS] = 'Active' ;").ToString
        'Micro Sites(Active)
        xlSht.Cells(13, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND     [SITE_STATUS] = 'Active';").ToString
        'IBS Sites(Active)
        xlSht.Cells(14, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND     [SITE_STATUS] = 'Active';").ToString
        'Total eNode B Cells 
        xlSht.Cells(15, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G   WHERE     [SITE_STATUS] = 'Active' ;").ToString
        'Macro Cells
        xlSht.Cells(16, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND     [SITE_STATUS] = 'Active' ;").ToString
        'Micro Cells
        xlSht.Cells(17, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND     [SITE_STATUS] = 'Active';").ToString
        'IBS Cells
        xlSht.Cells(18, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND     [SITE_STATUS] = 'Active';").ToString
        '4T4R Cells
        xlSht.Cells(19, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '4T4R' AND     [SITE_STATUS] = 'Active';").ToString
        '2T2R Cells
        xlSht.Cells(20, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '2T2R' AND     [SITE_STATUS] = 'Active';").ToString
        '****end vstatic****

        '****HSS Sub****
        'Total HSS Subs (2G+3G+LTE)
        xlSht.Cells(22, todays_column) = Get_Query_Result("  select sum([Total_HLR]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'HSS Subs(with LTE Profile)
        'Attached Subs
        xlSht.Cells(24, todays_column) = Get_Query_Result("select sum(Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Detached Subs
        xlSht.Cells(25, todays_column) = Get_Query_Result("select sum(Total_VLR-Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Registered LTE Subs
        'Unregistered LTE Subs
        'In Roamers
        xlSht.Cells(28, todays_column) = Get_Query_Result("select sum(Total_InRoamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Out Roamers
        xlSht.Cells(29, todays_column) = Get_Query_Result("select sum(Total_outroamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        '****endn HSS Sub****

        '***Radio Traffic(MB)*******
        'Total NBH Traffic (NBH)
        xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total BBH Traffic (BBH)
        xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total 24 HrsTraffic (24 Hrs)
        xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '***end Radio Traffic(MB)***

        '****Data Volume - MB*****
        'Data Volume(DL) - Total_(BBH)
        xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 1_(BBH)
        xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_1/1024) Data_Volume_DL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 2_(BBH)
        xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_2/1024) Data_Volume_DL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 3_(BBH)
        xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_3/1024) Data_Volume_DL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 4_(BBH)
        xlSht.Cells(40, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_4/1024) Data_Volume_DL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 5_(BBH)
        xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_5/1024) Data_Volume_DL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 6_(BBH)
        xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_6/1024) Data_Volume_DL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 7_(BBH)
        xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_7/1024) Data_Volume_DL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 8_(BBH)
        xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_8/1024) Data_Volume_DL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(DL) - QCI = 9_(BBH)
        xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_9/1024) Data_Volume_DL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - Total_(BBH)
        xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 1_(BBH)
        xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_1/1024) Data_Volume_UL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 2_(BBH)
        xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_2/1024) Data_Volume_UL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 3_(BBH)
        xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_3/1024) Data_Volume_UL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 4_(BBH)
        xlSht.Cells(50, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_4/1024) Data_Volume_UL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 5_(BBH)
        xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_5/1024) Data_Volume_UL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 6_(BBH)
        xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_6/1024) Data_Volume_UL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 7_(BBH)
        xlSht.Cells(53, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_7/1024) Data_Volume_UL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 8_(BBH)
        xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_8/1024) Data_Volume_UL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Data Volume(UL) - QCI = 9_(BBH)
        xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_9/1024) Data_Volume_UL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average User Number (***)
        xlSht.Cells(56, todays_column) = Get_Query_Result("SELECT AVG(Average_User_Number) Average_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Maximum User Number  (***)
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT MAX(Maximum_User_Number) Maximum_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average Number of downlink cell edge users (CEUs) in a cell  (***)
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_dl_cell_edge_users_CEUs) Avg_nbr_dl_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average Number of uplink cell edge users (CEUs) in a cell  (***)
        xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_ul_cell_edge_users_CEUs) Avg_nbr_ul_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end Data Volume - MB*****

        '****Contactual KPI for Payment Signoff****
        'Total BBH Traffic (BBH)
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'MPS(Mbps Per site)(BBH) (***)
        'xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT SUM(XXXX) XXXXX FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end Contactual KPI for Payment Signoff****

        '****RB & Utilzation*** (BBH) excep CE Ultilization
        'Average Number of used UL PRBs
        xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_UL_PRBs) Average_number_of_used_UL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average Number of used DL PRBs
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_DL_PRBs) Average_number_of_used_DL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' PDSCH   Utilization >90
        xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PDSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PDSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        ' PUSCH   Utilization >90
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PUSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PUSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        ' of cells with RB utilization  >90
        xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_RB_utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_RB_utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        'CCE Utilization
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT AVG(CCE_Utilization) CCE_Utilization FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' of  Node-B with Average used UL PRBs [0,40]
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>=0 and Node_B_with_Avg_used_UL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T;").ToString
        ' of  Node-B with Average used UL PRBs (40,70]
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>40 and Node_B_with_Avg_used_UL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T;").ToString
        ' of  Node-B with Average used UL PRBs (70,100]
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>70 and Node_B_with_Avg_used_UL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T;").ToString
        ' of  Node-B with Average used DL PRBs [0,40]
        xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>=0 and Node_B_with_Avg_used_DL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T;").ToString
        ' of  Node-B with Average used DL PRBs (40,70]
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>40 and Node_B_with_Avg_used_DL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T;").ToString
        ' of  Node-B with Average used DL PRBs (70,100]\
        xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>70 and Node_B_with_Avg_used_DL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T;").ToString
        '****end RB & Utilzation***

        '***eNode B***
        ' of eNode B's with Processor Load >70 (BBH of respective eNode B)
        'xlSht.Cells(77, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN eNodeB_Processor_Load>90 THEN 1 ELSE 0 END) as float)/(COUNT(site_name)) FROM (SELECT eNodeB_Processor_Load,site_name  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        xlSht.Cells(77, todays_column) = "NA"
        '***end eNode B***

        '***CPU*** (NBH)
        'Peak Processor Load -MME
        xlSht.Cells(79, todays_column) = "NA"
        'Peak Processor Load -SGW
        xlSht.Cells(80, todays_column) = "NA"
        'Peak Processor Load -PGW
        xlSht.Cells(81, todays_column) = "NA"
        'Peak Processor Load -HSS
        xlSht.Cells(82, todays_column) = "NA"
        '***end CPU***

        '*****Interface*****
        ' of S1-UP links Utilization>90
        xlSht.Cells(84, todays_column) = "NA"
        'xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_UP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_UP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        ' of S1-CP links Utilization>90
        xlSht.Cells(85, todays_column) = "NA"
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_CP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_CP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        '*****end Interface*****

        '***Radio Traffic(GB)****
        'Total NBH Traffic_DL (NBH)
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total NBH Traffic_UL (NBH)
        xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total BBH Traffic_DL (BBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total BBH Traffic_UL (BBH)
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total 24 Hrs Traffic_DL (24Hrs)
        xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total 24 Hrs Traffic_UL (24Hrs)
        xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '***end Radio Traffic(GB)****


        '****Network Availability****
        'Network Availability Total
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Network Availability Total (NBH hrs)
        xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Network Availability Total (7am to 11pm)  
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and right(period_start_time,2)>=07 ;").ToString
        'xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Core Service Availability
        xlSht.Cells(97, todays_column) = Get_Query_Result("SELECT avg(Core_Service_Availability) Core_Service_Availability FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' of E UTRAN cells having Radio Network Availability >=99.7
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Network_Availability_Total>99.7 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Network_Availability_Total,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_NBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        '***end *Network Availability****

        '***EPC KPI****
        'Attach Success rate excluding Unregistered subs (24hrs)
        xlSht.Cells(100, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Attach_Success_rate_excluding_Unregistered_subs_DENOM = 0 then 100 else Attach_Success_rate_excluding_Unregistered_subs_NUM/Attach_Success_rate_excluding_Unregistered_subs_DENOM) Attach_Success_rate_excluding_Unregistered_subs FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Tracking  Area update completion Rate
        xlSht.Cells(101, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Tracking_Area_update_completion_Rate_DENOM = 0 then 100 else Tracking_Area_update_completion_Rate_NUM/Tracking_Area_update_completion_Rate_DENOM) Tracking_Area_update_completion_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'S1 mode intra-MME TAU success rate
        xlSht.Cells(102, todays_column) = "NA"
        'S1 mode inter-MME TAU success rate
        xlSht.Cells(103, todays_column) = "NA"
        'Paging Success Rate for LTE Calls
        xlSht.Cells(104, todays_column) = "NA"
        'Operator wise LTE LU success rate for International InRoamers And OutRoamers
        xlSht.Cells(105, todays_column) = "NA"
        '***End PC KPI****

        '****RRC Setup Index*****
        'RRC setup Success  ratio () (24Hrs)
        xlSht.Cells(108, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total RRC Attempt (NBH)  (***)    NBH(19:00 to 20:00 Hrs)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'RRC setup Success  ratio () (24Hrs)
        xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Number of RRC Attempts (NBH)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'RRC Drop Rate ()
        xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT AVG(RRC_Drop_Rate) RRC_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'E-UTRAN RRC Paging Discard Ratio
        xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Paging_Discard_Ratio) E_UTRAN_RRC_Paging_Discard_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'E UTRAN RRC Setup And Access Completion Ratio (NBH)
        xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Setup_and_Access_Completion_Ratio) E_UTRAN_RRC_Setup_and_Access_Completion_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'E-RAB success rate
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(RRC_Registration_success_rate_ERAB) RRC_Registration_success_rate_ERAB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' of cells with PS E UTRAN RRC Setup And Access Completion Ratio >=98
        xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        'RRC Setup Success Rate (Service)
        xlSht.Cells(117, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_Service) RRC_Setup_Success_Rate_Service FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'RRC Setup Success Rate (signaling)
        xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_signaling) RRC_Setup_Success_Rate_signaling FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average RRC connection setup duration
        xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT AVG(Average_RRC_connection_setup_duration) Average_RRC_connection_setup_duration FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end RRC Setup Index*****

        '****Congestion****
        'RRC Blocking Rate
        xlSht.Cells(121, todays_column) = Get_Query_Result("select (case when sum(RRC_Drop_Rate_Denom)>0 then 100*sum(RRC_Drop_Rate_Nom)/sum(RRC_Drop_Rate_Denom) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'E-RAB Blocking Rate
        xlSht.Cells(122, todays_column) = Get_Query_Result("select (case when sum(E_RAB_Blocking_Rate_DENOM)>0 then 100*sum(E_RAB_Blocking_Rate_NUM)/sum(E_RAB_Blocking_Rate_DENOM) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end Congestion**

        '****eRAB KPIs****
        'Number of E-RAB Setup Attempts
        xlSht.Cells(124, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Setup_Attempts) Number_of_E_RAB_Setup_Attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' of cells with PS E UTRAN RAB Setup Success Rate >=98
        xlSht.Cells(125, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_24hrs_houly_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        'E-RAB Setup Success Rate (All)
        xlSht.Cells(126, todays_column) = Get_Query_Result("SELECT 100*(case when sum(E_RAB_Setup_Success_Rate_All_Denom)>0 then sum(E_RAB_Setup_Success_Rate_All_Nom)/sum(E_RAB_Setup_Success_Rate_All_Denom) else 1 end) E_RAB_Setup_Success_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Number of Initial E-RAB Setup Success
        xlSht.Cells(127, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_InitiaL_E_RAB_Setup_Success) Number_of_InitiaL_E_RAB_Setup_Success FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Initial E - RAB Setup Success Rate ()
        xlSht.Cells(128, todays_column) = Get_Query_Result("SELECT AVG(InitiaL_E_RAB_Setup_Success_Rate) InitiaL_E_RAB_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average E - RAB setup duration in a cell
        xlSht.Cells(129, todays_column) = Get_Query_Result("SELECT AVG(Average_E_RAB_setup_duration_in_a_cell) Average_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average initial E-RAB setup duration in a cell
        xlSht.Cells(130, todays_column) = Get_Query_Result("SELECT AVG(Average_initiaL_E_RAB_setup_duration_in_a_cell) Average_initiaL_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end eRAB KPIs****

        '****Radio Network Retainability***
        'PS Drop Call Rate (PDP Busy Hour))
        xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT AVG(PS_Drop_Call_Rate) PS_Drop_Call_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' Of cells with PS Drop Call Rate <=1
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        'Number of E-RAB Drops
        xlSht.Cells(134, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Drops) Number_of_E_RAB_Drops FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'E-RAB Drop Rate ()
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT AVG(E_RAB_Drop_Rate) E_RAB_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Service Drop Rate (All)
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT AVG(Service_Drop_Rate_All) Service_Drop_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'CStr(Call Successfully Terminated Ratio)
        xlSht.Cells(137, todays_column) = "NA"
        'xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'CStr(Call Successfully Terminated Ratio)
        xlSht.Cells(138, todays_column) = "NA"
        'xlSht.Cells(138, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'CStr(Call Successfully Terminated Ratio)
        xlSht.Cells(139, todays_column) = "NA"
        'xlSht.Cells(139, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end Radio Network Retainability***

        '*****Radio Network Mobility****
        'PS handover success rate (LTE Intra System )
        xlSht.Cells(141, todays_column) = Get_Query_Result("SELECT AVG(PS_handover_success_rate_LTE_Intra_System) PS_handover_success_rate_LTE_Intra_System FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Intra Frequency Handover Success Rate
        xlSht.Cells(142, todays_column) = Get_Query_Result("SELECT AVG(Intra_Frequency_Handover_Success_Rate) Intra_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Inter Frequency Handover Success Rate
        xlSht.Cells(143, todays_column) = Get_Query_Result("SELECT AVG(Inter_Frequency_Handover_Success_Rate) Inter_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'PS Inter System Handover Success Rate ( LTE- 2G/3G And 2G/3G - LTE)  
        xlSht.Cells(144, todays_column) = Get_Query_Result("SELECT AVG(PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE) PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' of cells with PS Inter System Handover Success Rate( LTE - 3G, LTE-2G, LTE - WIFI, LTE-CDMA) >=96
        xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        'Inter RAT Handover Success Rate (LTE-UTRAN)
        xlSht.Cells(146, todays_column) = Get_Query_Result("SELECT AVG(Inter_RAT_HOSR_LTE_UTRAN) Inter_RAT_HOSR_LTE_UTRAN FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'CSFB Preparation Success Rate 
        xlSht.Cells(147, todays_column) = Get_Query_Result("SELECT AVG(CSFB_Preparation_Success_Rate) CSFB_Preparation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'IRAT PS Redirection Preparation success rate(L2W)[]
        xlSht.Cells(148, todays_column) = Get_Query_Result("SELECT AVG(IRAT_PS_Redirection_Preparation_SR_L2W) IRAT_PS_Redirection_Preparation_SR_L2W FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Average handover duration from E-UTRAN to WCDMA network
        xlSht.Cells(149, todays_column) = Get_Query_Result("SELECT AVG(AvG_HO_duration_from_E_UTRAN_to_WCDMA) AvG_HO_duration_from_E_UTRAN_to_WCDMA FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Handover Procedure Time
        xlSht.Cells(150, todays_column) = "NA"
        'xlSht.Cells(150, todays_column) = Get_Query_Result("SELECT AVG(Handover_Procedure_Time) Handover_Procedure_Time FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '*****end Radio Network Mobility****

        '***Quality/ Service Intergrity****
        'PS BLER
        xlSht.Cells(152, todays_column) = Get_Query_Result("SELECT AVG(PS_BLER) PS_BLER FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'E-UTRAN RLC PDU Re-transmission Ratio Downlink
        xlSht.Cells(153, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RLC_PDU_Re_trans_Ratio_DL) E_UTRAN_RLC_PDU_Re_trans_Ratio_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'E-UTRAN Average CQI
        xlSht.Cells(154, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_Average_CQI1) E_UTRAN_Average_CQI1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'DL Packet Loss Rate (PDPC)
        xlSht.Cells(155, todays_column) = Get_Query_Result("SELECT AVG(DL_Packet_Loss_Rate_PDPC) DL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'UL Packet Loss Rate (PDPC)
        xlSht.Cells(156, todays_column) = Get_Query_Result("SELECT AVG(UL_Packet_Loss_Rate_PDPC) UL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' of cells with Average PS DL Throughput  >=20 Mbps And >=Y Mbps at Cell Edge (Cell Data Busy Hour)
        xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Average_DL_PDCP_Throughput>=20 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_DL_PDCP_Throughput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        'Total Downlink Traffic Volume
        xlSht.Cells(158, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total Uplink Traffic Volume
        xlSht.Cells(159, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Cell Average DL PDCP Throughput
        xlSht.Cells(160, todays_column) = Get_Query_Result("SELECT AVG(Average_DL_PDCP_Throughput) Average_DL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Cell Average UL PDCP Throughput
        xlSht.Cells(161, todays_column) = Get_Query_Result("SELECT AVG(Average_UL_PDCP_Throughput) Average_UL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        ' Cells with Cell Avg Throughput < 4 Mbps
        xlSht.Cells(162, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Cell_Avg_Thput>=4 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Cell_Avg_Thput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active' )T ;").ToString
        'User Downlink Average Throughput
        xlSht.Cells(163, todays_column) = Get_Query_Result("SELECT AVG(User_Downlink_Average_Throughput) User_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'User Uplink Average Throughput
        xlSht.Cells(164, todays_column) = Get_Query_Result("SELECT AVG(User_Uplink_Average_Throughput) User_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Service Downlink Average Throughput
        xlSht.Cells(165, todays_column) = Get_Query_Result("SELECT AVG(Service_Downlink_Average_Throughput) Service_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Service Uplink Average Throughput
        xlSht.Cells(166, todays_column) = Get_Query_Result("SELECT AVG(Service_Uplink_Average_Throughput) Service_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Cell Max Throughput (Downlink)
        xlSht.Cells(167, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_DL) Cell_Max_Throughput_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Cell Max Throughput (Uplink)
        xlSht.Cells(168, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_UL) Cell_Max_Throughput_UL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '***end Quality/ Service Intergrity****

        '*****Down time****
        'No.of Locked Sites
        xlSht.Cells(171, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Lock' ;").ToString
        'No.of Locked Cells
        xlSht.Cells(172, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [SITE_STATUS] = 'Lock';").ToString
        'Total Cell Outage (Minutes)
        xlSht.Cells(173, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  ;").ToString
        'Planned Cell Outage (Minutes)
        xlSht.Cells(174, todays_column) = 0
        'Unplanned Cell Outage (Minutes)
        xlSht.Cells(175, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  ;").ToString
        'Total Cell Available Time (Minutes)
        xlSht.Cells(176, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_4g_reports].[dbo].[SiteDB_4G]  where   SITE_STATUS ='Active' ").ToString
        '*****end Down time****

        '****Transport Network*****
        'Average forward packet loss rate on the IP PM
        xlSht.Cells(178, todays_column) = Get_Query_Result("select (case when sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Average_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'; ").ToString
        'Peak forward packet loss rate on the IP PM
        xlSht.Cells(179, todays_column) = Get_Query_Result("select (case when sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Peak_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'; ").ToString
        'Average RTT on the IP PM
        xlSht.Cells(180, todays_column) = Get_Query_Result("SELECT AVG(Average_RTT_on_the_IP_PM) Average_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Maximum RTT on the IP PM
        xlSht.Cells(181, todays_column) = Get_Query_Result("SELECT MAX(Maximum_RTT_on_the_IP_PM) Maximum_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end Transport Network*****

        '****Others*****
        'CSFB attempts towards 2G/3G
        xlSht.Cells(183, todays_column) = Get_Query_Result("SELECT SUM(CSFB_attempts_towards_2G_3G) CSFB_attempts_towards_2G_3G FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'CSFB Call attempts 
        xlSht.Cells(184, todays_column) = Get_Query_Result("SELECT SUM(CSFB_Call_attempts) CSFB_Call_attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'CSFB success rate 
        xlSht.Cells(185, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'; ").ToString
        'CSFB success rate 
        xlSht.Cells(186, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'; ").ToString
        'Paging for CSFB 
        xlSht.Cells(187, todays_column) = "NA"
        'xlSht.Cells(187, todays_column) = Get_Query_Result("SELECT SUM(Paging_for_CSFB) Paging_for_CSFB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'S1 Setup Success Rate ()
        xlSht.Cells(188, todays_column) = "NA"
        'xlSht.Cells(188, todays_column) = Get_Query_Result("SELECT AVG(S1_Setup_Success_Rate) S1_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Number S1 Setup Failure
        xlSht.Cells(189, todays_column) = "NA"
        'xlSht.Cells(189, todays_column) = Get_Query_Result("SELECT COUNT(Number_S1_Setup_Failure) Number_S1_Setup_Failure FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total Number of Bearers(Dedicated)
        xlSht.Cells(190, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total Number of Bearers(Dedicated)
        xlSht.Cells(191, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Total Number of Bearers(Default)
        xlSht.Cells(192, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Default) Total_Number_of_Bearers_Default FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Inter MME Handover Success Rate
        xlSht.Cells(193, todays_column) = Get_Query_Result("select (case when sum(Inter_MME_Handover_Success_Rate_DENOM)>0 then 100*sum(Inter_MME_Handover_Success_Rate_NUM)/sum(Inter_MME_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'; ").ToString
        'S1  Handover Success Rate
        xlSht.Cells(194, todays_column) = Get_Query_Result("select (case when sum(S1_Handover_Success_Rate_DENOM)>0 then 100*sum(S1_Handover_Success_Rate_NUM)/sum(S1_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'; ").ToString
        'X2 Handover Success Rate
        xlSht.Cells(195, todays_column) = Get_Query_Result("select (case when sum(X2_Handover_Success_Rate_DENOM)>0 then 100*sum(X2_Handover_Success_Rate_NUM)/sum(X2_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'; ").ToString
        '(SGs) Failure Ratio
        xlSht.Cells(196, todays_column) = "NA"
        'xlSht.Cells(196, todays_column) = Get_Query_Result("SELECT AVG(SGs_Failure_Ratio) SGs_Failure_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Default Bearer Activation Success Rate
        xlSht.Cells(197, todays_column) = "NA"
        'xlSht.Cells(197, todays_column) = Get_Query_Result("SELECT AVG(Default_Bearer_Activation_Success_Rate) Default_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Dedicated Bearer Activation Success Rate
        xlSht.Cells(198, todays_column) = "NA"
        'xlSht.Cells(198, todays_column) = Get_Query_Result("SELECT AVG(Dedicated_Bearer_Activation_Success_Rate) Dedicated_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'S1 mode intra-MME Handover success rate
        xlSht.Cells(199, todays_column) = "NA"
        'xlSht.Cells(199, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_intra_MME_Handover_success_rate) S1_mode_intra_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'S1 mode inter-MME Handover success rate
        xlSht.Cells(200, todays_column) = "NA"
        'xlSht.Cells(200, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_inter_MME_Handover_success_rate) S1_mode_inter_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Security mode command success rate
        xlSht.Cells(201, todays_column) = "NA"
        'xlSht.Cells(201, todays_column) = Get_Query_Result("SELECT AVG(security_mode_command_success_rate) security_mode_command_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Authentication Success Rate
        xlSht.Cells(202, todays_column) = "NA"
        'xlSht.Cells(202, todays_column) = Get_Query_Result("SELECT AVG(Authentication_Success_Rate) Authentication_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        '****end Others*****
        '*******NEW KPIS (for New RnP)****** 
        'Call Setup Succes rate(CSSR)
        xlSht.Cells(203, todays_column) = ""

        'RACH Setup Success Rate
        xlSht.Cells(204, todays_column) = ""

        'LTE Service Normal Release Rate
        xlSht.Cells(205, todays_column) = ""

        'nGBR Downlink Retransmission Rate
        xlSht.Cells(206, todays_column) = ""

        'nGBR Uplink Retransmission Rate
        xlSht.Cells(207, todays_column) = ""
        '****end NEW KPIS (for New RnP)****




        '------PLT=------------------------------
        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.2
        'xlSht = xlTmp.Sheets("Total Capacity")
        'xlSht = xlTmp.Sheets("3G KPI")
        xlSht = xlTmp.Sheets("PLT")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Total HSS capacity (K)
        xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT (KPI_Value/1000)  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total HLR capacity (K)';").ToString
        'xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total HSS capacity (K)';").ToString
        'No of SGWs
        xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of SGWs';").ToString
        'No of PGWs
        xlSht.Cells(5, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PGWs';").ToString
        'No of MMEs
        xlSht.Cells(6, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of MMEs';").ToString
        'No of PCRFs
        xlSht.Cells(7, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PCRFs';").ToString
        'Total EPC Capacity (BHCA)
        xlSht.Cells(8, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total EPC Capacity (BHCA)';").ToString

        'Total eNode B Sites (Active)
        xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [SITE_STATUS] = 'Active'     AND Site_Preference = 'Platinum' ;").ToString
        'Total eNode B Sites (Under Optimization)
        'Dim siteCount As Integer
        'Dim siteCount2 As Integer
        'siteCount = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G;").ToString
        'siteCount2 = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Active'  ;").ToString
        'xlSht.Cells(11, todays_column) = siteCount - siteCount2
        xlSht.Cells(11, todays_column) = 0
        'Macro Sites(Active)
        xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND [SITE_STATUS] = 'Active'  AND Site_Preference = 'Platinum' ;").ToString
        'Micro Sites(Active)
        xlSht.Cells(13, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND [SITE_STATUS] = 'Active'   AND Site_Preference = 'Platinum' ;").ToString
        'IBS Sites(Active)
        xlSht.Cells(14, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND [SITE_STATUS] = 'Active'   AND Site_Preference = 'Platinum' ;").ToString
        'Total eNode B Cells 
        xlSht.Cells(15, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G   WHERE [SITE_STATUS] = 'Active'   AND Site_Preference = 'Platinum' ;").ToString
        'Macro Cells
        xlSht.Cells(16, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND [SITE_STATUS] = 'Active'  AND Site_Preference = 'Platinum' ;").ToString
        'Micro Cells
        xlSht.Cells(17, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND [SITE_STATUS] = 'Active'   AND Site_Preference = 'Platinum' ;").ToString
        'IBS Cells
        xlSht.Cells(18, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND [SITE_STATUS] = 'Active'   AND Site_Preference = 'Platinum' ;").ToString
        '4T4R Cells
        xlSht.Cells(19, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '4T4R' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Platinum' ;").ToString
        '2T2R Cells
        xlSht.Cells(20, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '2T2R' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Platinum' ;").ToString
        '****end vstatic****


        '****HSS Sub****
        'Total HSS Subs (2G+3G+LTE)
        xlSht.Cells(22, todays_column) = Get_Query_Result("  select sum([Total_HLR]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'HSS Subs(with LTE Profile)
        'Attached Subs
        xlSht.Cells(24, todays_column) = Get_Query_Result("select sum(Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Detached Subs
        xlSht.Cells(25, todays_column) = Get_Query_Result("select sum(Total_VLR-Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Registered LTE Subs
        'Unregistered LTE Subs
        'In Roamers
        xlSht.Cells(28, todays_column) = Get_Query_Result("select sum(Total_InRoamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Out Roamers
        xlSht.Cells(29, todays_column) = Get_Query_Result("select sum(Total_outroamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        '****endn HSS Sub****

        '***Radio Traffic(MB)*******
        'Total NBH Traffic (NBH)
        xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total BBH Traffic (BBH)
        xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total 24 HrsTraffic (24 Hrs)
        xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '***end Radio Traffic(MB)***

        '****Data Volume - MB*****
        'Data Volume(DL) - Total_(BBH)
        xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 1_(BBH)
        xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_1/1024) Data_Volume_DL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 2_(BBH)
        xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_2/1024) Data_Volume_DL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 3_(BBH)
        xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_3/1024) Data_Volume_DL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 4_(BBH)
        xlSht.Cells(40, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_4/1024) Data_Volume_DL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 5_(BBH)
        xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_5/1024) Data_Volume_DL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 6_(BBH)
        xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_6/1024) Data_Volume_DL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 7_(BBH)
        xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_7/1024) Data_Volume_DL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 8_(BBH)
        xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_8/1024) Data_Volume_DL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(DL) - QCI = 9_(BBH)
        xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_9/1024) Data_Volume_DL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - Total_(BBH)
        xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 1_(BBH)
        xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_1/1024) Data_Volume_UL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 2_(BBH)
        xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_2/1024) Data_Volume_UL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 3_(BBH)
        xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_3/1024) Data_Volume_UL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 4_(BBH)
        xlSht.Cells(50, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_4/1024) Data_Volume_UL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 5_(BBH)
        xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_5/1024) Data_Volume_UL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 6_(BBH)
        xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_6/1024) Data_Volume_UL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 7_(BBH)
        xlSht.Cells(53, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_7/1024) Data_Volume_UL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 8_(BBH)
        xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_8/1024) Data_Volume_UL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Data Volume(UL) - QCI = 9_(BBH)
        xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_9/1024) Data_Volume_UL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average User Number (***)
        xlSht.Cells(56, todays_column) = Get_Query_Result("SELECT AVG(Average_User_Number) Average_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Maximum User Number  (***)
        xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT MAX(Maximum_User_Number) Maximum_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average Number of downlink cell edge users (CEUs) in a cell  (***)
        xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_dl_cell_edge_users_CEUs) Avg_nbr_dl_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average Number of uplink cell edge users (CEUs) in a cell  (***)
        xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_ul_cell_edge_users_CEUs) Avg_nbr_ul_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end Data Volume - MB*****

        '****Contactual KPI for Payment Signoff****
        'Total BBH Traffic (BBH)
        xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'MPS(Mbps Per site)(BBH) (***)
        'xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT SUM(XXXX) XXXXX FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end Contactual KPI for Payment Signoff****

        '****RB & Utilzation*** (BBH) excep CE Ultilization
        'Average Number of used UL PRBs
        xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_UL_PRBs) Average_number_of_used_UL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average Number of used DL PRBs
        xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_DL_PRBs) Average_number_of_used_DL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' PDSCH   Utilization >90
        xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PDSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PDSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        ' PUSCH   Utilization >90
        xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PUSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PUSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        ' of cells with RB utilization  >90
        xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_RB_utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_RB_utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        'CCE Utilization
        xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT AVG(CCE_Utilization) CCE_Utilization FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' of  Node-B with Average used UL PRBs [0,40]
        xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>=0 and Node_B_with_Avg_used_UL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T;").ToString
        ' of  Node-B with Average used UL PRBs (40,70]
        xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>40 and Node_B_with_Avg_used_UL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T;").ToString
        ' of  Node-B with Average used UL PRBs (70,100]
        xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>70 and Node_B_with_Avg_used_UL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T;").ToString
        ' of  Node-B with Average used DL PRBs [0,40]
        xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>=0 and Node_B_with_Avg_used_DL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T;").ToString
        ' of  Node-B with Average used DL PRBs (40,70]
        xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>40 and Node_B_with_Avg_used_DL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T;").ToString
        ' of  Node-B with Average used DL PRBs (70,100]\
        xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>70 and Node_B_with_Avg_used_DL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T;").ToString
        '****end RB & Utilzation***

        '***eNode B***
        ' of eNode B's with Processor Load >70 (BBH of respective eNode B)
        'xlSht.Cells(77, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN eNodeB_Processor_Load>90 THEN 1 ELSE 0 END) as float)/(COUNT(site_name)) FROM (SELECT eNodeB_Processor_Load,site_name  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        xlSht.Cells(77, todays_column) = "NA"
        '***end eNode B***

        '***CPU*** (NBH)
        'Peak Processor Load -MME
        xlSht.Cells(79, todays_column) = "NA"
        'Peak Processor Load -SGW
        xlSht.Cells(80, todays_column) = "NA"
        'Peak Processor Load -PGW
        xlSht.Cells(81, todays_column) = "NA"
        'Peak Processor Load -HSS
        xlSht.Cells(82, todays_column) = "NA"
        '***end CPU***

        '*****Interface*****
        ' of S1-UP links Utilization>90
        xlSht.Cells(84, todays_column) = "NA"
        'xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_UP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_UP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        ' of S1-CP links Utilization>90
        xlSht.Cells(85, todays_column) = "NA"
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_CP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_CP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        '*****end Interface*****

        '***Radio Traffic(GB)****
        'Total NBH Traffic_DL (NBH)
        xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total NBH Traffic_UL (NBH)
        xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total BBH Traffic_DL (BBH)
        xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total BBH Traffic_UL (BBH)
        xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total 24 Hrs Traffic_DL (24Hrs)
        xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total 24 Hrs Traffic_UL (24Hrs)
        xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '***end Radio Traffic(GB)****

        '****Network Availability****
        'Network Availability Total
        xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Network Availability Total (NBH hrs)
        xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Network Availability Total (7am to 11pm)  
        xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and right(period_start_time,2)>=07   and Site_Preference = 'Platinum';").ToString
        'xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Core Service Availability
        xlSht.Cells(97, todays_column) = Get_Query_Result("SELECT avg(Core_Service_Availability) Core_Service_Availability FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' of E UTRAN cells having Radio Network Availability >=99.7
        xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Network_Availability_Total>99.7 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Network_Availability_Total,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_NBH_KPIs_with_classification  where   SITE_STATUS ='Active'    and Site_Preference = 'Platinum' )T ;").ToString
        '***end *Network Availability****

        '***EPC KPI****
        'Attach Success rate excluding Unregistered subs (24hrs)
        xlSht.Cells(100, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Attach_Success_rate_excluding_Unregistered_subs_DENOM = 0 then 100 else Attach_Success_rate_excluding_Unregistered_subs_NUM/Attach_Success_rate_excluding_Unregistered_subs_DENOM) Attach_Success_rate_excluding_Unregistered_subs FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Tracking  Area update completion Rate
        xlSht.Cells(101, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Tracking_Area_update_completion_Rate_DENOM = 0 then 100 else Tracking_Area_update_completion_Rate_NUM/Tracking_Area_update_completion_Rate_DENOM) Tracking_Area_update_completion_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'S1 mode intra-MME TAU success rate
        xlSht.Cells(102, todays_column) = "NA"
        'S1 mode inter-MME TAU success rate
        xlSht.Cells(103, todays_column) = "NA"
        'Paging Success Rate for LTE Calls
        xlSht.Cells(104, todays_column) = "NA"
        'Operator wise LTE LU success rate for International InRoamers And OutRoamers
        xlSht.Cells(105, todays_column) = "NA"
        '***End PC KPI****

        '****RRC Setup Index*****
        'RRC setup Success  ratio () (24Hrs)
        xlSht.Cells(108, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total RRC Attempt (NBH)  (***)    NBH(19:00 to 20:00 Hrs)
        xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'RRC setup Success  ratio () (24Hrs)
        xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Number of RRC Attempts (NBH)
        xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'RRC Drop Rate ()
        xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT AVG(RRC_Drop_Rate) RRC_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'E-UTRAN RRC Paging Discard Ratio
        xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Paging_Discard_Ratio) E_UTRAN_RRC_Paging_Discard_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'E UTRAN RRC Setup And Access Completion Ratio (NBH)
        xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Setup_and_Access_Completion_Ratio) E_UTRAN_RRC_Setup_and_Access_Completion_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'E-RAB success rate
        xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(RRC_Registration_success_rate_ERAB) RRC_Registration_success_rate_ERAB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' of cells with PS E UTRAN RRC Setup And Access Completion Ratio >=98
        xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        'RRC Setup Success Rate (Service)
        xlSht.Cells(117, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_Service) RRC_Setup_Success_Rate_Service FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'RRC Setup Success Rate (signaling)
        xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_signaling) RRC_Setup_Success_Rate_signaling FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average RRC connection setup duration
        xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT AVG(Average_RRC_connection_setup_duration) Average_RRC_connection_setup_duration FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end RRC Setup Index*****

        '****Congestion****
        'RRC Blocking Rate
        xlSht.Cells(121, todays_column) = Get_Query_Result("select (case when sum(RRC_Drop_Rate_Denom)>0 then 100*sum(RRC_Drop_Rate_Nom)/sum(RRC_Drop_Rate_Denom) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'E-RAB Blocking Rate
        xlSht.Cells(122, todays_column) = Get_Query_Result("select (case when sum(E_RAB_Blocking_Rate_DENOM)>0 then 100*sum(E_RAB_Blocking_Rate_NUM)/sum(E_RAB_Blocking_Rate_DENOM) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end Congestion**
        '****Congestion****

        '****eRAB KPIs****
        'Number of E-RAB Setup Attempts
        xlSht.Cells(124, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Setup_Attempts) Number_of_E_RAB_Setup_Attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' of cells with PS E UTRAN RAB Setup Success Rate >=98
        xlSht.Cells(125, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_24hrs_houly_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        'E-RAB Setup Success Rate (All)
        xlSht.Cells(126, todays_column) = Get_Query_Result("SELECT 100*(case when sum(E_RAB_Setup_Success_Rate_All_Denom)>0 then sum(E_RAB_Setup_Success_Rate_All_Nom)/sum(E_RAB_Setup_Success_Rate_All_Denom) else 1 end) E_RAB_Setup_Success_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Number of Initial E-RAB Setup Success
        xlSht.Cells(127, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_InitiaL_E_RAB_Setup_Success) Number_of_InitiaL_E_RAB_Setup_Success FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Initial E - RAB Setup Success Rate ()
        xlSht.Cells(128, todays_column) = Get_Query_Result("SELECT AVG(InitiaL_E_RAB_Setup_Success_Rate) InitiaL_E_RAB_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average E - RAB setup duration in a cell
        xlSht.Cells(129, todays_column) = Get_Query_Result("SELECT AVG(Average_E_RAB_setup_duration_in_a_cell) Average_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average initial E-RAB setup duration in a cell
        xlSht.Cells(130, todays_column) = Get_Query_Result("SELECT AVG(Average_initiaL_E_RAB_setup_duration_in_a_cell) Average_initiaL_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end eRAB KPIs****

        '****Radio Network Retainability***
        'PS Drop Call Rate (PDP Busy Hour))
        xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT AVG(PS_Drop_Call_Rate) PS_Drop_Call_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' Of cells with PS Drop Call Rate <=1
        xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        'Number of E-RAB Drops
        xlSht.Cells(134, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Drops) Number_of_E_RAB_Drops FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'E-RAB Drop Rate ()
        xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT AVG(E_RAB_Drop_Rate) E_RAB_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Service Drop Rate (All)
        xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT AVG(Service_Drop_Rate_All) Service_Drop_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'CStr(Call Successfully Terminated Ratio)
        xlSht.Cells(137, todays_column) = "NA"
        'xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'CStr(Call Successfully Terminated Ratio)
        xlSht.Cells(138, todays_column) = "NA"
        'xlSht.Cells(138, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'CStr(Call Successfully Terminated Ratio)
        xlSht.Cells(139, todays_column) = "NA"
        'xlSht.Cells(139, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end Radio Network Retainability***

        '*****Radio Network Mobility****
        'PS handover success rate (LTE Intra System )
        xlSht.Cells(141, todays_column) = Get_Query_Result("SELECT AVG(PS_handover_success_rate_LTE_Intra_System) PS_handover_success_rate_LTE_Intra_System FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Intra Frequency Handover Success Rate
        xlSht.Cells(142, todays_column) = Get_Query_Result("SELECT AVG(Intra_Frequency_Handover_Success_Rate) Intra_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Inter Frequency Handover Success Rate
        xlSht.Cells(143, todays_column) = Get_Query_Result("SELECT AVG(Inter_Frequency_Handover_Success_Rate) Inter_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'PS Inter System Handover Success Rate ( LTE- 2G/3G And 2G/3G - LTE)  
        xlSht.Cells(144, todays_column) = Get_Query_Result("SELECT AVG(PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE) PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' of cells with PS Inter System Handover Success Rate( LTE - 3G, LTE-2G, LTE - WIFI, LTE-CDMA) >=96
        xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        'Inter RAT Handover Success Rate (LTE-UTRAN)
        xlSht.Cells(146, todays_column) = Get_Query_Result("SELECT AVG(Inter_RAT_HOSR_LTE_UTRAN) Inter_RAT_HOSR_LTE_UTRAN FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'CSFB Preparation Success Rate 
        xlSht.Cells(147, todays_column) = Get_Query_Result("SELECT AVG(CSFB_Preparation_Success_Rate) CSFB_Preparation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'IRAT PS Redirection Preparation success rate(L2W)[]
        xlSht.Cells(148, todays_column) = Get_Query_Result("SELECT AVG(IRAT_PS_Redirection_Preparation_SR_L2W) IRAT_PS_Redirection_Preparation_SR_L2W FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Average handover duration from E-UTRAN to WCDMA network
        xlSht.Cells(149, todays_column) = Get_Query_Result("SELECT AVG(AvG_HO_duration_from_E_UTRAN_to_WCDMA) AvG_HO_duration_from_E_UTRAN_to_WCDMA FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Handover Procedure Time
        xlSht.Cells(150, todays_column) = "NA"
        'xlSht.Cells(150, todays_column) = Get_Query_Result("SELECT AVG(Handover_Procedure_Time) Handover_Procedure_Time FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '*****end Radio Network Mobility****

        '***Quality/ Service Intergrity****
        'PS BLER
        xlSht.Cells(152, todays_column) = Get_Query_Result("SELECT AVG(PS_BLER) PS_BLER FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'E-UTRAN RLC PDU Re-transmission Ratio Downlink
        xlSht.Cells(153, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RLC_PDU_Re_trans_Ratio_DL) E_UTRAN_RLC_PDU_Re_trans_Ratio_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'E-UTRAN Average CQI
        xlSht.Cells(154, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_Average_CQI1) E_UTRAN_Average_CQI1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'DL Packet Loss Rate (PDPC)
        xlSht.Cells(155, todays_column) = Get_Query_Result("SELECT AVG(DL_Packet_Loss_Rate_PDPC) DL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'UL Packet Loss Rate (PDPC)
        xlSht.Cells(156, todays_column) = Get_Query_Result("SELECT AVG(UL_Packet_Loss_Rate_PDPC) UL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' of cells with Average PS DL Throughput  >=20 Mbps And >=Y Mbps at Cell Edge (Cell Data Busy Hour)
        xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Average_DL_PDCP_Throughput>=20 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_DL_PDCP_Throughput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        'Total Downlink Traffic Volume
        xlSht.Cells(158, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total Uplink Traffic Volume
        xlSht.Cells(159, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Cell Average DL PDCP Throughput
        xlSht.Cells(160, todays_column) = Get_Query_Result("SELECT AVG(Average_DL_PDCP_Throughput) Average_DL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Cell Average UL PDCP Throughput
        xlSht.Cells(161, todays_column) = Get_Query_Result("SELECT AVG(Average_UL_PDCP_Throughput) Average_UL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        ' Cells with Cell Avg Throughput < 4 Mbps
        xlSht.Cells(162, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Cell_Avg_Thput>=4 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Cell_Avg_Thput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' )T ;").ToString
        'User Downlink Average Throughput
        xlSht.Cells(163, todays_column) = Get_Query_Result("SELECT AVG(User_Downlink_Average_Throughput) User_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'User Uplink Average Throughput
        xlSht.Cells(164, todays_column) = Get_Query_Result("SELECT AVG(User_Uplink_Average_Throughput) User_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Service Downlink Average Throughput
        xlSht.Cells(165, todays_column) = Get_Query_Result("SELECT AVG(Service_Downlink_Average_Throughput) Service_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Service Uplink Average Throughput
        xlSht.Cells(166, todays_column) = Get_Query_Result("SELECT AVG(Service_Uplink_Average_Throughput) Service_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Cell Max Throughput (Downlink)
        xlSht.Cells(167, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_DL) Cell_Max_Throughput_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Cell Max Throughput (Uplink)
        xlSht.Cells(168, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_UL) Cell_Max_Throughput_UL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '***end Quality/ Service Intergrity****

        '*****Down time****
        'No.of Locked Sites
        xlSht.Cells(171, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Lock';").ToString
        'No.of Locked Cells
        xlSht.Cells(172, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [SITE_STATUS] = 'Lock';").ToString
        'Total Cell Outage (Minutes)
        xlSht.Cells(173, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'  ;").ToString
        'Planned Cell Outage (Minutes)
        xlSht.Cells(174, todays_column) = 0
        'Unplanned Cell Outage (Minutes)
        xlSht.Cells(175, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'  ;").ToString
        'Total Cell Available Time (Minutes)
        xlSht.Cells(176, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_4g_reports].[dbo].[SiteDB_4G]  where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum' ").ToString
        '*****end Down time****

        '****Transport Network*****
        'Average forward packet loss rate on the IP PM
        xlSht.Cells(178, todays_column) = Get_Query_Result("select (case when sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Average_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'; ").ToString
        'Peak forward packet loss rate on the IP PM
        xlSht.Cells(179, todays_column) = Get_Query_Result("select (case when sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Peak_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'; ").ToString
        'Average RTT on the IP PM
        xlSht.Cells(180, todays_column) = Get_Query_Result("SELECT AVG(Average_RTT_on_the_IP_PM) Average_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Maximum RTT on the IP PM
        xlSht.Cells(181, todays_column) = Get_Query_Result("SELECT MAX(Maximum_RTT_on_the_IP_PM) Maximum_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end Transport Network*****

        '****Others*****
        'CSFB attempts towards 2G/3G
        xlSht.Cells(183, todays_column) = Get_Query_Result("SELECT SUM(CSFB_attempts_towards_2G_3G) CSFB_attempts_towards_2G_3G FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'CSFB Call attempts 
        xlSht.Cells(184, todays_column) = Get_Query_Result("SELECT SUM(CSFB_Call_attempts) CSFB_Call_attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'CSFB success rate 
        xlSht.Cells(185, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'; ").ToString
        'CSFB success rate 
        xlSht.Cells(186, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'; ").ToString
        'Paging for CSFB 
        xlSht.Cells(187, todays_column) = "NA"
        'xlSht.Cells(187, todays_column) = Get_Query_Result("SELECT SUM(Paging_for_CSFB) Paging_for_CSFB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'S1 Setup Success Rate ()
        xlSht.Cells(188, todays_column) = "NA"
        'xlSht.Cells(188, todays_column) = Get_Query_Result("SELECT AVG(S1_Setup_Success_Rate) S1_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Number S1 Setup Failure
        xlSht.Cells(189, todays_column) = "NA"
        'xlSht.Cells(189, todays_column) = Get_Query_Result("SELECT COUNT(Number_S1_Setup_Failure) Number_S1_Setup_Failure FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total Number of Bearers(Dedicated)
        xlSht.Cells(190, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total Number of Bearers(Dedicated)
        xlSht.Cells(191, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Total Number of Bearers(Default)
        xlSht.Cells(192, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Default) Total_Number_of_Bearers_Default FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Inter MME Handover Success Rate
        xlSht.Cells(193, todays_column) = Get_Query_Result("select (case when sum(Inter_MME_Handover_Success_Rate_DENOM)>0 then 100*sum(Inter_MME_Handover_Success_Rate_NUM)/sum(Inter_MME_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'; ").ToString
        'S1  Handover Success Rate
        xlSht.Cells(194, todays_column) = Get_Query_Result("select (case when sum(S1_Handover_Success_Rate_DENOM)>0 then 100*sum(S1_Handover_Success_Rate_NUM)/sum(S1_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'; ").ToString
        'X2 Handover Success Rate
        xlSht.Cells(195, todays_column) = Get_Query_Result("select (case when sum(X2_Handover_Success_Rate_DENOM)>0 then 100*sum(X2_Handover_Success_Rate_NUM)/sum(X2_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum'; ").ToString
        '(SGs) Failure Ratio
        xlSht.Cells(196, todays_column) = "NA"
        'xlSht.Cells(196, todays_column) = Get_Query_Result("SELECT AVG(SGs_Failure_Ratio) SGs_Failure_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Default Bearer Activation Success Rate
        xlSht.Cells(197, todays_column) = "NA"
        'xlSht.Cells(197, todays_column) = Get_Query_Result("SELECT AVG(Default_Bearer_Activation_Success_Rate) Default_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Dedicated Bearer Activation Success Rate
        xlSht.Cells(198, todays_column) = "NA"
        'xlSht.Cells(198, todays_column) = Get_Query_Result("SELECT AVG(Dedicated_Bearer_Activation_Success_Rate) Dedicated_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'S1 mode intra-MME Handover success rate
        xlSht.Cells(199, todays_column) = "NA"
        'xlSht.Cells(199, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_intra_MME_Handover_success_rate) S1_mode_intra_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'S1 mode inter-MME Handover success rate
        xlSht.Cells(200, todays_column) = "NA"
        'xlSht.Cells(200, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_inter_MME_Handover_success_rate) S1_mode_inter_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Security mode command success rate
        xlSht.Cells(201, todays_column) = "NA"
        'xlSht.Cells(201, todays_column) = Get_Query_Result("SELECT AVG(security_mode_command_success_rate) security_mode_command_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        'Authentication Success Rate
        xlSht.Cells(202, todays_column) = "NA"
        ' xlSht.Cells(202, todays_column) = Get_Query_Result("SELECT AVG(Authentication_Success_Rate) Authentication_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Platinum';").ToString
        '****end Others*****



        '------GOLD=------------------------------
        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.3
        'xlSht = xlTmp.Sheets("Total Capacity")
        'xlSht = xlTmp.Sheets("3G KPI")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        'xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Total HSS capacity (K)
        'xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT (KPI_Value/1000)  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total HLR capacity (K)';").ToString
        'xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total HSS capacity (K)';").ToString
        'No of SGWs
        'xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of SGWs';").ToString
        'No of PGWs
        'xlSht.Cells(5, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PGWs';").ToString
        'No of MMEs
        'xlSht.Cells(6, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of MMEs';").ToString
        'No of PCRFs
        'xlSht.Cells(7, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PCRFs';").ToString
        'Total EPC Capacity (BHCA)
        'xlSht.Cells(8, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total EPC Capacity (BHCA)';").ToString

        'Total eNode B Sites (Active)
        'xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Active'   AND Site_Preference = 'Gold' ;").ToString
        'Total eNode B Sites (Under Optimization)
        'Dim siteCount As Integer
        'Dim siteCount2 As Integer
        'siteCount = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G;").ToString
        'siteCount2 = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Active'  ;").ToString
        'xlSht.Cells(11, todays_column) = siteCount - siteCount2
        'xlSht.Cells(11, todays_column) = 0
        'Macro Sites(Active)
        'xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND [SITE_STATUS] = 'Active'    AND Site_Preference = 'Gold' ;").ToString
        'Micro Sites(Active)
        'xlSht.Cells(13, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND [SITE_STATUS] = 'Active'  AND Site_Preference = 'Gold' ;").ToString
        'IBS Sites(Active)
        'xlSht.Cells(14, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Gold' ;").ToString
        'Total eNode B Cells 
        'xlSht.Cells(15, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G   WHERE [SITE_STATUS] = 'Active'  and  Site_Preference = 'Gold' ;").ToString
        'Macro Cells
        'xlSht.Cells(16, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND [SITE_STATUS] = 'Active'   and  Site_Preference = 'Gold' ;").ToString
        'Micro Cells
        'xlSht.Cells(17, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Gold' ;").ToString
        'IBS Cells
        'xlSht.Cells(18, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Gold' ;").ToString
        '4T4R Cells
        'xlSht.Cells(19, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '4T4R' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Gold' ;").ToString
        '2T2R Cells
        'xlSht.Cells(20, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '2T2R' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Gold' ;").ToString
        '****end vstatic****    


        '****HSS Sub****
        'Total HSS Subs (2G+3G+LTE)
        'xlSht.Cells(22, todays_column) = Get_Query_Result("  select sum([Total_HLR]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'HSS Subs(with LTE Profile)
        'Attached Subs
        'xlSht.Cells(24, todays_column) = Get_Query_Result("select sum(Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Detached Subs
        'xlSht.Cells(25, todays_column) = Get_Query_Result("select sum(Total_VLR-Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Registered LTE Subs
        'Unregistered LTE Subs
        'In Roamers
        'xlSht.Cells(28, todays_column) = Get_Query_Result("select sum(Total_InRoamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Out Roamers
        'xlSht.Cells(29, todays_column) = Get_Query_Result("select sum(Total_outroamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        '****endn HSS Sub****

        '***Radio Traffic(MB)*******
        'Total NBH Traffic (NBH)
        'xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total BBH Traffic (BBH)
        'xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total 24 HrsTraffic (24 Hrs)
        'xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '***end Radio Traffic(MB)***

        '****Data Volume - MB*****
        'Data Volume(DL) - Total_(BBH)
        'xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 1_(BBH)
        'xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_1/1024) Data_Volume_DL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 2_(BBH)
        'xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_2/1024) Data_Volume_DL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 3_(BBH)
        'xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_3/1024) Data_Volume_DL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 4_(BBH)
        'xlSht.Cells(40, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_4/1024) Data_Volume_DL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 5_(BBH)
        'xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_5/1024) Data_Volume_DL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 6_(BBH)
        'xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_6/1024) Data_Volume_DL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 7_(BBH)
        'xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_7/1024) Data_Volume_DL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 8_(BBH)
        'xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_8/1024) Data_Volume_DL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(DL) - QCI = 9_(BBH)
        'xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_9/1024) Data_Volume_DL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - Total_(BBH)
        'xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 1_(BBH)
        'xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_1/1024) Data_Volume_UL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 2_(BBH)
        'xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_2/1024) Data_Volume_UL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 3_(BBH)
        'xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_3/1024) Data_Volume_UL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 4_(BBH)
        'xlSht.Cells(50, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_4/1024) Data_Volume_UL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 5_(BBH)
        'xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_5/1024) Data_Volume_UL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 6_(BBH)
        'xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_6/1024) Data_Volume_UL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 7_(BBH)
        'xlSht.Cells(53, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_7/1024) Data_Volume_UL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 8_(BBH)
        'xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_8/1024) Data_Volume_UL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Data Volume(UL) - QCI = 9_(BBH)
        'xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_9/1024) Data_Volume_UL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average User Number (***)
        'xlSht.Cells(56, todays_column) = Get_Query_Result("SELECT AVG(Average_User_Number) Average_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Maximum User Number  (***)
        'xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT MAX(Maximum_User_Number) Maximum_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average Number of downlink cell edge users (CEUs) in a cell  (***)
        'xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_dl_cell_edge_users_CEUs) Avg_nbr_dl_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average Number of uplink cell edge users (CEUs) in a cell  (***)
        'xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_ul_cell_edge_users_CEUs) Avg_nbr_ul_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end Data Volume - MB*****

        '****Contactual KPI for Payment Signoff****
        'Total BBH Traffic (BBH)
        'xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'MPS(Mbps Per site)(BBH) (***)
        'xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT SUM(XXXX) XXXXX FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end Contactual KPI for Payment Signoff****

        '****RB & Utilzation*** (BBH) excep CE Ultilization
        'Average Number of used UL PRBs
        'xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_UL_PRBs) Average_number_of_used_UL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average Number of used DL PRBs
        'xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_DL_PRBs) Average_number_of_used_DL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' PDSCH   Utilization >90
        'xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PDSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PDSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        ' PUSCH   Utilization >90
        'xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PUSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PUSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        ' of cells with RB utilization  >90
        'xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_RB_utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_RB_utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'CCE Utilization
        'xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT AVG(CCE_Utilization) CCE_Utilization FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' of  Node-B with Average used UL PRBs [0,40]
        'xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>=0 and Node_B_with_Avg_used_UL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T;").ToString
        ' of  Node-B with Average used UL PRBs (40,70]
        'xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>40 and Node_B_with_Avg_used_UL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T;").ToString
        ' of  Node-B with Average used UL PRBs (70,100]
        'xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>70 and Node_B_with_Avg_used_UL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T;").ToString
        ' of  Node-B with Average used DL PRBs [0,40]
        'xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>=0 and Node_B_with_Avg_used_DL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T;").ToString
        ' of  Node-B with Average used DL PRBs (40,70]
        'xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>40 and Node_B_with_Avg_used_DL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T;").ToString
        ' of  Node-B with Average used DL PRBs (70,100]\
        'xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>70 and Node_B_with_Avg_used_DL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T;").ToString
        '****end RB & Utilzation***

        '***eNode B***
        ' of eNode B's with Processor Load >70 (BBH of respective eNode B)
        'xlSht.Cells(77, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN eNodeB_Processor_Load>90 THEN 1 ELSE 0 END) as float)/(COUNT(site_name)) FROM (SELECT eNodeB_Processor_Load,site_name  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'xlSht.Cells(77, todays_column) = "NA"
        '***end eNode B***

        '***CPU*** (NBH)
        'Peak Processor Load -MME
        'xlSht.Cells(79, todays_column) = "NA"
        'Peak Processor Load -SGW
        'xlSht.Cells(80, todays_column) = "NA"
        'Peak Processor Load -PGW
        'xlSht.Cells(81, todays_column) = "NA"
        'Peak Processor Load -HSS
        'xlSht.Cells(82, todays_column) = "NA"
        '***end CPU***

        '*****Interface*****
        ' of S1-UP links Utilization>90
        'xlSht.Cells(84, todays_column) = "NA"
        'xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_UP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_UP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        ' of S1-CP links Utilization>90
        'xlSht.Cells(85, todays_column) = "NA"
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_CP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_CP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        '*****end Interface*****

        '***Radio Traffic(GB)****
        'Total NBH Traffic_DL (NBH)
        'xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total NBH Traffic_UL (NBH)
        'xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total BBH Traffic_DL (BBH)
        'xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total BBH Traffic_UL (BBH)
        'xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total 24 Hrs Traffic_DL (24Hrs)
        'xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total 24 Hrs Traffic_UL (24Hrs)
        'xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '***end Radio Traffic(GB)****

        '****Network Availability****
        'Network Availability Total
        ''xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Network Availability Total (NBH hrs)
        'xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Network Availability Total (7am to 11pm)  
        'xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and right(period_start_time,2)>=07   and Site_Preference = 'Gold';").ToString
        'xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Core Service Availability
        'xlSht.Cells(97, todays_column) = Get_Query_Result("SELECT avg(Core_Service_Availability) Core_Service_Availability FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' of E UTRAN cells having Radio Network Availability >=99.7
        'xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Network_Availability_Total>99.7 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Network_Availability_Total,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_NBH_KPIs_with_classification  where   SITE_STATUS ='Active'    and Site_Preference = 'Gold' )T ;").ToString
        '***end *Network Availability****

        '***EPC KPI****
        'Attach Success rate excluding Unregistered subs (24hrs)
        'xlSht.Cells(100, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Attach_Success_rate_excluding_Unregistered_subs_DENOM = 0 then 100 else Attach_Success_rate_excluding_Unregistered_subs_NUM/Attach_Success_rate_excluding_Unregistered_subs_DENOM) Attach_Success_rate_excluding_Unregistered_subs FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Tracking  Area update completion Rate
        'xlSht.Cells(101, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Tracking_Area_update_completion_Rate_DENOM = 0 then 100 else Tracking_Area_update_completion_Rate_NUM/Tracking_Area_update_completion_Rate_DENOM) Tracking_Area_update_completion_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'S1 mode intra-MME TAU success rate
        'xlSht.Cells(102, todays_column) = "NA"
        'S1 mode inter-MME TAU success rate
        'xlSht.Cells(103, todays_column) = "NA"
        'Paging Success Rate for LTE Calls
        'xlSht.Cells(104, todays_column) = "NA"
        'Operator wise LTE LU success rate for International InRoamers And OutRoamers
        'xlSht.Cells(105, todays_column) = "NA"
        '***End PC KPI****

        '****RRC Setup Index*****
        'RRC setup Success  ratio () (24Hrs)
        'xlSht.Cells(108, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total RRC Attempt (NBH)  (***)    NBH(19:00 to 20:00 Hrs)
        'xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'RRC setup Success  ratio () (24Hrs)
        'xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Number of RRC Attempts (NBH)
        'xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'RRC Drop Rate ()
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT AVG(RRC_Drop_Rate) RRC_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'E-UTRAN RRC Paging Discard Ratio
        'xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Paging_Discard_Ratio) E_UTRAN_RRC_Paging_Discard_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'E UTRAN RRC Setup And Access Completion Ratio (NBH)
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Setup_and_Access_Completion_Ratio) E_UTRAN_RRC_Setup_and_Access_Completion_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'E-RAB success rate
        'xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(RRC_Registration_success_rate_ERAB) RRC_Registration_success_rate_ERAB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' of cells with PS E UTRAN RRC Setup And Access Completion Ratio >=98
        'xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'RRC Setup Success Rate (Service)
        'xlSht.Cells(117, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_Service) RRC_Setup_Success_Rate_Service FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'RRC Setup Success Rate (signaling)
        'xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_signaling) RRC_Setup_Success_Rate_signaling FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average RRC connection setup duration
        'xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT AVG(Average_RRC_connection_setup_duration) Average_RRC_connection_setup_duration FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end RRC Setup Index*****

        '****Congestion****
        'RRC Blocking Rate
        'xlSht.Cells(121, todays_column) = Get_Query_Result("select (case when sum(RRC_Drop_Rate_Denom)>0 then 100*sum(RRC_Drop_Rate_Nom)/sum(RRC_Drop_Rate_Denom) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'E-RAB Blocking Rate
        'xlSht.Cells(122, todays_column) = Get_Query_Result("select (case when sum(E_RAB_Blocking_Rate_DENOM)>0 then 100*sum(E_RAB_Blocking_Rate_NUM)/sum(E_RAB_Blocking_Rate_DENOM) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end Congestion**
        '****Congestion****

        '****eRAB KPIs****
        'Number of E-RAB Setup Attempts
        'xlSht.Cells(124, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Setup_Attempts) Number_of_E_RAB_Setup_Attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' of cells with PS E UTRAN RAB Setup Success Rate >=98
        'xlSht.Cells(125, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_24hrs_houly_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'E-RAB Setup Success Rate (All)
        'xlSht.Cells(126, todays_column) = Get_Query_Result("SELECT 100*(case when sum(E_RAB_Setup_Success_Rate_All_Denom)>0 then sum(E_RAB_Setup_Success_Rate_All_Nom)/sum(E_RAB_Setup_Success_Rate_All_Denom) else 1 end) E_RAB_Setup_Success_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Number of Initial E-RAB Setup Success
        'xlSht.Cells(127, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_InitiaL_E_RAB_Setup_Success) Number_of_InitiaL_E_RAB_Setup_Success FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Initial E - RAB Setup Success Rate ()
        'xlSht.Cells(128, todays_column) = Get_Query_Result("SELECT AVG(InitiaL_E_RAB_Setup_Success_Rate) InitiaL_E_RAB_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average E - RAB setup duration in a cell
        'xlSht.Cells(129, todays_column) = Get_Query_Result("SELECT AVG(Average_E_RAB_setup_duration_in_a_cell) Average_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average initial E-RAB setup duration in a cell
        'xlSht.Cells(130, todays_column) = Get_Query_Result("SELECT AVG(Average_initiaL_E_RAB_setup_duration_in_a_cell) Average_initiaL_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end eRAB KPIs****

        '****Radio Network Retainability***
        'PS Drop Call Rate (PDP Busy Hour))
        'xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT AVG(PS_Drop_Call_Rate) PS_Drop_Call_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' Of cells with PS Drop Call Rate <=1
        'xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'Number of E-RAB Drops
        'xlSht.Cells(134, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Drops) Number_of_E_RAB_Drops FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'E-RAB Drop Rate ()
        'xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT AVG(E_RAB_Drop_Rate) E_RAB_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Service Drop Rate (All)
        'xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT AVG(Service_Drop_Rate_All) Service_Drop_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'CStr(Call Successfully Terminated Ratio)
        'xlSht.Cells(137, todays_column) = "NA"
        'xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'CStr(Call Successfully Terminated Ratio)
        'xlSht.Cells(138, todays_column) = "NA"
        'xlSht.Cells(138, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'CStr(Call Successfully Terminated Ratio)
        'xlSht.Cells(139, todays_column) = "NA"
        'xlSht.Cells(139, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end Radio Network Retainability***

        '*****Radio Network Mobility****
        'PS handover success rate (LTE Intra System )
        'xlSht.Cells(141, todays_column) = Get_Query_Result("SELECT AVG(PS_handover_success_rate_LTE_Intra_System) PS_handover_success_rate_LTE_Intra_System FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Intra Frequency Handover Success Rate
        'xlSht.Cells(142, todays_column) = Get_Query_Result("SELECT AVG(Intra_Frequency_Handover_Success_Rate) Intra_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Inter Frequency Handover Success Rate
        'xlSht.Cells(143, todays_column) = Get_Query_Result("SELECT AVG(Inter_Frequency_Handover_Success_Rate) Inter_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'PS Inter System Handover Success Rate ( LTE- 2G/3G And 2G/3G - LTE)  
        'xlSht.Cells(144, todays_column) = Get_Query_Result("SELECT AVG(PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE) PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' of cells with PS Inter System Handover Success Rate( LTE - 3G, LTE-2G, LTE - WIFI, LTE-CDMA) >=96
        'xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'Inter RAT Handover Success Rate (LTE-UTRAN)
        'xlSht.Cells(146, todays_column) = Get_Query_Result("SELECT AVG(Inter_RAT_HOSR_LTE_UTRAN) Inter_RAT_HOSR_LTE_UTRAN FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'CSFB Preparation Success Rate 
        'xlSht.Cells(147, todays_column) = Get_Query_Result("SELECT AVG(CSFB_Preparation_Success_Rate) CSFB_Preparation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'IRAT PS Redirection Preparation success rate(L2W)[]
        'xlSht.Cells(148, todays_column) = Get_Query_Result("SELECT AVG(IRAT_PS_Redirection_Preparation_SR_L2W) IRAT_PS_Redirection_Preparation_SR_L2W FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Average handover duration from E-UTRAN to WCDMA network
        'xlSht.Cells(149, todays_column) = Get_Query_Result("SELECT AVG(AvG_HO_duration_from_E_UTRAN_to_WCDMA) AvG_HO_duration_from_E_UTRAN_to_WCDMA FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Handover Procedure Time
        'xlSht.Cells(150, todays_column) = "NA"
        'xlSht.Cells(150, todays_column) = Get_Query_Result("SELECT AVG(Handover_Procedure_Time) Handover_Procedure_Time FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '*****end Radio Network Mobility****

        '***Quality/ Service Intergrity****
        'PS BLER
        'xlSht.Cells(152, todays_column) = Get_Query_Result("SELECT AVG(PS_BLER) PS_BLER FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'E-UTRAN RLC PDU Re-transmission Ratio Downlink
        'xlSht.Cells(153, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RLC_PDU_Re_trans_Ratio_DL) E_UTRAN_RLC_PDU_Re_trans_Ratio_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'E-UTRAN Average CQI
        'xlSht.Cells(154, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_Average_CQI1) E_UTRAN_Average_CQI1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'DL Packet Loss Rate (PDPC)
        'xlSht.Cells(155, todays_column) = Get_Query_Result("SELECT AVG(DL_Packet_Loss_Rate_PDPC) DL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'UL Packet Loss Rate (PDPC)
        'xlSht.Cells(156, todays_column) = Get_Query_Result("SELECT AVG(UL_Packet_Loss_Rate_PDPC) UL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' of cells with Average PS DL Throughput  >=20 Mbps And >=Y Mbps at Cell Edge (Cell Data Busy Hour)
        'xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Average_DL_PDCP_Throughput>=20 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_DL_PDCP_Throughput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'Total Downlink Traffic Volume
        'xlSht.Cells(158, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total Uplink Traffic Volume
        'xlSht.Cells(159, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Cell Average DL PDCP Throughput
        'xlSht.Cells(160, todays_column) = Get_Query_Result("SELECT AVG(Average_DL_PDCP_Throughput) Average_DL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Cell Average UL PDCP Throughput
        'xlSht.Cells(161, todays_column) = Get_Query_Result("SELECT AVG(Average_UL_PDCP_Throughput) Average_UL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        ' Cells with Cell Avg Throughput < 4 Mbps
        'xlSht.Cells(162, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Cell_Avg_Thput>=4 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Cell_Avg_Thput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' )T ;").ToString
        'User Downlink Average Throughput
        'xlSht.Cells(163, todays_column) = Get_Query_Result("SELECT AVG(User_Downlink_Average_Throughput) User_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'User Uplink Average Throughput
        'xlSht.Cells(164, todays_column) = Get_Query_Result("SELECT AVG(User_Uplink_Average_Throughput) User_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Service Downlink Average Throughput
        'xlSht.Cells(165, todays_column) = Get_Query_Result("SELECT AVG(Service_Downlink_Average_Throughput) Service_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Service Uplink Average Throughput
        'xlSht.Cells(166, todays_column) = Get_Query_Result("SELECT AVG(Service_Uplink_Average_Throughput) Service_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Cell Max Throughput (Downlink)
        'xlSht.Cells(167, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_DL) Cell_Max_Throughput_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Cell Max Throughput (Uplink)
        'xlSht.Cells(168, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_UL) Cell_Max_Throughput_UL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '***end Quality/ Service Intergrity****

        '*****Down time****
        'No.of Locked Sites
        'xlSht.Cells(171, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Lock';").ToString
        'No.of Locked Cells
        'xlSht.Cells(172, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [SITE_STATUS] = 'Lock';").ToString
        'Total Cell Outage (Minutes)
        'xlSht.Cells(173, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'  ;").ToString
        'Planned Cell Outage (Minutes)
        'xlSht.Cells(174, todays_column) = 0
        'Unplanned Cell Outage (Minutes)
        'xlSht.Cells(175, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'  ;").ToString
        'Total Cell Available Time (Minutes)
        'xlSht.Cells(176, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_4g_reports].[dbo].[SiteDB_4G]  where   SITE_STATUS ='Active'  and Site_Preference = 'Gold' ").ToString
        '*****end Down time****

        '****Transport Network*****
        'Average forward packet loss rate on the IP PM
        'xlSht.Cells(178, todays_column) = Get_Query_Result("select (case when sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Average_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'; ").ToString
        'Peak forward packet loss rate on the IP PM
        'xlSht.Cells(179, todays_column) = Get_Query_Result("select (case when sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Peak_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'; ").ToString
        'Average RTT on the IP PM
        'xlSht.Cells(180, todays_column) = Get_Query_Result("SELECT AVG(Average_RTT_on_the_IP_PM) Average_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Maximum RTT on the IP PM
        'xlSht.Cells(181, todays_column) = Get_Query_Result("SELECT MAX(Maximum_RTT_on_the_IP_PM) Maximum_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end Transport Network*****

        '****Others*****
        'CSFB attempts towards 2G/3G
        'xlSht.Cells(183, todays_column) = Get_Query_Result("SELECT SUM(CSFB_attempts_towards_2G_3G) CSFB_attempts_towards_2G_3G FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'CSFB Call attempts 
        'xlSht.Cells(184, todays_column) = Get_Query_Result("SELECT SUM(CSFB_Call_attempts) CSFB_Call_attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'CSFB success rate 
        'xlSht.Cells(185, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'; ").ToString
        'CSFB success rate 
        'xlSht.Cells(186, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'; ").ToString
        'Paging for CSFB 
        'xlSht.Cells(187, todays_column) = "NA"
        'xlSht.Cells(187, todays_column) = Get_Query_Result("SELECT SUM(Paging_for_CSFB) Paging_for_CSFB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'S1 Setup Success Rate ()
        'xlSht.Cells(188, todays_column) = "NA"
        'xlSht.Cells(188, todays_column) = Get_Query_Result("SELECT AVG(S1_Setup_Success_Rate) S1_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Number S1 Setup Failure
        'xlSht.Cells(189, todays_column) = "NA"
        'xlSht.Cells(189, todays_column) = Get_Query_Result("SELECT COUNT(Number_S1_Setup_Failure) Number_S1_Setup_Failure FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total Number of Bearers(Dedicated)
        'xlSht.Cells(190, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total Number of Bearers(Dedicated)
        'xlSht.Cells(191, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Total Number of Bearers(Default)
        'xlSht.Cells(192, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Default) Total_Number_of_Bearers_Default FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Inter MME Handover Success Rate
        'xlSht.Cells(193, todays_column) = Get_Query_Result("select (case when sum(Inter_MME_Handover_Success_Rate_DENOM)>0 then 100*sum(Inter_MME_Handover_Success_Rate_NUM)/sum(Inter_MME_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'; ").ToString
        'S1  Handover Success Rate
        'xlSht.Cells(194, todays_column) = Get_Query_Result("select (case when sum(S1_Handover_Success_Rate_DENOM)>0 then 100*sum(S1_Handover_Success_Rate_NUM)/sum(S1_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'; ").ToString
        'X2 Handover Success Rate
        'xlSht.Cells(195, todays_column) = Get_Query_Result("select (case when sum(X2_Handover_Success_Rate_DENOM)>0 then 100*sum(X2_Handover_Success_Rate_NUM)/sum(X2_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold'; ").ToString
        '(SGs) Failure Ratio
        'xlSht.Cells(196, todays_column) = "NA"
        'xlSht.Cells(196, todays_column) = Get_Query_Result("SELECT AVG(SGs_Failure_Ratio) SGs_Failure_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Default Bearer Activation Success Rate
        'xlSht.Cells(197, todays_column) = "NA"
        'xlSht.Cells(197, todays_column) = Get_Query_Result("SELECT AVG(Default_Bearer_Activation_Success_Rate) Default_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Dedicated Bearer Activation Success Rate
        'xlSht.Cells(198, todays_column) = "NA"
        'xlSht.Cells(198, todays_column) = Get_Query_Result("SELECT AVG(Dedicated_Bearer_Activation_Success_Rate) Dedicated_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'S1 mode intra-MME Handover success rate
        'xlSht.Cells(199, todays_column) = "NA"
        'xlSht.Cells(199, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_intra_MME_Handover_success_rate) S1_mode_intra_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'S1 mode inter-MME Handover success rate
        'xlSht.Cells(200, todays_column) = "NA"
        'xlSht.Cells(200, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_inter_MME_Handover_success_rate) S1_mode_inter_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Security mode command success rate
        'xlSht.Cells(201, todays_column) = "NA"
        'xlSht.Cells(201, todays_column) = Get_Query_Result("SELECT AVG(security_mode_command_success_rate) security_mode_command_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        'Authentication Success Rate
        'xlSht.Cells(202, todays_column) = "NA"
        ' xlSht.Cells(202, todays_column) = Get_Query_Result("SELECT AVG(Authentication_Success_Rate) Authentication_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Gold';").ToString
        '****end Others*****



        '------SILVER=------------------------------
        '' '' ''----------------------------------
        '' '' '' xlSht.Unprotect(Password:=cpass)
        'Sheet No.4
        'xlSht = xlTmp.Sheets("Total Capacity")
        'xlSht = xlTmp.Sheets("3G KPI")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("Gold")
        'xlSht = xlTmp.Sheets("SLV")
        'xlSht = xlTmp.Sheets("PnG")

        ' '' ''xlSht.Unprotect(Password:=cpass)
        'Both cells for date and day printing
        'date row
        'xlSht.Cells(1, todays_column) = mapa_cutt_date
        'day row
        ' xlSht.Cells(5, todays_column) = mapa_day

        'Total HSS capacity (K)
        'xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT (KPI_Value/1000)  FROM mapa_3g_reports.dbo.Static_Input where parameter='Total HLR capacity (K)';").ToString
        'xlSht.Cells(3, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total HSS capacity (K)';").ToString
        'No of SGWs
        'xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of SGWs';").ToString
        'No of PGWs
        'xlSht.Cells(5, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PGWs';").ToString
        'No of MMEs
        'xlSht.Cells(6, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of MMEs';").ToString
        'No of PCRFs
        'xlSht.Cells(7, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of PCRFs';").ToString
        'Total EPC Capacity (BHCA)
        'xlSht.Cells(8, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total EPC Capacity (BHCA)';").ToString

        'Total eNode B Sites (Active)
        'xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Active'    AND Site_Preference = 'Silver' ;").ToString
        'Total eNode B Sites (Under Optimization)
        'Dim siteCount As Integer
        'Dim siteCount2 As Integer
        'siteCount = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G;").ToString
        'siteCount2 = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Active' ;").ToString
        'xlSht.Cells(11, todays_column) = siteCount - siteCount2
        'xlSht.Cells(11, todays_column) = 0
        'Macro Sites(Active)
        'xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND [SITE_STATUS] = 'Active'   AND Site_Preference = 'Silver' ;").ToString
        'Micro Sites(Active)
        'xlSht.Cells(13, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Silver' ;").ToString
        'IBS Sites(Active)
        'xlSht.Cells(14, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Silver' ;").ToString
        'Total eNode B Cells 
        'xlSht.Cells(15, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G   WHERE [SITE_STATUS] = 'Active'  and  Site_Preference = 'Silver' ;").ToString
        'Macro Cells
        'xlSht.Cells(16, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [Macro_IBS] = 'Macro' AND [SITE_STATUS] = 'Active'   and  Site_Preference = 'Silver' ;").ToString
        'Micro Cells
        'xlSht.Cells(17, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'Micro' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Silver' ;").ToString
        'IBS Cells
        'xlSht.Cells(18, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = 'ibs' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Silver' ;").ToString
        '4T4R Cells
        'xlSht.Cells(19, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '4T4R' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Silver' ;").ToString
        '2T2R Cells
        'xlSht.Cells(20, todays_column) = Get_Query_Result("SELECT COUNT(distinct Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [Macro_IBS] = '2T2R' AND [SITE_STATUS] = 'Active'  and  Site_Preference = 'Silver' ;").ToString
        '****end vstatic****


        '****HSS Sub****
        'Total HSS Subs (2G+3G+LTE)
        'xlSht.Cells(22, todays_column) = Get_Query_Result("  select sum([Total_HLR]) from [mapa_3g_reports].[dbo].[Core_HLR_NSUB1]").ToString
        'HSS Subs(with LTE Profile)
        'Attached Subs
        'xlSht.Cells(24, todays_column) = Get_Query_Result("select sum(Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Detached Subs
        'xlSht.Cells(25, todays_column) = Get_Query_Result("select sum(Total_VLR-Total_VLR_Attached) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Registered LTE Subs
        'Unregistered LTE Subs
        'In Roamers
        'xlSht.Cells(28, todays_column) = Get_Query_Result("select sum(Total_InRoamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        'Out Roamers
        'xlSht.Cells(29, todays_column) = Get_Query_Result("select sum(Total_outroamers) from [mapa_3g_reports].[dbo].[combined_core_NBH]").ToString
        '****endn HSS Sub****

        '***Radio Traffic(MB)*******
        'Total NBH Traffic (NBH)
        'xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total BBH Traffic (BBH)
        'xlSht.Cells(33, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total 24 HrsTraffic (24 Hrs)
        'xlSht.Cells(34, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '***end Radio Traffic(MB)***

        '****Data Volume - MB*****
        'Data Volume(DL) - Total_(BBH)
        'xlSht.Cells(36, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 1_(BBH)
        'xlSht.Cells(37, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_1/1024) Data_Volume_DL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 2_(BBH)
        'xlSht.Cells(38, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_2/1024) Data_Volume_DL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 3_(BBH)
        'xlSht.Cells(39, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_3/1024) Data_Volume_DL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 4_(BBH)
        'xlSht.Cells(40, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_4/1024) Data_Volume_DL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 5_(BBH)
        'xlSht.Cells(41, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_5/1024) Data_Volume_DL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 6_(BBH)
        'xlSht.Cells(42, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_6/1024) Data_Volume_DL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 7_(BBH)
        'xlSht.Cells(43, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_7/1024) Data_Volume_DL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 8_(BBH)
        'xlSht.Cells(44, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_8/1024) Data_Volume_DL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(DL) - QCI = 9_(BBH)
        'xlSht.Cells(45, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_QCI_9/1024) Data_Volume_DL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - Total_(BBH)
        'xlSht.Cells(46, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 1_(BBH)
        'xlSht.Cells(47, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_1/1024) Data_Volume_UL_QCI_1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 2_(BBH)
        'xlSht.Cells(48, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_2/1024) Data_Volume_UL_QCI_2 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 3_(BBH)
        'xlSht.Cells(49, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_3/1024) Data_Volume_UL_QCI_3 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 4_(BBH)
        'xlSht.Cells(50, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_4/1024) Data_Volume_UL_QCI_4 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 5_(BBH)
        'xlSht.Cells(51, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_5/1024) Data_Volume_UL_QCI_5 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 6_(BBH)
        'xlSht.Cells(52, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_6/1024) Data_Volume_UL_QCI_6 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 7_(BBH)
        'xlSht.Cells(53, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_7/1024) Data_Volume_UL_QCI_7 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 8_(BBH)
        'xlSht.Cells(54, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_8/1024) Data_Volume_UL_QCI_8 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Data Volume(UL) - QCI = 9_(BBH)
        'xlSht.Cells(55, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_QCI_9/1024) Data_Volume_UL_QCI_9 FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average User Number (***)
        'xlSht.Cells(56, todays_column) = Get_Query_Result("SELECT AVG(Average_User_Number) Average_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Maximum User Number  (***)
        'xlSht.Cells(57, todays_column) = Get_Query_Result("SELECT MAX(Maximum_User_Number) Maximum_User_Number FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average Number of downlink cell edge users (CEUs) in a cell  (***)
        'xlSht.Cells(58, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_dl_cell_edge_users_CEUs) Avg_nbr_dl_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average Number of uplink cell edge users (CEUs) in a cell  (***)
        'xlSht.Cells(59, todays_column) = Get_Query_Result("SELECT AVG(Avg_nbr_ul_cell_edge_users_CEUs) Avg_nbr_ul_cell_edge_users_CEUs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end Data Volume - MB*****

        '****Contactual KPI for Payment Signoff****
        'Total BBH Traffic (BBH)
        'xlSht.Cells(61, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_gb/1024) Total_Traffic_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'MPS(Mbps Per site)(BBH) (***)
        'xlSht.Cells(62, todays_column) = Get_Query_Result("SELECT SUM(XXXX) XXXXX FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end Contactual KPI for Payment Signoff****

        '****RB & Utilzation*** (BBH) excep CE Ultilization
        'Average Number of used UL PRBs
        'xlSht.Cells(64, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_UL_PRBs) Average_number_of_used_UL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average Number of used DL PRBs
        'xlSht.Cells(65, todays_column) = Get_Query_Result("SELECT AVG(Average_number_of_used_DL_PRBs) Average_number_of_used_DL_PRBs FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' PDSCH   Utilization >90
        'xlSht.Cells(66, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PDSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PDSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        ' PUSCH   Utilization >90
        'xlSht.Cells(67, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PUSCH_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PUSCH_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        ' of cells with RB utilization  >90
        'xlSht.Cells(68, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_RB_utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_RB_utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'CCE Utilization
        'xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT AVG(CCE_Utilization) CCE_Utilization FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' of  Node-B with Average used UL PRBs [0,40]
        'xlSht.Cells(70, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>=0 and Node_B_with_Avg_used_UL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T;").ToString
        ' of  Node-B with Average used UL PRBs (40,70]
        'xlSht.Cells(71, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>40 and Node_B_with_Avg_used_UL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T;").ToString
        ' of  Node-B with Average used UL PRBs (70,100]
        'xlSht.Cells(72, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_UL_PRBs>70 and Node_B_with_Avg_used_UL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_UL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T;").ToString
        ' of  Node-B with Average used DL PRBs [0,40]
        'xlSht.Cells(73, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>=0 and Node_B_with_Avg_used_DL_PRBs<=40) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T;").ToString
        ' of  Node-B with Average used DL PRBs (40,70]
        'xlSht.Cells(74, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>40 and Node_B_with_Avg_used_DL_PRBs<=70) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T;").ToString
        ' of  Node-B with Average used DL PRBs (70,100]\
        'xlSht.Cells(75, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN (Node_B_with_Avg_used_DL_PRBs>70 and Node_B_with_Avg_used_DL_PRBs<=100) THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Node_B_with_Avg_used_DL_PRBs,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T;").ToString
        '****end RB & Utilzation***

        '***eNode B***
        ' of eNode B's with Processor Load >70 (BBH of respective eNode B)
        'xlSht.Cells(77, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN eNodeB_Processor_Load>90 THEN 1 ELSE 0 END) as float)/(COUNT(site_name)) FROM (SELECT eNodeB_Processor_Load,site_name  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'xlSht.Cells(77, todays_column) = "NA"
        '***end eNode B***

        '***CPU*** (NBH)
        'Peak Processor Load -MME
        'xlSht.Cells(79, todays_column) = "NA"
        'Peak Processor Load -SGW
        'xlSht.Cells(80, todays_column) = "NA"
        'Peak Processor Load -PGW
        'xlSht.Cells(81, todays_column) = "NA"
        'Peak Processor Load -HSS
        'xlSht.Cells(82, todays_column) = "NA"
        '***end CPU***

        '*****Interface*****
        ' of S1-UP links Utilization>90
        'xlSht.Cells(84, todays_column) = "NA"
        'xlSht.Cells(84, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_UP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_UP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        ' of S1-CP links Utilization>90
        'xlSht.Cells(85, todays_column) = "NA"
        'xlSht.Cells(85, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN S1_CP_links_Utilization>90 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT S1_CP_links_Utilization,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        '*****end Interface*****

        '***Radio Traffic(GB)****
        'Total NBH Traffic_DL (NBH)
        'xlSht.Cells(87, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total NBH Traffic_UL (NBH)
        'xlSht.Cells(88, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total BBH Traffic_DL (BBH)
        'xlSht.Cells(89, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total BBH Traffic_UL (BBH)
        'xlSht.Cells(90, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total 24 Hrs Traffic_DL (24Hrs)
        'xlSht.Cells(91, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb/1024) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total 24 Hrs Traffic_UL (24Hrs)
        'xlSht.Cells(92, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb/1024) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '***end Radio Traffic(GB)****

        '****Network Availability****
        'Network Availability Total
        'xlSht.Cells(94, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Network Availability Total (NBH hrs)
        'xlSht.Cells(95, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Network Availability Total (7am to 11pm)  
        'xlSht.Cells(96, todays_column) = Get_Query_Result("SELECT AVG(Network_Availability_Total) Network_Availability_Total FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and right(period_start_time,2)>=07   and Site_Preference = 'Silver';").ToString
        'xlSht.Cells(32, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString
        'Core Service Availability
        'xlSht.Cells(97, todays_column) = Get_Query_Result("SELECT avg(Core_Service_Availability) Core_Service_Availability FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' of E UTRAN cells having Radio Network Availability >=99.7
        'xlSht.Cells(98, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Network_Availability_Total>99.7 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Network_Availability_Total,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_NBH_KPIs_with_classification  where   SITE_STATUS ='Active'    and Site_Preference = 'Silver' )T ;").ToString
        '***end *Network Availability****

        '***EPC KPI****
        'Attach Success rate excluding Unregistered subs (24hrs)
        'xlSht.Cells(100, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Attach_Success_rate_excluding_Unregistered_subs_DENOM = 0 then 100 else Attach_Success_rate_excluding_Unregistered_subs_NUM/Attach_Success_rate_excluding_Unregistered_subs_DENOM) Attach_Success_rate_excluding_Unregistered_subs FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Tracking  Area update completion Rate
        'xlSht.Cells(101, todays_column) = "NA"
        'xlSht.Cells(100, todays_column) = Get_Query_Result("SELECT AVG(case when Tracking_Area_update_completion_Rate_DENOM = 0 then 100 else Tracking_Area_update_completion_Rate_NUM/Tracking_Area_update_completion_Rate_DENOM) Tracking_Area_update_completion_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'S1 mode intra-MME TAU success rate
        'xlSht.Cells(102, todays_column) = "NA"
        'S1 mode inter-MME TAU success rate
        'xlSht.Cells(103, todays_column) = "NA"
        'Paging Success Rate for LTE Calls
        'xlSht.Cells(104, todays_column) = "NA"
        'Operator wise LTE LU success rate for International InRoamers And OutRoamers
        'xlSht.Cells(105, todays_column) = "NA"
        '***End PC KPI****

        '****RRC Setup Index*****
        'RRC setup Success  ratio () (24Hrs)
        'xlSht.Cells(108, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total RRC Attempt (NBH)  (***)    NBH(19:00 to 20:00 Hrs)
        'xlSht.Cells(109, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'RRC setup Success  ratio () (24Hrs)
        'xlSht.Cells(110, todays_column) = Get_Query_Result("SELECT AVG(RRC_setup_Success_ratio) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Number of RRC Attempts (NBH)
        'xlSht.Cells(111, todays_column) = Get_Query_Result("SELECT SUM(Number_of_RRC_Setup_Attempts) RRC_setup_Success_ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'RRC Drop Rate ()
        'xlSht.Cells(112, todays_column) = Get_Query_Result("SELECT AVG(RRC_Drop_Rate) RRC_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'E-UTRAN RRC Paging Discard Ratio
        'xlSht.Cells(113, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Paging_Discard_Ratio) E_UTRAN_RRC_Paging_Discard_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'E UTRAN RRC Setup And Access Completion Ratio (NBH)
        'xlSht.Cells(114, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RRC_Setup_and_Access_Completion_Ratio) E_UTRAN_RRC_Setup_and_Access_Completion_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'E-RAB success rate
        'xlSht.Cells(115, todays_column) = Get_Query_Result("SELECT AVG(RRC_Registration_success_rate_ERAB) RRC_Registration_success_rate_ERAB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' of cells with PS E UTRAN RRC Setup And Access Completion Ratio >=98
        'xlSht.Cells(116, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cells_with_PS_E_UTRAN_RRC_Setup_and_Access_Completion_Ratio,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'RRC Setup Success Rate (Service)
        'xlSht.Cells(117, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_Service) RRC_Setup_Success_Rate_Service FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'RRC Setup Success Rate (signaling)
        'xlSht.Cells(118, todays_column) = Get_Query_Result("SELECT AVG(RRC_Setup_Success_Rate_signaling) RRC_Setup_Success_Rate_signaling FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average RRC connection setup duration
        'xlSht.Cells(119, todays_column) = Get_Query_Result("SELECT AVG(Average_RRC_connection_setup_duration) Average_RRC_connection_setup_duration FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end RRC Setup Index*****

        '****Congestion****
        'RRC Blocking Rate
        'xlSht.Cells(121, todays_column) = Get_Query_Result("select (case when sum(RRC_Drop_Rate_Denom)>0 then 100*sum(RRC_Drop_Rate_Nom)/sum(RRC_Drop_Rate_Denom) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'E-RAB Blocking Rate
        'xlSht.Cells(122, todays_column) = Get_Query_Result("select (case when sum(E_RAB_Blocking_Rate_DENOM)>0 then 100*sum(E_RAB_Blocking_Rate_NUM)/sum(E_RAB_Blocking_Rate_DENOM) else 0 end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_BBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end Congestion**

        '****eRAB KPIs****
        'Number of E-RAB Setup Attempts
        'xlSht.Cells(124, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Setup_Attempts) Number_of_E_RAB_Setup_Attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' of cells with PS E UTRAN RAB Setup Success Rate >=98
        'xlSht.Cells(125, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate>98 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT cellsgre98PS_E_UTRAN_RAB_Setup_Succ_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_24hrs_houly_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'E-RAB Setup Success Rate (All)
        'xlSht.Cells(126, todays_column) = Get_Query_Result("SELECT 100*(case when sum(E_RAB_Setup_Success_Rate_All_Denom)>0 then sum(E_RAB_Setup_Success_Rate_All_Nom)/sum(E_RAB_Setup_Success_Rate_All_Denom) else 1 end) E_RAB_Setup_Success_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Number of Initial E-RAB Setup Success
        'xlSht.Cells(127, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_InitiaL_E_RAB_Setup_Success) Number_of_InitiaL_E_RAB_Setup_Success FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Initial E - RAB Setup Success Rate ()
        'xlSht.Cells(128, todays_column) = Get_Query_Result("SELECT AVG(InitiaL_E_RAB_Setup_Success_Rate) InitiaL_E_RAB_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average E - RAB setup duration in a cell
        'xlSht.Cells(129, todays_column) = Get_Query_Result("SELECT AVG(Average_E_RAB_setup_duration_in_a_cell) Average_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average initial E-RAB setup duration in a cell
        'xlSht.Cells(130, todays_column) = Get_Query_Result("SELECT AVG(Average_initiaL_E_RAB_setup_duration_in_a_cell) Average_initiaL_E_RAB_setup_duration_in_a_cell FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end eRAB KPIs****

        '****Radio Network Retainability***
        'PS Drop Call Rate (PDP Busy Hour))
        'xlSht.Cells(132, todays_column) = Get_Query_Result("SELECT AVG(PS_Drop_Call_Rate) PS_Drop_Call_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' Of cells with PS Drop Call Rate <=1
        'xlSht.Cells(133, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Drop_Call_Rate<=1 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Drop_Call_Rate,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'Number of E-RAB Drops
        'xlSht.Cells(134, todays_column) = Get_Query_Result("SELECT COUNT(Number_of_E_RAB_Drops) Number_of_E_RAB_Drops FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'E-RAB Drop Rate ()
        'xlSht.Cells(135, todays_column) = Get_Query_Result("SELECT AVG(E_RAB_Drop_Rate) E_RAB_Drop_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Service Drop Rate (All)
        'xlSht.Cells(136, todays_column) = Get_Query_Result("SELECT AVG(Service_Drop_Rate_All) Service_Drop_Rate_All FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'CStr(Call Successfully Terminated Ratio)
        'xlSht.Cells(137, todays_column) = "NA"
        'xlSht.Cells(137, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'CStr(Call Successfully Terminated Ratio)
        'xlSht.Cells(138, todays_column) = "NA"
        'xlSht.Cells(138, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'CStr(Call Successfully Terminated Ratio)
        'xlSht.Cells(139, todays_column) = "NA"
        'xlSht.Cells(139, todays_column) = Get_Query_Result("SELECT AVG(CSTR_Call_Successfully_Terminated_Ratio) CSTR_Call_Successfully_Terminated_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end Radio Network Retainability***

        '*****Radio Network Mobility****
        'PS handover success rate (LTE Intra System )
        'xlSht.Cells(141, todays_column) = Get_Query_Result("SELECT AVG(PS_handover_success_rate_LTE_Intra_System) PS_handover_success_rate_LTE_Intra_System FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Intra Frequency Handover Success Rate
        'xlSht.Cells(142, todays_column) = Get_Query_Result("SELECT AVG(Intra_Frequency_Handover_Success_Rate) Intra_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Inter Frequency Handover Success Rate
        'xlSht.Cells(143, todays_column) = Get_Query_Result("SELECT AVG(Inter_Frequency_Handover_Success_Rate) Inter_Frequency_Handover_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'PS Inter System Handover Success Rate ( LTE- 2G/3G And 2G/3G - LTE)  
        'xlSht.Cells(144, todays_column) = Get_Query_Result("SELECT AVG(PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE) PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' of cells with PS Inter System Handover Success Rate( LTE - 3G, LTE-2G, LTE - WIFI, LTE-CDMA) >=96
        'xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE>=95 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT PS_Inter_System_HOSR_LTE_2G_3G_2G_3G__LTE,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'Inter RAT Handover Success Rate (LTE-UTRAN)
        'xlSht.Cells(146, todays_column) = Get_Query_Result("SELECT AVG(Inter_RAT_HOSR_LTE_UTRAN) Inter_RAT_HOSR_LTE_UTRAN FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'CSFB Preparation Success Rate 
        'xlSht.Cells(147, todays_column) = Get_Query_Result("SELECT AVG(CSFB_Preparation_Success_Rate) CSFB_Preparation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'IRAT PS Redirection Preparation success rate(L2W)[]
        'xlSht.Cells(148, todays_column) = Get_Query_Result("SELECT AVG(IRAT_PS_Redirection_Preparation_SR_L2W) IRAT_PS_Redirection_Preparation_SR_L2W FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Average handover duration from E-UTRAN to WCDMA network
        'xlSht.Cells(149, todays_column) = Get_Query_Result("SELECT AVG(AvG_HO_duration_from_E_UTRAN_to_WCDMA) AvG_HO_duration_from_E_UTRAN_to_WCDMA FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Handover Procedure Time
        'xlSht.Cells(150, todays_column) = "NA"
        'xlSht.Cells(150, todays_column) = Get_Query_Result("SELECT AVG(Handover_Procedure_Time) Handover_Procedure_Time FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '*****end Radio Network Mobility****

        '***Quality/ Service Intergrity****
        'PS BLER
        'xlSht.Cells(152, todays_column) = Get_Query_Result("SELECT AVG(PS_BLER) PS_BLER FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'E-UTRAN RLC PDU Re-transmission Ratio Downlink
        'xlSht.Cells(153, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_RLC_PDU_Re_trans_Ratio_DL) E_UTRAN_RLC_PDU_Re_trans_Ratio_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'E-UTRAN Average CQI
        'xlSht.Cells(154, todays_column) = Get_Query_Result("SELECT AVG(E_UTRAN_Average_CQI1) E_UTRAN_Average_CQI1 FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'DL Packet Loss Rate (PDPC)
        'xlSht.Cells(155, todays_column) = Get_Query_Result("SELECT AVG(DL_Packet_Loss_Rate_PDPC) DL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'UL Packet Loss Rate (PDPC)
        'xlSht.Cells(156, todays_column) = Get_Query_Result("SELECT AVG(UL_Packet_Loss_Rate_PDPC) UL_Packet_Loss_Rate_PDPC FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' of cells with Average PS DL Throughput  >=20 Mbps And >=Y Mbps at Cell Edge (Cell Data Busy Hour)
        'xlSht.Cells(145, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Average_DL_PDCP_Throughput>=20 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Average_DL_PDCP_Throughput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'Total Downlink Traffic Volume
        'xlSht.Cells(158, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_DL_Total_gb) Data_Volume_DL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total Uplink Traffic Volume
        'xlSht.Cells(159, todays_column) = Get_Query_Result("SELECT SUM(Data_Volume_UL_Total_gb) Data_Volume_UL_Total_gb FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Cell Average DL PDCP Throughput
        'xlSht.Cells(160, todays_column) = Get_Query_Result("SELECT AVG(Average_DL_PDCP_Throughput) Average_DL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Cell Average UL PDCP Throughput
        'xlSht.Cells(161, todays_column) = Get_Query_Result("SELECT AVG(Average_UL_PDCP_Throughput) Average_UL_PDCP_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        ' Cells with Cell Avg Throughput < 4 Mbps
        'xlSht.Cells(162, todays_column) = Get_Query_Result("SELECT 100* cast(sum(CASE WHEN Cell_Avg_Thput>=4 THEN 1 ELSE 0 END) as float)/(COUNT(CELL_NAME)) FROM (SELECT Cell_Avg_Thput,CELL_NAME  FROM [mapa_4g_reports].[dbo].Network_4G_all_BBH_KPIs_with_classification  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' )T ;").ToString
        'User Downlink Average Throughput
        'xlSht.Cells(163, todays_column) = Get_Query_Result("SELECT AVG(User_Downlink_Average_Throughput) User_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'User Uplink Average Throughput
        'xlSht.Cells(164, todays_column) = Get_Query_Result("SELECT AVG(User_Uplink_Average_Throughput) User_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Service Downlink Average Throughput
        'xlSht.Cells(165, todays_column) = Get_Query_Result("SELECT AVG(Service_Downlink_Average_Throughput) Service_Downlink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Service Uplink Average Throughput
        'xlSht.Cells(166, todays_column) = Get_Query_Result("SELECT AVG(Service_Uplink_Average_Throughput) Service_Uplink_Average_Throughput FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Cell Max Throughput (Downlink)
        'xlSht.Cells(167, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_DL) Cell_Max_Throughput_DL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Cell Max Throughput (Uplink)
        'xlSht.Cells(168, todays_column) = Get_Query_Result("SELECT MAX(Cell_Max_Throughput_UL) Cell_Max_Throughput_UL FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '***end Quality/ Service Intergrity****

        '*****Down time****
        'No.of Locked Sites
        'xlSht.Cells(171, todays_column) = Get_Query_Result("SELECT COUNT(distinct SITE_NAME) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE [SITE_STATUS] = 'Lock';").ToString
        'No.of Locked Cells
        'xlSht.Cells(172, todays_column) = Get_Query_Result("SELECT COUNT(Cell_name) FROM [mapa_4g_reports].[dbo].SiteDB_4G  WHERE  [SITE_STATUS] = 'Lock';").ToString
        'Total Cell Outage (Minutes)
        'xlSht.Cells(173, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'  ;").ToString
        'Planned Cell Outage (Minutes)
        'xlSht.Cells(174, todays_column) = 0
        'Unplanned Cell Outage (Minutes)
        'xlSht.Cells(175, todays_column) = Get_Query_Result("SELECT SUM(Total_Cell_Outage_Minutes) Total_Cell_Outage_Minutes FROM [mapa_4g_reports].[dbo].[Network_4G_all_Daily_KPIs_with_classification]  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'  ;").ToString
        'Total Cell Available Time (Minutes)
        'xlSht.Cells(176, todays_column) = Get_Query_Result("SELECT (COUNT(*)*(24*60))  FROM [mapa_4g_reports].[dbo].[SiteDB_4G]  where   SITE_STATUS ='Active'  and Site_Preference = 'Silver' ").ToString
        '*****end Down time****

        '****Transport Network*****
        'Average forward packet loss rate on the IP PM
        'xlSht.Cells(178, todays_column) = Get_Query_Result("select (case when sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Average_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Average_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'; ").ToString
        'Peak forward packet loss rate on the IP PM
        'xlSht.Cells(179, todays_column) = Get_Query_Result("select (case when sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM)>0 then 100*sum(Peak_forward_packet_loss_rate_on_the_IP_PM_NUM)/sum(Peak_forward_packet_loss_rate_on_the_IP_PM_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'; ").ToString
        'Average RTT on the IP PM
        'xlSht.Cells(180, todays_column) = Get_Query_Result("SELECT AVG(Average_RTT_on_the_IP_PM) Average_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Maximum RTT on the IP PM
        'xlSht.Cells(181, todays_column) = Get_Query_Result("SELECT MAX(Maximum_RTT_on_the_IP_PM) Maximum_RTT_on_the_IP_PM FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end Transport Network*****

        '****Others*****
        'CSFB attempts towards 2G/3G
        'xlSht.Cells(183, todays_column) = Get_Query_Result("SELECT SUM(CSFB_attempts_towards_2G_3G) CSFB_attempts_towards_2G_3G FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'CSFB Call attempts 
        'xlSht.Cells(184, todays_column) = Get_Query_Result("SELECT SUM(CSFB_Call_attempts) CSFB_Call_attempts FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'CSFB success rate 
        'xlSht.Cells(185, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'; ").ToString
        'CSFB success rate 
        'xlSht.Cells(186, todays_column) = Get_Query_Result("select (case when sum(CSFB_success_rate_Denum)>0 then 100*sum(CSFB_success_rate_Num)/sum(CSFB_success_rate_Denum) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'; ").ToString
        'Paging for CSFB 
        'xlSht.Cells(187, todays_column) = "NA"
        'xlSht.Cells(187, todays_column) = Get_Query_Result("SELECT SUM(Paging_for_CSFB) Paging_for_CSFB FROM [mapa_4g_reports].[dbo].[Network_4G_all_NBH_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'S1 Setup Success Rate ()
        'xlSht.Cells(188, todays_column) = "NA"
        'xlSht.Cells(188, todays_column) = Get_Query_Result("SELECT AVG(S1_Setup_Success_Rate) S1_Setup_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Number S1 Setup Failure
        'xlSht.Cells(189, todays_column) = "NA"
        'xlSht.Cells(189, todays_column) = Get_Query_Result("SELECT COUNT(Number_S1_Setup_Failure) Number_S1_Setup_Failure FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total Number of Bearers(Dedicated)
        'xlSht.Cells(190, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total Number of Bearers(Dedicated)
        'xlSht.Cells(191, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Dedicated) Total_Number_of_Bearers_Dedicated FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Total Number of Bearers(Default)
        'xlSht.Cells(192, todays_column) = Get_Query_Result("SELECT COUNT(Total_Number_of_Bearers_Default) Total_Number_of_Bearers_Default FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Inter MME Handover Success Rate
        'xlSht.Cells(193, todays_column) = Get_Query_Result("select (case when sum(Inter_MME_Handover_Success_Rate_DENOM)>0 then 100*sum(Inter_MME_Handover_Success_Rate_NUM)/sum(Inter_MME_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'; ").ToString
        'S1  Handover Success Rate
        'xlSht.Cells(194, todays_column) = Get_Query_Result("select (case when sum(S1_Handover_Success_Rate_DENOM)>0 then 100*sum(S1_Handover_Success_Rate_NUM)/sum(S1_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'; ").ToString
        'X2 Handover Success Rate
        'xlSht.Cells(195, todays_column) = Get_Query_Result("select (case when sum(X2_Handover_Success_Rate_DENOM)>0 then 100*sum(X2_Handover_Success_Rate_NUM)/sum(X2_Handover_Success_Rate_DENOM) else null end) FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver'; ").ToString
        '(SGs) Failure Ratio
        'xlSht.Cells(196, todays_column) = "NA"
        'xlSht.Cells(196, todays_column) = Get_Query_Result("SELECT AVG(SGs_Failure_Ratio) SGs_Failure_Ratio FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Default Bearer Activation Success Rate
        'xlSht.Cells(197, todays_column) = "NA"
        'xlSht.Cells(197, todays_column) = Get_Query_Result("SELECT AVG(Default_Bearer_Activation_Success_Rate) Default_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Dedicated Bearer Activation Success Rate
        'xlSht.Cells(198, todays_column) = "NA"
        'xlSht.Cells(198, todays_column) = Get_Query_Result("SELECT AVG(Dedicated_Bearer_Activation_Success_Rate) Dedicated_Bearer_Activation_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'S1 mode intra-MME Handover success rate
        'xlSht.Cells(199, todays_column) = "NA"
        'xlSht.Cells(199, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_intra_MME_Handover_success_rate) S1_mode_intra_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'S1 mode inter-MME Handover success rate
        'xlSht.Cells(200, todays_column) = "NA"
        'xlSht.Cells(200, todays_column) = Get_Query_Result("SELECT AVG(S1_mode_inter_MME_Handover_success_rate) S1_mode_inter_MME_Handover_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Security mode command success rate
        'xlSht.Cells(201, todays_column) = "NA"
        'xlSht.Cells(201, todays_column) = Get_Query_Result("SELECT AVG(security_mode_command_success_rate) security_mode_command_success_rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        'Authentication Success Rate
        'xlSht.Cells(202, todays_column) = "NA"
        ' xlSht.Cells(202, todays_column) = Get_Query_Result("SELECT AVG(Authentication_Success_Rate) Authentication_Success_Rate FROM [mapa_4g_reports].[dbo].[Network_4G_all_24hrs_houly_KPIs_with_classification] where   SITE_STATUS ='Active'  and Site_Preference = 'Silver';").ToString
        '****end Others*****




        '=======END MAPA 4G =========





        ''Total HLR capacity (K)
        'xlSht.Cells(4, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total HLR capacity (K)';").ToString
        ''No of MSC Servers
        'xlSht.Cells(5, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of MSC Servers'").ToString
        ''Total MSC Capacity (BHCA)
        'xlSht.Cells(6, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total MSC Capacity (BHCA)';").ToString
        ''No of MGWs
        'xlSht.Cells(7, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='No of MGWs';").ToString
        ''Total MGW Capacity - (Erls) 
        'xlSht.Cells(8, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total MGW Capacity - (Erls)';").ToString
        ''Total RNC
        'xlSht.Cells(10, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT RNC)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active';").ToString
        ''Total RNC Capacity (Mbps)
        'xlSht.Cells(11, todays_column) = Get_Query_Result("SELECT KPI_Value  FROM mapa_4g_reports.dbo.Static_Input where parameter='Total RNC Capacity (Mbps)';").ToString
        ''Total Node B Sites (Active)
        'xlSht.Cells(12, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active';").ToString
        ''Macro Sites (Active)
        'xlSht.Cells(13, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active' AND Macro_IBS = 'Macro';").ToString
        ''Micro Sites (Active)
        'xlSht.Cells(14, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active' AND Macro_IBS = 'Micro';").ToString
        ''IBS Sites (Active)
        'xlSht.Cells(15, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT SITE_NAME)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active' AND Macro_IBS = 'IBS';").ToString
        ''Total Node B CELLS 
        'xlSht.Cells(16, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT Cell_name)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active';").ToString
        ''Macro Cells
        'xlSht.Cells(17, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT Cell_name)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active' AND Macro_IBS = 'Macro';").ToString
        ''IBS Cells
        'xlSht.Cells(18, todays_column) = Get_Query_Result("SELECT COUNT(DISTINCT Cell_name)  FROM [mapa_4g_reports].[dbo].[SiteDB_3G] WHERE   SITE_STATUS ='Active' AND Macro_IBS = 'IBS';").ToString

        ''Total NBH Traffic (CS)
        'xlSht.Cells(69, todays_column) = Get_Query_Result("SELECT SUM(Total_Traffic_CS) Total_Traffic_CS FROM [mapa_4g_reports].[dbo].[Network_3G_all_NBH_CS_KPIs_with_classification] where   SITE_STATUS ='Active';").ToString


        '' '' ''---------End of Code------------------------------------------------
        Dim path = My.Computer.FileSystem.SpecialDirectories.MyDocuments()
        If System.IO.File.Exists(path + "\RESUME.XLW") = True Then
            My.Computer.FileSystem.DeleteFile(path + "\RESUME.XLW")
        End If
        If System.IO.File.Exists("D:\PM\Validation\AUTOMATED_MAPA_4G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_SAVE_DATE + ".xlsx") = True Then
            My.Computer.FileSystem.DeleteFile("D:\PM\Validation\AUTOMATED_MAPA_4G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_SAVE_DATE + ".xlsx")
        End If
        xlSht.SaveAs("D:\PM\Validation\AUTOMATED_MAPA_4G\Final Mapa Output " + CIRCLE_NAME + "\" + cname + MAPA_SAVE_DATE + ".xlsx")
        'xlTmp.SaveWorkspace()
        xlTmp.Workbooks.Close()
        xlTmp.Quit()
        ' KillExcelProcess()
    End Sub

    Private Sub KillExcelProcess()
        Dim excelProcs() As Process = Process.GetProcessesByName("EXCEL")
        For Each proc As Process In excelProcs
            proc.Kill()
        Next
    End Sub

    Private Sub NotifyIcon1_MouseDoubleClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles NotifyIcon1.MouseDoubleClick
        Me.Show()
    End Sub

    Private Sub BackgroundWorker1_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorker1.DoWork
        ' Call main()
    End Sub

    Private Sub BackgroundWorker1_ProgressChanged(ByVal sender As System.Object, ByVal e As System.ComponentModel.ProgressChangedEventArgs) Handles BackgroundWorker1.ProgressChanged
        Dim status As String
        tsprogress.Value = e.ProgressPercentage
        If Not IsNothing(e.UserState) Then
            status = DirectCast(e.UserState, String)
            txtStatus.Text = txtStatus.Text & status
        End If
    End Sub

    Private Sub txtStatus_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtStatus.TextChanged
    End Sub

    Private Sub NotifyIcon1_MouseClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles NotifyIcon1.MouseClick
        If (Me.MinimizeBox = True) Then
            NotifyIcon1.Visible = True
        End If
    End Sub

    Private Sub NotifyIcon1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NotifyIcon1.Click
        Me.Show()
    End Sub

    Private Sub tsprogress_Click(sender As Object, e As EventArgs) Handles tsprogress.Click

    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        'Call main()
    End Sub
End Class
